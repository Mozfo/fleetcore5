generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model adm_audit_logs {
  id              String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id       String         @db.Uuid
  member_id       String?        @db.Uuid
  entity          String         @db.VarChar(50)
  entity_id       String         @db.Uuid
  action          String         @db.VarChar(50)
  changes         Json?
  ip_address      String?        @db.VarChar(45)
  user_agent      String?
  timestamp       DateTime       @default(now()) @db.Timestamptz(6)
  severity        audit_severity @default(info)
  category        audit_category @default(operational)
  session_id      String?        @db.Uuid
  request_id      String?        @db.Uuid
  old_values      Json?
  new_values      Json?
  retention_until DateTime?      @db.Timestamptz(6)
  tags            String[]       @default([])
  clt_members     clt_members?   @relation(fields: [member_id], references: [id])
  adm_tenants     adm_tenants    @relation(fields: [tenant_id], references: [id], onDelete: Cascade)

  @@index([changes], map: "adm_audit_logs_changes_gin", type: Gin)
  @@index([tenant_id, entity, entity_id], map: "adm_audit_logs_tenant_entity_entity_id_idx")
  @@index([tenant_id])
  @@index([timestamp(sort: Desc)])
}

model adm_invitations {
  id                     String                 @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id              String                 @db.Uuid
  email                  String                 @db.Citext
  token                  String                 @unique @db.VarChar(255)
  role                   String                 @db.VarChar(100)
  expires_at             DateTime               @db.Timestamptz(6)
  status                 invitation_status      @default(pending)
  sent_at                DateTime               @db.Timestamptz(6)
  sent_count             Int                    @default(1)
  last_sent_at           DateTime               @db.Timestamptz(6)
  accepted_at            DateTime?              @db.Timestamptz(6)
  accepted_from_ip       String?                @db.Inet
  accepted_by_member_id  String?                @db.Uuid
  invitation_type        invitation_type
  custom_message         String?
  metadata               Json?
  sent_by                String                 @db.Uuid
  created_at             DateTime               @default(now()) @db.Timestamptz(6)
  updated_at             DateTime               @default(now()) @db.Timestamptz(6)
  clt_members            clt_members?           @relation(fields: [accepted_by_member_id], references: [id], map: "fk_adm_invitations_accepted_by")
  adm_provider_employees adm_provider_employees @relation(fields: [sent_by], references: [id], map: "fk_adm_invitations_sent_by")
  adm_tenants            adm_tenants            @relation(fields: [tenant_id], references: [id], onDelete: Cascade, map: "fk_adm_invitations_tenant")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model adm_member_roles {
  id                                                    String       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                             String       @db.Uuid
  member_id                                             String       @db.Uuid
  role_id                                               String       @db.Uuid
  assigned_at                                           DateTime     @default(now()) @db.Timestamptz(6)
  created_at                                            DateTime     @default(now()) @db.Timestamptz(6)
  created_by                                            String?      @db.Uuid
  updated_at                                            DateTime     @default(now()) @db.Timestamptz(6)
  updated_by                                            String?      @db.Uuid
  deleted_at                                            DateTime?    @db.Timestamptz(6)
  deleted_by                                            String?      @db.Uuid
  deletion_reason                                       String?
  assigned_by                                           String?      @db.Uuid
  assignment_reason                                     String?
  valid_from                                            DateTime?    @db.Timestamptz(6)
  valid_until                                           DateTime?    @db.Timestamptz(6)
  is_primary                                            Boolean      @default(false)
  scope_type                                            scope_type?
  scope_id                                              String?      @db.Uuid
  priority                                              Int?         @default(0)
  migzzno  clt_members? @relation("M_63d3ka", fields: [created_by], references: [id])
  mmk6x6z  clt_members? @relation("M_yxttad", fields: [deleted_by], references: [id])
  meqd2ua   clt_members  @relation("M_l29jw", fields: [member_id], references: [id], onDelete: Cascade)
  adm_roles                                             adm_roles    @relation(fields: [role_id], references: [id], onDelete: Cascade)
  adm_tenants                                           adm_tenants  @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  mqr44k7  clt_members? @relation("M_edh8gt", fields: [updated_by], references: [id])
  mkt8pp6 clt_members? @relation("M_7rwncc", fields: [assigned_by], references: [id], map: "fk_adm_member_roles_assigned_by")

  @@index([created_by])
  @@index([deleted_at])
  @@index([member_id])
  @@index([role_id])
  @@index([tenant_id])
  @@index([updated_by])
}

model adm_member_sessions {
  id          String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  member_id   String      @db.Uuid
  token_hash  String      @unique @db.VarChar(256)
  ip_address  String?     @db.Inet
  user_agent  String?
  expires_at  DateTime    @db.Timestamptz(6)
  revoked_at  DateTime?   @db.Timestamptz(6)
  created_at  DateTime    @default(now()) @db.Timestamptz(6)
  clt_members clt_members @relation(fields: [member_id], references: [id], onDelete: Cascade, map: "fk_adm_member_sessions_member")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model clt_members {
  id                                                                                              String                         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                                       String                         @db.Uuid
  email                                                                                           String                         @db.Citext
  clerk_user_id                                                                                   String                         @db.VarChar(255)
  first_name                                                                                      String?                        @db.VarChar(100)
  last_name                                                                                       String?                        @db.VarChar(100)
  phone                                                                                           String                         @db.VarChar(50)
  role                                                                                            String                         @default("member") @db.VarChar(50)
  last_login_at                                                                                   DateTime?                      @db.Timestamptz(6)
  metadata                                                                                        Json                           @default("{}")
  status                                                                                          String                         @default("active") @db.VarChar(50)
  created_at                                                                                      DateTime                       @default(now()) @db.Timestamptz(6)
  created_by                                                                                      String?                        @db.Uuid
  updated_at                                                                                      DateTime                       @default(now()) @db.Timestamptz(6)
  updated_by                                                                                      String?                        @db.Uuid
  deleted_at                                                                                      DateTime?                      @db.Timestamptz(6)
  deleted_by                                                                                      String?                        @db.Uuid
  deletion_reason                                                                                 String?
  email_verified_at                                                                               DateTime?                      @db.Timestamptz(6)
  two_factor_enabled                                                                              Boolean                        @default(false)
  two_factor_secret                                                                               String?
  password_changed_at                                                                             DateTime?                      @db.Timestamptz(6)
  failed_login_attempts                                                                           Int                            @default(0)
  locked_until                                                                                    DateTime?                      @db.Timestamptz(6)
  default_role_id                                                                                 String?                        @db.Uuid
  preferred_language                                                                              String?                        @db.VarChar(10)
  notification_preferences                                                                        Json?
  adm_audit_logs                                                                                  adm_audit_logs[]
  adm_invitations                                                                                 adm_invitations[]
  mw4579g                                       adm_member_roles[]             @relation("M_63d3ka")
  m24824z                                       adm_member_roles[]             @relation("M_yxttad")
  mxq05ii                                        adm_member_roles[]             @relation("M_l29jw")
  mnu12cx                                       adm_member_roles[]             @relation("M_edh8gt")
  mfa8yn6                                      adm_member_roles[]             @relation("M_7rwncc")
  adm_member_sessions                                                                             adm_member_sessions[]
  mye3m4o                                                 clt_members?                   @relation("M_34756q", fields: [created_by], references: [id])
  lstmy9y06f                                           clt_members[]                  @relation("M_34756q")
  m6n3apz                                                 clt_members?                   @relation("M_x44ab7", fields: [deleted_by], references: [id])
  lstm4a0v1y                                           clt_members[]                  @relation("M_x44ab7")
  adm_tenants                                                                                     adm_tenants                    @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  mscwaxx                                                 clt_members?                   @relation("M_beba39", fields: [updated_by], references: [id])
  lstmpztv9w                                           clt_members[]                  @relation("M_beba39")
  rcks0ew                                                adm_roles?                     @relation("R__yz9vrz", fields: [default_role_id], references: [id], map: "fk_clt_members_default_role")
  matpo0q                             adm_notification_logs[]        @relation("M_1wlxkb")
  mu7h8tx                             adm_notification_logs[]        @relation("M_vwj2os")
  mxxbfwn                           adm_notification_logs[]        @relation("M_e1v7ag")
  mj3tsx9                             adm_notification_logs[]        @relation("M_a6q2gu")
  adm_role_versions                                                                               adm_role_versions[]
  mabxvy                                                     adm_roles[]                    @relation("M_l5n085")
  mua930f                                                     adm_roles[]                    @relation("M_jvjwmi")
  m8kg2sh                                                     adm_roles[]                    @relation("M_tfr54o")
  m7im7no                   adm_tenant_vehicle_classes[]   @relation("M_bke6r4")
  mmhaxgt                   adm_tenant_vehicle_classes[]   @relation("M_tgsq3j")
  mrhx8v                   adm_tenant_vehicle_classes[]   @relation("M_juibnn")
  menv9j6                                             crm_contracts[]                @relation("M_2ejw59")
  mfc1vlb                                             crm_contracts[]                @relation("M_weh19q")
  m6dr4mn                                             crm_contracts[]                @relation("M_aoo11s")
  mpbrkx0                                    crm_opportunities[]            @relation("M_ibz5tf")
  mp0iu8u                                     crm_opportunities[]            @relation("M_ds7hn1")
  mg0o2lt                                     crm_opportunities[]            @relation("M_r8zf7m")
  mxamz5d                                     crm_opportunities[]            @relation("M_m2bmjk")
  doc_document_versions                                                                           doc_document_versions[]
  mf113xc                                             doc_documents[]                @relation("M_i33hqq")
  mq05sxb                                             doc_documents[]                @relation("M_bwtndr")
  mnb58tv                                             doc_documents[]                @relation("M_9szcu7")
  m2zu348                                            doc_documents[]                @relation("M_z47z6e")
  mauqvvo                                               fin_accounts[]                 @relation("M_rxloyf")
  mj5698t                                               fin_accounts[]                 @relation("M_d3l7w8")
  m2kmqz5                                               fin_accounts[]                 @relation("M_yte846")
  mrxki5g                   fin_driver_payment_batches[]   @relation("M_yaypj")
  m22cmz1                   fin_driver_payment_batches[]   @relation("M_t1m6ey")
  mjngd8x                   fin_driver_payment_batches[]   @relation("M_7bt670")
  ma5kxi6                                 fin_driver_payments[]          @relation("M_vimqxf")
  muvlzch                                 fin_driver_payments[]          @relation("M_1iplsy")
  mifp2ep                                 fin_driver_payments[]          @relation("M_n8im0w")
  ms9t5l4                             fin_toll_transactions[]        @relation("M_egobz6")
  mcrdr9j                             fin_toll_transactions[]        @relation("M_qkikvh")
  myh6rhh                             fin_toll_transactions[]        @relation("M_mqsgvp")
  mc6qmtp                    fin_traffic_fine_disputes[]    @relation("M_vvxbqs")
  m8931zh                   fin_traffic_fine_disputes[]    @relation("M_8geo42")
  mamtosk                                     fin_traffic_fines[]            @relation("M_kom41s")
  mued823                                     fin_traffic_fines[]            @relation("M_9bb12p")
  miwxtp3                                     fin_traffic_fines[]            @relation("M_cehz59")
  m7z0kuc                                       fin_transactions[]             @relation("M_yd3ie")
  mm0wka5                                       fin_transactions[]             @relation("M_uya8mv")
  mb3k27                                       fin_transactions[]             @relation("M_98h8ex")
  mgbv1ya                                     fin_transactions[]             @relation("M_nbijw")
  msjpnjy                         flt_vehicle_assignments[]      @relation("M_kidcbl")
  m1g7hkj                         flt_vehicle_assignments[]      @relation("M_9hjssw")
  mk9linf                         flt_vehicle_assignments[]      @relation("M_c897f2")
  mrgqtto                                   flt_vehicle_events[]           @relation("M_6t5nd2")
  mdkg30z                                   flt_vehicle_events[]           @relation("M_n6rhrf")
  mza938x                                   flt_vehicle_events[]           @relation("M_1gyhjh")
  mjwg6rg                               flt_vehicle_expenses[]         @relation("M_hko51g")
  ml4qq37                               flt_vehicle_expenses[]         @relation("M_cf9031")
  ms6kbnz                               flt_vehicle_expenses[]         @relation("M_9ak04x")
  mrt9jes                           flt_vehicle_insurances[]       @relation("M_3678hy")
  m26nlpp                           flt_vehicle_insurances[]       @relation("M_qtpwmj")
  mjj5ei9                           flt_vehicle_insurances[]       @relation("M_53wwel")
  mqkp2cc                         flt_vehicle_maintenance[]      @relation("M_4i9ics")
  myut78v                         flt_vehicle_maintenance[]      @relation("M_csdn9b")
  m1xw0tg                                               flt_vehicles[]                 @relation("M_5i2lxn")
  ms214b1                                               flt_vehicles[]                 @relation("M_ohuj6u")
  m6c8433                                               flt_vehicles[]                 @relation("M_2s1iyw")
  m62jy1u                                 rev_driver_revenues[]          @relation("M_sil6z5")
  myymyst                                 rev_driver_revenues[]          @relation("M_1hby5c")
  meco2yd                                 rev_driver_revenues[]          @relation("M_k8h22m")
  mgdczbc                               rev_driver_revenues[]          @relation("M_kfvgt1")
  mgd2e50                                rev_reconciliations[]          @relation("M_x20liv")
  m15kova                                 rev_reconciliations[]          @relation("M_xxhwsx")
  mv5htzr                                 rev_reconciliations[]          @relation("M_73p01q")
  mo8b6e6                                rev_reconciliations[]          @relation("M_2ma42x")
  m9fotrt                                 rev_reconciliations[]          @relation("M_sti09o")
  mvwjkys                                 rev_revenue_imports[]          @relation("M_vhyzis")
  m1wmfub                                 rev_revenue_imports[]          @relation("M_1i1ueb")
  mnmfg29                                 rev_revenue_imports[]          @relation("M_n7uum9")
  mtjfawj                     rid_driver_blacklists[]        @relation("M_jegzb")
  mhsrefg                             rid_driver_blacklists[]        @relation("M_rzh008")
  mz393k8                             rid_driver_blacklists[]        @relation("M_owjhzg")
  m9s8gnn                            rid_driver_blacklists[]        @relation("M_lvcwc1")
  mc75qp1                             rid_driver_blacklists[]        @relation("M_20g549")
  mx99e5j                      rid_driver_blacklists[]        @relation("M_pdqhw5")
  mdjd3q1                          rid_driver_blacklists[]        @relation("M_x4dee5")
  m9in9ix                             rid_driver_blacklists[]        @relation("M_jpcv3p")
  mm6ohno               rid_driver_cooperation_terms[] @relation("M_8vpcbp")
  m7t8ngt               rid_driver_cooperation_terms[] @relation("M_l47sss")
  mx0vcr3        rid_driver_cooperation_terms[] @relation("M_3tku7i")
  mf7zup0 rid_driver_cooperation_terms[] @relation("M_hi3n19")
  mdwkcr5               rid_driver_cooperation_terms[] @relation("M_ll7f6")
  m8q2u2k                               rid_driver_documents[]         @relation("M_1ohxv4")
  mwb42s3                               rid_driver_documents[]         @relation("M_sbf79d")
  mh06yz3                               rid_driver_documents[]         @relation("M_6lm71f")
  menzlb0                              rid_driver_documents[]         @relation("M_nrg8s8")
  mf7i0dg                               rid_driver_languages[]         @relation("M_cgcp83")
  mesf4r1                               rid_driver_languages[]         @relation("M_sku7mk")
  m6xdvgx                               rid_driver_languages[]         @relation("M_kqgu4m")
  m2cfq6m                         rid_driver_performances[]      @relation("M_i78cvv")
  mwccvb3                         rid_driver_performances[]      @relation("M_bsos8m")
  mamjv35                         rid_driver_performances[]      @relation("M_9x47zc")
  m8ljs09                                rid_driver_requests[]          @relation("M_bzuqip")
  mkhj9jq                                rid_driver_requests[]          @relation("M_3v8z8")
  mw1ltn4                                 rid_driver_requests[]          @relation("M_t5n1oa")
  m8zl37j                                 rid_driver_requests[]          @relation("M_ua3g7")
  mojzgei                               rid_driver_requests[]          @relation("M_pehzv8")
  mmd8his                             rid_driver_requests[]          @relation("M_avgi52")
  mmr19s9                        rid_driver_requests[]          @relation("M_h7juab")
  mbz5b26                                rid_driver_requests[]          @relation("M_wkjtl4")
  m7qusll                                rid_driver_requests[]          @relation("M_cujpxd")
  mupe3fh                                 rid_driver_requests[]          @relation("M_kviwrr")
  m9wjkak                                 rid_driver_training[]          @relation("M_jl6a78")
  mv4nck3                                 rid_driver_training[]          @relation("M_aequx9")
  mes3f5r                               rid_driver_training[]          @relation("M_e52aqn")
  mi6np73                                 rid_driver_training[]          @relation("M_bb25ap")
  mgmukgg                                                     sch_goals[]                    @relation("M_1b1p7a")
  mdd2ko1                                                     sch_goals[]                    @relation("M_vayubr")
  m8cqfjx                                                     sch_goals[]                    @relation("M_9l5u3t")
  m7zva97                   sch_maintenance_schedules[]    @relation("M_tjeb57")
  mr4gads                     sch_maintenance_schedules[]    @relation("M_e2vqg6")
  mdwqmgv                     sch_maintenance_schedules[]    @relation("M_qyb6eh")
  mzekfab                     sch_maintenance_schedules[]    @relation("M_mczvcp")
  mrqr7or                                                  sch_shifts[]                   @relation("M_mxzpam")
  m5pyjks                                                   sch_shifts[]                   @relation("M_k4ibzp")
  mzb8d9v                                                   sch_shifts[]                   @relation("M_kwokuy")
  me02ohb                                                   sch_shifts[]                   @relation("M_semgw8")
  sch_task_comments                                                                               sch_task_comments[]
  sch_task_history                                                                                sch_task_history[]
  moogey6                                                    sch_tasks[]                    @relation("M_k8wmgq")
  mahr63y                                                    sch_tasks[]                    @relation("M_flzuga")
  m7r35nz                                                   sch_tasks[]                    @relation("M_k4xq0p")
  mcfjbaq                                                   sch_tasks[]                    @relation("M_fghkdy")
  mcrly2c                                                    sch_tasks[]                    @relation("M_w5r3ck")
  mxejyes                                                     sch_tasks[]                    @relation("M_261krg")
  m3emtab                                                     sch_tasks[]                    @relation("M_rtvkd1")
  mp4fti9                                                     sch_tasks[]                    @relation("M_642k53")
  mpzyu06                                 sup_ticket_messages[]          @relation("M_3ngxt7")
  m3zyb4b                                 sup_ticket_messages[]          @relation("M_xne2xo")
  mhpup3n                                 sup_ticket_messages[]          @relation("M_bxl2pq")
  m2m2maq                                                  sup_tickets[]                  @relation("M_ec93g5")
  mkzghcm                                                 sup_tickets[]                  @relation("M_7cuayb")
  m90gnrv                                                 sup_tickets[]                  @relation("M_xoclwc")
  mcpccg3                                                 sup_tickets[]                  @relation("M_fmyfuu")
  mk6elyg                                 trp_client_invoices[]          @relation("M_s42vg6")
  m9tij61                                 trp_client_invoices[]          @relation("M_1vu9ob")
  mbwah1x                                 trp_client_invoices[]          @relation("M_jtyqjn")
  mkz3sp4                             trp_platform_accounts[]        @relation("M_9qb4de")
  mk2345j                             trp_platform_accounts[]        @relation("M_vavsh9")
  mt97xln                             trp_platform_accounts[]        @relation("M_i0f99x")
  mw0dg94                                         trp_settlements[]              @relation("M_771c4m")
  m20gb4n                                         trp_settlements[]              @relation("M_msvszv")
  mnq9bcl                                         trp_settlements[]              @relation("M_132srx")
  // Quote-to-Cash relations
  crm_orders_created                                                                              crm_orders[]                   @relation("M_b83s6b")
  crm_orders_updated                                                                              crm_orders[]                   @relation("M_ji7x2u")
  crm_orders_deleted                                                                              crm_orders[]                   @relation("M_tt34oc")

  @@index([clerk_user_id])
  @@index([created_by])
  @@index([deleted_at])
  @@index([email])
  @@index([last_login_at])
  @@index([metadata], map: "clt_members_metadata_gin", type: Gin)
  @@index([tenant_id])
  @@index([updated_by])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model adm_notification_logs {
  id                                                          String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                                   String?              @db.Uuid
  recipient_id                                                String?              @db.Uuid
  recipient_email                                             String               @db.VarChar(255)
  recipient_phone                                             String?              @db.VarChar(20)
  template_code                                               String               @db.VarChar(100)
  channel                                                     notification_channel
  locale_used                                                 String               @db.VarChar(10)
  subject                                                     String?
  body                                                        String?
  variables_data                                              Json?
  status                                                      notification_status  @default(pending)
  sent_at                                                     DateTime?            @db.Timestamptz(6)
  delivered_at                                                DateTime?            @db.Timestamptz(6)
  opened_at                                                   DateTime?            @db.Timestamptz(6)
  clicked_at                                                  DateTime?            @db.Timestamptz(6)
  failed_at                                                   DateTime?            @db.Timestamptz(6)
  error_message                                               String?
  external_id                                                 String?              @db.VarChar(255)
  ip_address                                                  String?              @db.VarChar(45)
  user_agent                                                  String?
  session_id                                                  String?              @db.Uuid
  request_id                                                  String?              @db.Uuid
  created_at                                                  DateTime             @default(now()) @db.Timestamptz(6)
  created_by                                                  String?              @db.Uuid
  updated_at                                                  DateTime             @default(now()) @db.Timestamptz(6)
  updated_by                                                  String?              @db.Uuid
  deleted_at                                                  DateTime?            @db.Timestamptz(6)
  deleted_by                                                  String?              @db.Uuid
  deletion_reason                                             String?
  m93za0h   clt_members?         @relation("M_1wlxkb", fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_adm_notification_logs_created_by")
  mvx7mu6   clt_members?         @relation("M_vwj2os", fields: [deleted_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_adm_notification_logs_deleted_by")
  mjpgsny clt_members?         @relation("M_e1v7ag", fields: [recipient_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_adm_notification_logs_recipient_id")
  adm_tenants                                                 adm_tenants?         @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_adm_notification_logs_tenant")
  mhe3ex0   clt_members?         @relation("M_a6q2gu", fields: [updated_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_adm_notification_logs_updated_by")

  @@index([channel], map: "idx_adm_notification_logs_channel")
  @@index([created_at], map: "idx_adm_notification_logs_created_at")
  @@index([deleted_at], map: "idx_adm_notification_logs_deleted_at")
  @@index([recipient_email], map: "idx_adm_notification_logs_recipient_email")
  @@index([recipient_id], map: "idx_adm_notification_logs_recipient_id")
  @@index([sent_at], map: "idx_adm_notification_logs_sent_at")
  @@index([status], map: "idx_adm_notification_logs_status")
  @@index([template_code], map: "idx_adm_notification_logs_template_code")
  @@index([tenant_id], map: "idx_adm_notification_logs_tenant")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model adm_notification_queue {
  id                String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  channel           notification_channel @default(email)
  template_code     String               @db.VarChar(100)
  locale            String               @default("en") @db.VarChar(10)
  recipient_email   String?              @db.VarChar(255)
  recipient_phone   String?              @db.VarChar(50)
  recipient_user_id String?              @db.Uuid
  variables         Json                 @default("{}")
  lead_id           String?              @db.Uuid
  member_id         String?              @db.Uuid
  tenant_id         String?              @db.Uuid
  country_code      String?              @db.Char(2)
  status            queue_status         @default(pending)
  attempts          Int                  @default(0)
  max_attempts      Int                  @default(3)
  next_retry_at     DateTime?            @db.Timestamptz(6)
  last_error        String?
  created_at        DateTime             @default(now()) @db.Timestamptz(6)
  processed_at      DateTime?            @db.Timestamptz(6)
  idempotency_key   String?              @unique @db.VarChar(255)
  deleted_at        DateTime?            @db.Timestamptz(6)
  deleted_by        String?              @db.Uuid
  deletion_reason   String?

  @@index([created_at(sort: Desc)], map: "idx_adm_notification_queue_created_at")
  @@index([status], map: "idx_adm_notification_queue_status")
  @@index([template_code], map: "idx_adm_notification_queue_template")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model adm_provider_employees {
  id                                                                                        String                        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  clerk_user_id                                                                             String                        @db.VarChar(255)
  email                                                                                     String                        @db.VarChar(255)
  department                                                                                String?                       @db.VarChar(50)
  title                                                                                     String?                       @db.VarChar(50)
  permissions                                                                               Json?
  status                                                                                    String                        @default("active") @db.VarChar(50)
  created_at                                                                                DateTime                      @default(now()) @db.Timestamptz(6)
  created_by                                                                                String?                       @db.Uuid
  updated_at                                                                                DateTime                      @default(now()) @db.Timestamptz(6)
  updated_by                                                                                String?                       @db.Uuid
  deleted_at                                                                                DateTime?                     @db.Timestamptz(6)
  deleted_by                                                                                String?                       @db.Uuid
  deletion_reason                                                                           String?
  supervisor_id                                                                             String?                       @db.Uuid
  preferred_locale                                                                          String?                       @db.VarChar(10)
  first_name                                                                                String                        @db.VarChar(50)
  last_name                                                                                 String?                       @db.VarChar(50)
  provider_id                                                                               String?                       @db.Uuid
  adm_invitations                                                                           adm_invitations[]
  adm_providers                                                                             adm_providers?                @relation(fields: [provider_id], references: [id])
  crm_activities                                                                            crm_activities[]
  exelgtx          adm_provider_employees?       @relation("E_le28vs", fields: [created_by], references: [id])
  lstetzn9ok    adm_provider_employees[]      @relation("E_le28vs")
  eq853tw          adm_provider_employees?       @relation("E_skilvt", fields: [deleted_by], references: [id])
  lstemt6woj    adm_provider_employees[]      @relation("E_skilvt")
  ehytj9e          adm_provider_employees?       @relation("E_y79vit", fields: [updated_by], references: [id])
  lsteejvc41    adm_provider_employees[]      @relation("E_y79vit")
  e306qux       adm_provider_employees?       @relation("E_5ejxja", fields: [supervisor_id], references: [id], map: "fk_adm_provider_employees_supervisor")
  lstep8slyu adm_provider_employees[]      @relation("E_5ejxja")
  adm_tenant_lifecycle_events                                                               adm_tenant_lifecycle_events[]
  e60a7az                    bil_billing_plans[]           @relation("E_fx2i2g")
  e1665p2                    bil_billing_plans[]           @relation("E_n3iv2h")
  e9fhq9k                    bil_billing_plans[]           @relation("E_vcufmz")
  epf5x63                bil_payment_methods[]         @relation("E_1ygpij")
  ewlma64                bil_payment_methods[]         @relation("E_94x2ik")
  eu6678i                bil_payment_methods[]         @relation("E_he8n32")
  bil_promotions                                                                            bil_promotions[]
  efv3wrl      clt_invoice_lines[]    @relation("E_a8kxad")
  e8onjrk      clt_invoice_lines[]    @relation("E_hf1aae")
  efbz72      clt_invoice_lines[]    @relation("E_pocuuw")
  e1u4tf9                clt_invoices[]         @relation("E_d2rxom")
  e5cbjks                clt_invoices[]         @relation("E_k98aon")
  edln45a                clt_invoices[]         @relation("E_sijv95")
  ew8fdsf      clt_subscriptions[]    @relation("E_puwvo2")
  ep1z0se      clt_subscriptions[]    @relation("E_iogio1")
  egsng7w      clt_subscriptions[]    @relation("E_af4y3j")
  e4rh01h      bil_tenant_usage_metrics[]    @relation("E_c29c7q")
  e2ezcyk      bil_tenant_usage_metrics[]    @relation("E_j8pp7r")
  eaoaxj2      bil_tenant_usage_metrics[]    @relation("E_ri19s9")
  emsbw60                           crm_contracts[]               @relation("E_8gunbt")
  en4z4k3                            crm_contracts[]               @relation("E_lb473o")
  efyirk2                            crm_contracts[]               @relation("E_e4nu3n")
  e7p76zk                            crm_contracts[]               @relation("E_5vc9j5")
  e2uoxrz                                   crm_leads[]                   @relation("E_q6cosq")
  eoha4x3                                    crm_leads[]                   @relation("E_y5okea")
  ehatrx2                                    crm_leads[]                   @relation("E_toz4kt")
  e91i7ck                                    crm_leads[]                   @relation("E_lfnk0b")
  ea51cuj                   crm_opportunities[]           @relation("E_2fdy1w")
  e1bxz5f                    crm_opportunities[]           @relation("E_hry82s")
  e5uidum                    crm_opportunities[]           @relation("E_alhv2r")
  ehrt0l0                      crm_opportunities[]           @relation("E_b2k0n1")
  ee3tyf4                    crm_opportunities[]           @relation("E_2c6ai9")
  ei55iut                              crm_settings[]                @relation("E_uo2qnk")
  eayp5us                              crm_settings[]                @relation("E_x6kybj")
  e2pdlaa                              crm_settings[]                @relation("E_ox9dr1")
  e38dczh                            dir_car_makes[]               @relation("E_hnv1jg")
  eaetpzi                            dir_car_makes[]               @relation("E_aheojf")
  eio5ak0                            dir_car_makes[]               @relation("E_2833yx")
  eo0k6qz                          dir_car_models[]              @relation("E_813tv1")
  ev70jr0                          dir_car_models[]              @relation("E_ungv0")
  evkrxnm                          dir_car_models[]              @relation("E_7eo3pi")
  eqxxi3t                dir_country_locales[]         @relation("E_jxx9ai")
  ey4dv3u                dir_country_locales[]         @relation("E_r4dmaj")
  esnemas                dir_country_locales[]         @relation("E_zdp6v1")
  e6n07cn        dir_country_regulations[]     @relation("E_jh0igq")
  ejg5ne        dir_country_regulations[]     @relation("E_qngvgr")
  e8srq7w        dir_country_regulations[]     @relation("E_ywsg19")
  erksq1h  dir_notification_templates[]  @relation("E_ipw24j")
  ekecd1g  dir_notification_templates[]  @relation("E_pwcf4k")
  ec50sgy  dir_notification_templates[]  @relation("E_y5nzp2")
  ezau4x1                dir_ownership_types[]         @relation("E_2hjqoz")
  es4drx0                dir_ownership_types[]         @relation("E_9o03p0")
  ejv27ci                dir_ownership_types[]         @relation("E_hxbo9i")
  e9cn3u3              dir_platform_configs[]        @relation("E_kpstmr")
  egj3gu4              dir_platform_configs[]        @relation("E_rw96ms")
  eosf1em              dir_platform_configs[]        @relation("E_yvjaru")
  e6bcv3r                            dir_platforms[]               @relation("E_53hkze")
  ev3hwa                            dir_platforms[]               @relation("E_c9xxzf")
  e94f2gs                            dir_platforms[]               @relation("E_kj9ijx")
  efoqxv3                dir_vehicle_classes[]         @relation("E_y63drn")
  emv7av4                dir_vehicle_classes[]         @relation("E_qzn0rm")
  ev4ivfm                dir_vehicle_classes[]         @relation("E_iqbg74")
  eokbobv              dir_vehicle_statuses[]        @relation("E_llhdsf")
  evqs1bw              dir_vehicle_statuses[]        @relation("E_ef10se")
  ev10g2q              dir_vehicle_statuses[]        @relation("E_65pg7w")
  eg9n6r9                  doc_document_types[]          @relation("E_qrmvd4")
  e936tr8                  doc_document_types[]          @relation("E_xy38d5")
  etv96q                  doc_document_types[]          @relation("E_stp91h")
  edzunrf                      doc_entity_types[]            @relation("E_1yslow")
  el6b0rg                      doc_entity_types[]            @relation("E_958yox")
  etfmlby                      doc_entity_types[]            @relation("E_hekj9f")
  e8bt1it  fin_driver_payment_batches[]  @relation("E_ikcc2w")
  e15cois  fin_driver_payment_batches[]  @relation("E_bdvz2v")
  e73yw1q  fin_driver_payment_batches[]  @relation("E_34keid")
  ef9kq8d                fin_driver_payments[]         @relation("E_l7nmmc")
  emg138e                fin_driver_payments[]         @relation("E_e179mb")
  eupcnsw                fin_driver_payments[]         @relation("E_5rvp1t")
  es1eabz        flt_vehicle_assignments[]     @relation("E_tldo32")
  ekuxxby        flt_vehicle_assignments[]     @relation("E_y9a0w1")
  eclmcrg        flt_vehicle_assignments[]     @relation("E_pzygbj")
  eu888wl          flt_vehicle_equipments[]      @relation("E_qmekvp")
  en1rvwk          flt_vehicle_equipments[]      @relation("E_xsuxvq")
  eesgbc2          flt_vehicle_equipments[]      @relation("E_syxjiw")
  e7vukyd                  flt_vehicle_events[]          @relation("E_jebavr")
  epe7yc                  flt_vehicle_events[]          @relation("E_c7uxvq")
  e7jxcm6                  flt_vehicle_events[]          @relation("E_3yjdb8")
  emc1boa             flt_vehicle_expenses[]        @relation("E_v3qfom")
  eu0yp5h              flt_vehicle_expenses[]        @relation("E_i03gd1")
  emuic5g              flt_vehicle_expenses[]        @relation("E_atn3d0")
  e2r26pa     flt_vehicle_expenses[]        @relation("E_5it5qq")
  eel6rky              flt_vehicle_expenses[]        @relation("E_2kbisi")
  eaydl3x        flt_vehicle_inspections[]     @relation("E_2551qf")
  e4hecgm        flt_vehicle_inspections[]     @relation("E_hkwzay")
  e2no0a3          flt_vehicle_insurances[]      @relation("E_4b2djr")
  e9u4da4          flt_vehicle_insurances[]      @relation("E_2vdzga")
  ei3fxum          flt_vehicle_insurances[]      @relation("E_b4pk0s")
  e5dbwxy       flt_vehicle_maintenance[]     @relation("E_4xd4dm")
  euy0x6z        flt_vehicle_maintenance[]     @relation("E_gu959h")
  ewwmrs4        flt_vehicle_maintenance[]     @relation("E_9nss9g")
  e9taxw5  flt_vehicle_maintenance[]     @relation("E_r9hat7")
  erxlqhd      flt_vehicle_maintenance[]     @relation("E_80eefz")
  eonb77m        flt_vehicle_maintenance[]     @relation("E_1eh7oy")
  ea3inp                              flt_vehicles[]                @relation("E_vrui2s")
  e6wcucc                              flt_vehicles[]                @relation("E_w2t6wb")
  ef5oewu                              flt_vehicles[]                @relation("E_nthmbt")
  rid_driver_training                                                                       rid_driver_training[]
  e5ievtt                                rid_drivers[]                 @relation("E_qtdkfv")
  e1o1h68                                rid_drivers[]                 @relation("E_jmx7fu")
  e1e7rbw                         rid_drivers[]                 @relation("E_wwdh36")
  e9xd1qq                                rid_drivers[]                 @relation("E_bdlmvc")
  efsza95                               rid_drivers[]                 @relation("E_y2a2i9")
  sup_canned_responses                                                                      sup_canned_responses[]
  eqcwn9z            sup_ticket_categories[]       @relation("E_32ecp6")
  eax4ppg            sup_ticket_categories[]       @relation("E_ii6a9p")
  euju0s5              sup_ticket_sla_rules[]        @relation("E_rcqqbu")
  ef4237m              sup_ticket_sla_rules[]        @relation("E_s8le2r")
  sup_tickets                                                                               sup_tickets[]
  trp_platform_account_keys                                                                 trp_platform_account_keys[]
  // Quote-to-Cash relations
  bil_plans_created                                                                         bil_plans[]                   @relation("E_kwdxok")
  bil_plans_updated                                                                         bil_plans[]                   @relation("E_5gm041")
  bil_plans_deleted                                                                         bil_plans[]                   @relation("E_dpxkoj")
  bil_addons_created                                                                        bil_addons[]                  @relation("E_d4dtif")
  bil_addons_updated                                                                        bil_addons[]                  @relation("E_2be424")
  bil_addons_deleted                                                                        bil_addons[]                  @relation("E_5xxgie")
  bil_services_created                                                                      bil_services[]                @relation("E_gg5730")
  bil_services_updated                                                                      bil_services[]                @relation("E_10d9ih")
  bil_services_deleted                                                                      bil_services[]                @relation("E_99ou2z")
  crm_orders_approved                                                                       crm_orders[]                  @relation("E_gbcmr")
  crm_orders_created                                                                        crm_orders[]                  @relation("E_zbcklq")
  crm_orders_updated                                                                        crm_orders[]                  @relation("E_jvkn17")
  crm_orders_deleted                                                                        crm_orders[]                  @relation("E_s4w7lp")
  crm_agreements                                                                            crm_agreements[]

  @@index([created_by])
  @@index([deleted_at])
  @@index([first_name])
  @@index([last_name])
  @@index([permissions], map: "adm_provider_employees_permissions_gin", type: Gin)
  @@index([updated_by])
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model adm_providers {
  id                     String                   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  code                   String                   @unique @db.VarChar(50)
  name                   String                   @db.VarChar(200)
  country_code           String?                  @db.Char(2)
  is_internal            Boolean                  @default(true)
  settings               Json                     @default("{}")
  metadata               Json                     @default("{}")
  status                 String                   @default("active") @db.VarChar(50)
  created_at             DateTime                 @default(now()) @db.Timestamptz(6)
  created_by             String?                  @db.Uuid
  updated_at             DateTime                 @default(now()) @db.Timestamptz(6)
  updated_by             String?                  @db.Uuid
  deleted_at             DateTime?                @db.Timestamptz(6)
  deleted_by             String?                  @db.Uuid
  deletion_reason        String?
  adm_provider_employees adm_provider_employees[]
  crm_activities         crm_activities[]
  crm_addresses          crm_addresses[]          @relation("crm_addresses_provider")
  crm_countries          crm_countries[]          @relation("crm_countries_provider")
  crm_lead_sources       crm_lead_sources[]       @relation("crm_lead_sources_provider")
  crm_leads              crm_leads[]              @relation("crm_leads_provider")
  crm_opportunities      crm_opportunities[]      @relation("crm_opportunities_provider")
  crm_pipelines          crm_pipelines[]          @relation("crm_pipelines_provider")
  crm_settings           crm_settings[]           @relation("crm_settings_provider")
  // Quote-to-Cash relations
  bil_plans              bil_plans[]              @relation("bil_plans_provider")
  bil_addons             bil_addons[]             @relation("bil_addons_provider")
  bil_services           bil_services[]           @relation("bil_services_provider")
  bil_offer_rules        bil_offer_rules[]        @relation("bil_offer_rules_provider")
  bil_amendments         bil_amendments[]         @relation("bil_amendments_provider")
  bil_subscription_schedules bil_subscription_schedules[] @relation("X_n952v8")
  bil_subscription_schedule_phases bil_subscription_schedule_phases[] @relation("X_j6pdo8")
  crm_quotes             crm_quotes[]             @relation("crm_quotes_provider")
  crm_quote_items        crm_quote_items[]        @relation("crm_quote_items_provider")
  crm_agreements         crm_agreements[]         @relation("crm_agreements_provider")
  crm_orders             crm_orders[]             @relation("crm_orders_provider")
  // V6.2.1: bil_settings relation
  bil_settings           bil_settings[]           @relation("bil_settings_provider")

  @@index([code], map: "idx_adm_providers_code")
  @@index([country_code], map: "idx_adm_providers_country")
  @@index([is_internal], map: "idx_adm_providers_internal")
  @@index([status], map: "idx_adm_providers_status")
}

model adm_role_permissions {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  role_id    String    @db.Uuid
  resource   String    @db.VarChar(100)
  action     String    @db.VarChar(50)
  conditions Json?
  created_at DateTime  @default(now()) @db.Timestamptz(6)
  adm_roles  adm_roles @relation(fields: [role_id], references: [id], onDelete: Cascade, map: "fk_adm_role_permissions_role")
}

model adm_role_versions {
  id                   String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  role_id              String       @db.Uuid
  version_number       Int
  permissions_snapshot Json
  changed_by           String?      @db.Uuid
  change_reason        String?
  created_at           DateTime     @default(now()) @db.Timestamptz(6)
  clt_members          clt_members? @relation(fields: [changed_by], references: [id], map: "fk_adm_role_versions_changed_by")
  adm_roles            adm_roles    @relation(fields: [role_id], references: [id], onDelete: Cascade, map: "fk_adm_role_versions_role")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model adm_roles {
  id                                                 String                 @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                          String                 @db.Uuid
  name                                               String                 @db.VarChar(100)
  description                                        String?
  permissions                                        Json                   @default("{}")
  status                                             String                 @default("active") @db.VarChar(50)
  created_at                                         DateTime               @default(now()) @db.Timestamptz(6)
  created_by                                         String?                @db.Uuid
  updated_at                                         DateTime               @default(now()) @db.Timestamptz(6)
  updated_by                                         String?                @db.Uuid
  deleted_at                                         DateTime?              @db.Timestamptz(6)
  deleted_by                                         String?                @db.Uuid
  deletion_reason                                    String?
  slug                                               String                 @unique @db.VarChar(100)
  parent_role_id                                     String?                @db.Uuid
  is_system                                          Boolean                @default(false)
  is_default                                         Boolean                @default(false)
  max_members                                        Int?
  valid_from                                         DateTime?              @db.Timestamptz(6)
  valid_until                                        DateTime?              @db.Timestamptz(6)
  approval_required                                  Boolean                @default(false)
  name_translations                                  Json
  description_translations                           Json?
  adm_member_roles                                   adm_member_roles[]
  rw8cvxh clt_members[]          @relation("R__yz9vrz")
  adm_role_permissions                               adm_role_permissions[]
  adm_role_versions                                  adm_role_versions[]
  mvlzui3      clt_members?           @relation("M_l5n085", fields: [created_by], references: [id])
  m9f72ck      clt_members?           @relation("M_jvjwmi", fields: [deleted_by], references: [id])
  adm_tenants                                        adm_tenants            @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  mv502ki      clt_members?           @relation("M_tfr54o", fields: [updated_by], references: [id])
  adm_roles                                          adm_roles?             @relation("adm_rolesToadm_roles", fields: [parent_role_id], references: [id], map: "fk_adm_roles_parent")
  other_adm_roles                                    adm_roles[]            @relation("adm_rolesToadm_roles")

  @@index([created_by])
  @@index([deleted_at])
  @@index([permissions], map: "adm_roles_permissions_gin", type: Gin)
  @@index([tenant_id])
  @@index([updated_by])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model adm_tenant_lifecycle_events {
  id                     String                  @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id              String                  @db.Uuid
  event_type             String                  @db.VarChar(50)
  performed_by           String?                 @db.Uuid
  effective_date         DateTime?               @db.Date
  description            String?
  created_at             DateTime                @default(now()) @db.Timestamptz(6)
  adm_provider_employees adm_provider_employees? @relation(fields: [performed_by], references: [id])
  adm_tenants            adm_tenants             @relation(fields: [tenant_id], references: [id], onDelete: Cascade)

  @@index([effective_date(sort: Desc)])
  @@index([event_type])
  @@index([tenant_id, event_type], map: "adm_tenant_lifecycle_events_tenant_event_idx")
  @@index([tenant_id])
}

model adm_tenant_settings {
  id            String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id     String      @db.Uuid
  setting_key   String      @db.VarChar(100)
  setting_value Json
  category      String?     @db.VarChar(50)
  is_encrypted  Boolean     @default(false)
  updated_at    DateTime    @default(now()) @db.Timestamptz(6)
  adm_tenants   adm_tenants @relation(fields: [tenant_id], references: [id], onDelete: Cascade, map: "fk_adm_tenant_settings_tenant")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model adm_tenant_vehicle_classes {
  id                                                             String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                      String               @db.Uuid
  code                                                           String               @db.VarChar(50)
  name                                                           String               @db.VarChar(100)
  description                                                    String?
  criteria                                                       Json?
  based_on_class_id                                              String?              @db.Uuid
  status                                                         lifecycle_status     @default(active)
  metadata                                                       Json?
  created_at                                                     DateTime             @default(now()) @db.Timestamptz(6)
  updated_at                                                     DateTime             @default(now()) @db.Timestamptz(6)
  created_by                                                     String               @db.Uuid
  updated_by                                                     String?              @db.Uuid
  deleted_at                                                     DateTime?            @db.Timestamptz(6)
  deleted_by                                                     String?              @db.Uuid
  deletion_reason                                                String?
  name_translations                                              Json
  description_translations                                       Json?
  dir_vehicle_classes                                            dir_vehicle_classes? @relation(fields: [based_on_class_id], references: [id], onUpdate: NoAction, map: "fk_adm_tenant_vehicle_classes_based_on")
  m70w94a clt_members          @relation("M_bke6r4", fields: [created_by], references: [id], onUpdate: NoAction, map: "fk_adm_tenant_vehicle_classes_created_by")
  my0anqd clt_members?         @relation("M_tgsq3j", fields: [deleted_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_adm_tenant_vehicle_classes_deleted_by")
  adm_tenants                                                    adm_tenants          @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_adm_tenant_vehicle_classes_tenant")
  mfb0e0t clt_members?         @relation("M_juibnn", fields: [updated_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_adm_tenant_vehicle_classes_updated_by")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model adm_tenants {
  id                           String                         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name                         String
  country_code                 String                         @db.VarChar(2)
  clerk_organization_id        String?                        @unique(map: "adm_tenants_clerk_org_unique")
  vat_rate                     Decimal?                       @db.Decimal(5, 2)
  default_currency             String                         @default("EUR") @db.Char(3)
  timezone                     String                         @default("Europe/Paris")
  created_at                   DateTime                       @default(now()) @db.Timestamptz(6)
  updated_at                   DateTime                       @default(now()) @db.Timestamptz(6)
  deleted_at                   DateTime?                      @db.Timestamptz(6)
  subdomain                    String?                        @unique @db.VarChar(100)
  status                       tenant_status                  @default(trialing)
  onboarding_completed_at      DateTime?                      @db.Timestamptz(6)
  trial_ends_at                DateTime?                      @db.Timestamptz(6)
  next_invoice_date            DateTime?                      @db.Date
  primary_contact_email        String?                        @db.VarChar(255)
  primary_contact_phone        String?                        @db.VarChar(50)
  billing_email                String?                        @db.VarChar(255)
  tenant_code                  String?                        @db.VarChar(50)
  // V6.2.1: Stripe integration
  stripe_customer_id           String?                        @db.VarChar(255)
  stripe_subscription_id       String?                        @db.VarChar(255)
  // V6.2.1: Verification flow (24h token)
  verification_token           String?                        @db.VarChar(100)
  verification_token_expires_at DateTime?                     @db.Timestamptz(6)
  verification_completed_at    DateTime?                      @db.Timestamptz(6)
  // V6.2.1: Admin designation
  admin_name                   String?                        @db.VarChar(255)
  admin_email                  String?                        @db.VarChar(255)
  admin_invited_at             DateTime?                      @db.Timestamptz(6)
  // V6.2.1: CGI/CGU acceptance
  cgi_accepted_at              DateTime?                      @db.Timestamptz(6)
  cgi_accepted_ip              String?                        @db.VarChar(45)
  cgi_version                  String?                        @db.VarChar(20)
  adm_audit_logs               adm_audit_logs[]
  adm_invitations              adm_invitations[]
  adm_member_roles             adm_member_roles[]
  clt_members                  clt_members[]
  adm_notification_logs        adm_notification_logs[]
  adm_roles                    adm_roles[]
  adm_tenant_lifecycle_events  adm_tenant_lifecycle_events[]
  adm_tenant_settings          adm_tenant_settings[]
  adm_tenant_vehicle_classes   adm_tenant_vehicle_classes[]
  bil_payment_methods          bil_payment_methods[]
  bil_promotion_usage          bil_promotion_usage[]
  clt_invoices          clt_invoices[]
  clt_subscriptions     clt_subscriptions[]
  bil_tenant_usage_metrics     bil_tenant_usage_metrics[]
  crm_contracts                crm_contracts[]
  dir_car_makes                dir_car_makes[]
  dir_car_models               dir_car_models[]
  dir_maintenance_types        dir_maintenance_types[]
  dir_platform_configs         dir_platform_configs[]
  doc_documents                doc_documents[]
  fin_accounts                 fin_accounts[]
  fin_driver_payment_batches   fin_driver_payment_batches[]
  fin_driver_payments          fin_driver_payments[]
  fin_toll_transactions        fin_toll_transactions[]
  fin_traffic_fines            fin_traffic_fines[]
  fin_transactions             fin_transactions[]
  flt_vehicle_assignments      flt_vehicle_assignments[]
  flt_vehicle_equipments       flt_vehicle_equipments[]
  flt_vehicle_events           flt_vehicle_events[]
  flt_vehicle_expenses         flt_vehicle_expenses[]
  flt_vehicle_inspections      flt_vehicle_inspections[]
  flt_vehicle_insurances       flt_vehicle_insurances[]
  flt_vehicle_maintenance      flt_vehicle_maintenance[]
  flt_vehicles                 flt_vehicles[]
  rev_driver_revenues          rev_driver_revenues[]
  rev_reconciliations          rev_reconciliations[]
  rev_revenue_imports          rev_revenue_imports[]
  rid_driver_blacklists        rid_driver_blacklists[]
  rid_driver_cooperation_terms rid_driver_cooperation_terms[]
  rid_driver_documents         rid_driver_documents[]
  rid_driver_languages         rid_driver_languages[]
  rid_driver_performances      rid_driver_performances[]
  rid_driver_requests          rid_driver_requests[]
  rid_driver_training          rid_driver_training[]
  rid_drivers                  rid_drivers[]
  sch_goal_types               sch_goal_types[]
  sch_goals                    sch_goals[]
  sch_locations                sch_locations[]
  sch_maintenance_schedules    sch_maintenance_schedules[]
  sch_shift_types              sch_shift_types[]
  sch_shifts                   sch_shifts[]
  sch_task_types               sch_task_types[]
  sch_tasks                    sch_tasks[]
  sup_canned_responses         sup_canned_responses[]
  sup_customer_feedback        sup_customer_feedback[]
  sup_ticket_categories        sup_ticket_categories[]
  sup_ticket_sla_rules         sup_ticket_sla_rules[]
  sup_tickets                  sup_tickets[]
  trp_client_invoices          trp_client_invoices[]
  trp_platform_accounts        trp_platform_accounts[]
  trp_settlements              trp_settlements[]
  trp_trips                    trp_trips[]
  // Quote-to-Cash relations
  bil_amendments               bil_amendments[]
  bil_subscription_schedules   bil_subscription_schedules[]
  crm_orders                   crm_orders[]
  // V6.2: Leads convertis en clients
  crm_leads_converted          crm_leads[]                  @relation("crm_leads_tenant")
  // V6.2-3: Module CLT - relation 1:1 avec clt_masterdata
  clt_masterdata               clt_masterdata?

  @@index([clerk_organization_id])
  @@index([country_code])
  @@index([default_currency])
  @@index([deleted_at])
}

/// V6.2-3: Module CLT - Donnees identite client apres conversion Lead
/// Relation 1:1 avec adm_tenants
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model clt_masterdata {
  id                      String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id               String        @unique @db.Uuid
  // V6.2.1: Client code = tenant_code (denormalized for reporting)
  client_code             String?       @db.VarChar(50)
  origin_lead_code        String?       @db.VarChar(50)
  origin_lead_id          String?       @db.Uuid
  company_name            String        @db.VarChar(255)
  legal_name              String?       @db.VarChar(255)
  tax_id                  String?       @db.VarChar(50)
  billing_email           String?       @db.VarChar(255)
  billing_address         Json?
  primary_contact_name    String?       @db.VarChar(255)
  primary_contact_email   String?       @db.VarChar(255)
  primary_contact_phone   String?       @db.VarChar(50)
  segment                 String?       @db.VarChar(20)
  onboarded_at            DateTime?     @db.Timestamptz(6)
  churned_at              DateTime?     @db.Timestamptz(6)
  churn_reason            String?       @db.VarChar(255)
  metadata                Json          @default("{}")
  created_at              DateTime      @default(now()) @db.Timestamptz(6)
  updated_at              DateTime      @default(now()) @db.Timestamptz(6)
  deleted_at              DateTime?     @db.Timestamptz(6)
  created_by              String?       @db.Uuid
  updated_by              String?       @db.Uuid
  deleted_by              String?       @db.Uuid

  // Relations
  adm_tenants             adm_tenants   @relation(fields: [tenant_id], references: [id], onDelete: Cascade, map: "fk_clt_masterdata_tenant")
  crm_leads               crm_leads?    @relation(fields: [origin_lead_id], references: [id], onDelete: SetNull, map: "fk_clt_masterdata_origin_lead")

  @@index([origin_lead_id], map: "idx_clt_masterdata_origin_lead")
  @@index([segment], map: "idx_clt_masterdata_segment")
  @@index([deleted_at], map: "idx_clt_masterdata_deleted_at")
  @@index([client_code], map: "idx_clt_masterdata_client_code")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model bil_billing_plans {
  id                                                                                    String                     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  plan_name                                                                             String
  description                                                                           String?
  monthly_fee                                                                           Decimal                    @default(0) @db.Decimal(14, 2)
  annual_fee                                                                            Decimal                    @default(0) @db.Decimal(14, 2)
  currency                                                                              String                     @db.VarChar(3)
  features                                                                              Json                       @default("{}")
  metadata                                                                              Json                       @default("{}")
  created_at                                                                            DateTime                   @default(now()) @db.Timestamptz(6)
  created_by                                                                            String?                    @db.Uuid
  updated_at                                                                            DateTime                   @default(now()) @db.Timestamptz(6)
  updated_by                                                                            String?                    @db.Uuid
  deleted_at                                                                            DateTime?                  @db.Timestamptz(6)
  deleted_by                                                                            String?                    @db.Uuid
  deletion_reason                                                                       String?
  plan_code                                                                             String?                    @db.VarChar(100)
  price_monthly                                                                         Decimal?                   @db.Decimal(18, 2)
  price_yearly                                                                          Decimal?                   @db.Decimal(18, 2)
  vat_rate                                                                              Decimal?                   @db.Decimal(5, 2)
  max_vehicles                                                                          Int?
  max_drivers                                                                           Int?
  max_users                                                                             Int?
  version                                                                               Int?                       @default(1)
  stripe_price_id_monthly                                                               String?
  stripe_price_id_yearly                                                                String?
  billing_interval                                                                      billing_interval?          @default(month)
  status                                                                                billing_plan_status?
  description_translations                                                              Json?
  ewy75s5           adm_provider_employees?    @relation("E_fx2i2g", fields: [created_by], references: [id])
  euwgj6y           adm_provider_employees?    @relation("E_n3iv2h", fields: [deleted_by], references: [id])
  emn4ymg           adm_provider_employees?    @relation("E_vcufmz", fields: [updated_by], references: [id])
  bil_promotions                                                                        bil_promotions[]
  xg6p2jq          clt_subscriptions[] @relation("X_wagae5")
  xm8l72q clt_subscriptions[] @relation("X_6s6mwl")
  crm_contracts                                                                         crm_contracts[]
  crm_opportunities                                                                     crm_opportunities[]
  // Quote-to-Cash relations
  bil_amendments_new_plan                                                               bil_amendments[]           @relation("bil_amendments_new_plan")
  bil_amendments_old_plan                                                               bil_amendments[]           @relation("bil_amendments_old_plan")
  bil_subscription_schedule_phases                                                      bil_subscription_schedule_phases[]
  crm_orders                                                                            crm_orders[]

  @@index([created_by])
  @@index([deleted_at])
  @@index([features], type: Gin)
  @@index([metadata], type: Gin)
  @@index([updated_by])
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model bil_payment_methods {
  id                                                                            String                     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                     String                     @db.Uuid
  provider_token                                                                String
  expires_at                                                                    DateTime?                  @db.Date
  metadata                                                                      Json                       @default("{}")
  created_at                                                                    DateTime                   @default(now()) @db.Timestamptz(6)
  created_by                                                                    String?                    @db.Uuid
  updated_at                                                                    DateTime                   @default(now()) @db.Timestamptz(6)
  updated_by                                                                    String?                    @db.Uuid
  deleted_at                                                                    DateTime?                  @db.Timestamptz(6)
  deleted_by                                                                    String?                    @db.Uuid
  deletion_reason                                                               String?
  provider                                                                      String?                    @db.VarChar(50)
  provider_payment_method_id                                                    String?
  payment_type                                                                  payment_type?
  card_brand                                                                    String?                    @db.VarChar(50)
  card_last4                                                                    String?                    @db.Char(4)
  card_exp_month                                                                Int?
  card_exp_year                                                                 Int?
  bank_name                                                                     String?                    @db.VarChar(100)
  bank_account_last4                                                            String?                    @db.Char(4)
  bank_country                                                                  String?                    @db.Char(2)
  status                                                                        payment_method_status?     @default(active)
  is_default                                                                    Boolean?                   @default(false)
  last_used_at                                                                  DateTime?                  @db.Timestamptz(6)
  evzx43c adm_provider_employees?    @relation("E_1ygpij", fields: [created_by], references: [id])
  evuqkvr adm_provider_employees?    @relation("E_94x2ik", fields: [deleted_by], references: [id])
  adm_tenants                                                                   adm_tenants                @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  enlf0b9 adm_provider_employees?    @relation("E_he8n32", fields: [updated_by], references: [id])
  clt_subscriptions                                                      clt_subscriptions[]
  fin_traffic_fines                                                             fin_traffic_fines[]
  fin_transactions                                                              fin_transactions[]

  @@index([created_by])
  @@index([deleted_at])
  @@index([expires_at])
  @@index([metadata], type: Gin)
  @@index([tenant_id])
  @@index([updated_by])
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model bil_promotion_usage {
  id                  String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  promotion_id        String               @db.Uuid
  tenant_id           String               @db.Uuid
  invoice_id          String?              @db.Uuid
  applied_at          DateTime             @default(now()) @db.Timestamptz(6)
  discount_amount     Decimal              @db.Decimal(18, 2)
  clt_invoices clt_invoices? @relation(fields: [invoice_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_bil_promotion_usage_invoice")
  bil_promotions      bil_promotions       @relation(fields: [promotion_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_bil_promotion_usage_promotion")
  adm_tenants         adm_tenants          @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_bil_promotion_usage_tenant")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model bil_promotions {
  id                     String                  @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  code                   String                  @unique @db.VarChar(50)
  description            String?
  discount_type          promotion_discount_type
  discount_value         Decimal                 @db.Decimal(10, 2)
  currency               String?                 @db.Char(3)
  max_redemptions        Int?
  redemptions_count      Int                     @default(0)
  valid_from             DateTime                @db.Timestamptz(6)
  valid_until            DateTime                @db.Timestamptz(6)
  applies_to             promotion_applies_to
  plan_id                String?                 @db.Uuid
  status                 promotion_status        @default(active)
  metadata               Json?                   @default("{}")
  created_at             DateTime                @default(now()) @db.Timestamptz(6)
  created_by             String?                 @db.Uuid
  description_translations Json?
  bil_promotion_usage    bil_promotion_usage[]
  adm_provider_employees adm_provider_employees? @relation(fields: [created_by], references: [id], onUpdate: NoAction, map: "fk_bil_promotions_created_by")
  bil_billing_plans      bil_billing_plans?      @relation(fields: [plan_id], references: [id], onUpdate: NoAction, map: "fk_bil_promotions_plan")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model clt_invoice_lines {
  id                                                                                 String                    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  invoice_id                                                                         String                    @db.Uuid
  description                                                                        String
  amount                                                                             Decimal                   @default(0) @db.Decimal(18, 2)
  quantity                                                                           Decimal                   @default(1) @db.Decimal(10, 2)
  metadata                                                                           Json                      @default("{}")
  created_at                                                                         DateTime                  @default(now()) @db.Timestamptz(6)
  created_by                                                                         String?                   @db.Uuid
  updated_at                                                                         DateTime                  @default(now()) @db.Timestamptz(6)
  updated_by                                                                         String?                   @db.Uuid
  deleted_at                                                                         DateTime?                 @db.Timestamptz(6)
  deleted_by                                                                         String?                   @db.Uuid
  deletion_reason                                                                    String?
  line_type                                                                          invoice_line_type?
  unit_price                                                                         Decimal?                  @db.Decimal(18, 2)
  tax_rate                                                                           Decimal?                  @db.Decimal(5, 2)
  tax_amount                                                                         Decimal?                  @db.Decimal(18, 2)
  discount_amount                                                                    Decimal?                  @db.Decimal(18, 2)
  source_type                                                                        invoice_line_source_type?
  source_id                                                                          String?                   @db.Uuid
  er9pl02 adm_provider_employees?   @relation("E_a8kxad", fields: [created_by], references: [id])
  eyg5y03 adm_provider_employees?   @relation("E_hf1aae", fields: [deleted_by], references: [id])
  clt_invoices                                                                clt_invoices       @relation(fields: [invoice_id], references: [id], onDelete: Cascade)
  esbmjej adm_provider_employees?   @relation("E_pocuuw", fields: [updated_by], references: [id])

  @@index([created_by])
  @@index([deleted_at])
  @@index([description])
  @@index([invoice_id])
  @@index([metadata], type: Gin)
  @@index([updated_by])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model clt_invoices {
  id                                                                            String                     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                     String                     @db.Uuid
  invoice_number                                                                String
  invoice_date                                                                  DateTime                   @db.Date
  due_date                                                                      DateTime                   @db.Date
  total_amount                                                                  Decimal                    @default(0) @db.Decimal(18, 2)
  currency                                                                      String                     @db.VarChar(3)
  metadata                                                                      Json                       @default("{}")
  created_at                                                                    DateTime                   @default(now()) @db.Timestamptz(6)
  created_by                                                                    String?                    @db.Uuid
  updated_at                                                                    DateTime                   @default(now()) @db.Timestamptz(6)
  updated_by                                                                    String?                    @db.Uuid
  deleted_at                                                                    DateTime?                  @db.Timestamptz(6)
  deleted_by                                                                    String?                    @db.Uuid
  deletion_reason                                                               String?
  subscription_id                                                               String?                    @db.Uuid
  period_start                                                                  DateTime?                  @db.Timestamptz(6)
  period_end                                                                    DateTime?                  @db.Timestamptz(6)
  paid_at                                                                       DateTime?                  @db.Timestamptz(6)
  subtotal                                                                      Decimal?                   @db.Decimal(18, 2)
  tax_rate                                                                      Decimal?                   @db.Decimal(5, 2)
  tax_amount                                                                    Decimal?                   @db.Decimal(18, 2)
  amount_paid                                                                   Decimal?                   @default(0) @db.Decimal(18, 2)
  amount_due                                                                    Decimal?                   @default(0) @db.Decimal(18, 2)
  status                                                                        invoice_status?
  stripe_invoice_id                                                             String?                    @db.VarChar(255)
  document_url                                                                  String?
  bil_promotion_usage                                                           bil_promotion_usage[]
  clt_invoice_lines                                                      clt_invoice_lines[]
  ehukz53 adm_provider_employees?    @relation("E_d2rxom", fields: [created_by], references: [id])
  eao4m52 adm_provider_employees?    @relation("E_k98aon", fields: [deleted_by], references: [id])
  adm_tenants                                                                   adm_tenants                @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  e2et1kk adm_provider_employees?    @relation("E_sijv95", fields: [updated_by], references: [id])
  clt_subscriptions                                                      clt_subscriptions?  @relation(fields: [subscription_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_bil_invoices_subscription")

  @@index([created_by])
  @@index([deleted_at])
  @@index([due_date])
  @@index([invoice_date])
  @@index([invoice_number])
  @@index([metadata], type: Gin)
  @@index([tenant_id])
  @@index([updated_by])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model clt_subscriptions {
  id                                                                                 String                     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                          String                     @db.Uuid
  plan_id                                                                            String                     @db.Uuid
  subscription_start                                                                 DateTime                   @db.Date
  subscription_end                                                                   DateTime?                  @db.Date
  metadata                                                                           Json                       @default("{}")
  created_at                                                                         DateTime                   @default(now()) @db.Timestamptz(6)
  created_by                                                                         String?                    @db.Uuid
  updated_at                                                                         DateTime                   @default(now()) @db.Timestamptz(6)
  updated_by                                                                         String?                    @db.Uuid
  deleted_at                                                                         DateTime?                  @db.Timestamptz(6)
  deleted_by                                                                         String?                    @db.Uuid
  deletion_reason                                                                    String?
  previous_plan_id                                                                   String?                    @db.Uuid
  plan_version                                                                       Int?
  payment_method_id                                                                  String?                    @db.Uuid
  billing_cycle                                                                      billing_interval?          @default(month)
  current_period_start                                                               DateTime?                  @db.Timestamptz(6)
  current_period_end                                                                 DateTime?                  @db.Timestamptz(6)
  trial_end                                                                          DateTime?                  @db.Timestamptz(6)
  status                                                                             subscription_status?
  cancel_at_period_end                                                               Boolean?                   @default(true)
  auto_renew                                                                         Boolean?                   @default(true)
  provider                                                                           String?                    @db.VarChar(50)
  provider_subscription_id                                                           String?
  provider_customer_id                                                               String?
  clt_invoices                                                                clt_invoices[]
  e8ts7yd adm_provider_employees?    @relation("E_puwvo2", fields: [created_by], references: [id])
  e1nbuyc adm_provider_employees?    @relation("E_iogio1", fields: [deleted_by], references: [id])
  xgunea8              bil_billing_plans          @relation("X_wagae5", fields: [plan_id], references: [id], onDelete: Cascade)
  adm_tenants                                                                        adm_tenants                @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  e6lzpm6 adm_provider_employees?    @relation("E_af4y3j", fields: [updated_by], references: [id])
  bil_payment_methods                                                                bil_payment_methods?       @relation(fields: [payment_method_id], references: [id], onUpdate: NoAction, map: "fk_bil_subscriptions_payment_method")
  xxnqpvc     bil_billing_plans?         @relation("X_6s6mwl", fields: [previous_plan_id], references: [id], onUpdate: NoAction, map: "fk_bil_subscriptions_previous_plan")
  bil_tenant_usage_metrics                                                           bil_tenant_usage_metrics[]
  crm_contracts                                                                      crm_contracts[]
  // Quote-to-Cash relations
  bil_amendments                                                                     bil_amendments[]
  crm_orders                                                                         crm_orders[]

  @@index([created_by])
  @@index([deleted_at])
  @@index([metadata], type: Gin)
  @@index([plan_id])
  @@index([subscription_end])
  @@index([subscription_start])
  @@index([tenant_id])
  @@index([updated_by])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model bil_tenant_usage_metrics {
  id                                                                                 String                    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                          String                    @db.Uuid
  metric_name                                                                        String                    @db.VarChar(50)
  metric_value                                                                       Decimal                   @default(0) @db.Decimal(18, 2)
  period_start                                                                       DateTime                  @db.Date
  period_end                                                                         DateTime                  @db.Date
  metadata                                                                           Json                      @default("{}")
  created_at                                                                         DateTime                  @default(now()) @db.Timestamptz(6)
  created_by                                                                         String?                   @db.Uuid
  updated_at                                                                         DateTime                  @default(now()) @db.Timestamptz(6)
  updated_by                                                                         String?                   @db.Uuid
  deleted_at                                                                         DateTime?                 @db.Timestamptz(6)
  deleted_by                                                                         String?                   @db.Uuid
  deletion_reason                                                                    String?
  metric_type_id                                                                     String?                   @db.Uuid
  subscription_id                                                                    String?                   @db.Uuid
  plan_version                                                                       Int?
  period_type                                                                        period_type?
  period_start_ts                                                                    DateTime?                 @db.Timestamptz(6)
  period_end_ts                                                                      DateTime?                 @db.Timestamptz(6)
  metric_source                                                                      metric_source?
  ed2bezb adm_provider_employees?   @relation("E_c29c7q", fields: [created_by], references: [id])
  e5vv1za adm_provider_employees?   @relation("E_j8pp7r", fields: [deleted_by], references: [id])
  adm_tenants                                                                        adm_tenants               @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  e2dgil8 adm_provider_employees?   @relation("E_ri19s9", fields: [updated_by], references: [id])
  clt_subscriptions                                                           clt_subscriptions? @relation(fields: [subscription_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_bil_usage_metrics_subscription")
  bil_usage_metric_types                                                             bil_usage_metric_types?   @relation(fields: [metric_type_id], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_bil_usage_metrics_type")

  @@index([created_by])
  @@index([deleted_at])
  @@index([metadata], type: Gin)
  @@index([metric_name])
  @@index([period_end])
  @@index([period_start])
  @@index([tenant_id])
  @@index([updated_by])
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model bil_usage_metric_types {
  id                       String                     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name                     String                     @unique @db.VarChar(50)
  unit                     String                     @db.VarChar(20)
  description              String?
  aggregation_method       aggregation_method
  created_at               DateTime                   @default(now()) @db.Timestamptz(6)
  name_translations        Json
  description_translations Json?
  bil_tenant_usage_metrics bil_tenant_usage_metrics[]
}

/// Quote-to-Cash: bil_plans
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model bil_plans {
  id                       String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  provider_id              String?                 @db.Uuid
  code                     String                  @db.VarChar(50)
  billing_interval         billing_interval
  max_vehicles             Int?
  max_drivers              Int?
  max_users                Int?
  features                 Json?                   @default("[]")
  display_order            Int?                    @default(0)
  is_popular               Boolean?                @default(false)
  is_active                Boolean                 @default(true)
  metadata                 Json?                   @default("{}")
  created_at               DateTime                @default(now()) @db.Timestamptz(6)
  updated_at               DateTime                @default(now()) @db.Timestamptz(6)
  deleted_at               DateTime?               @db.Timestamptz(6)
  created_by               String?                 @db.Uuid
  updated_by               String?                 @db.Uuid
  deleted_by               String?                 @db.Uuid
  deletion_reason          String?
  name_translations        Json
  description_translations Json
  crm_quote_items          crm_quote_items[]
  adm_providers            adm_providers?          @relation("bil_plans_provider", fields: [provider_id], references: [id], onDelete: Cascade, map: "bil_plans_provider_id_fkey")
  adm_provider_employees_created_by adm_provider_employees? @relation("E_kwdxok", fields: [created_by], references: [id], onDelete: Restrict, map: "fk_bil_plans_created_by")
  adm_provider_employees_deleted_by adm_provider_employees? @relation("E_dpxkoj", fields: [deleted_by], references: [id], onDelete: Restrict, map: "fk_bil_plans_deleted_by")
  adm_provider_employees_updated_by adm_provider_employees? @relation("E_5gm041", fields: [updated_by], references: [id], onDelete: Restrict, map: "fk_bil_plans_updated_by")

  @@unique([code, provider_id], map: "uq_bil_plans_code_provider")
  @@index([is_active], map: "idx_bil_plans_active")
  @@index([provider_id], map: "idx_bil_plans_provider")
}

/// Quote-to-Cash: bil_addons
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model bil_addons {
  id                       String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  provider_id              String?                 @db.Uuid
  code                     String                  @db.VarChar(50)
  is_recurring             Boolean
  billing_interval         billing_interval?
  compatible_plan_ids      String[]                @db.Uuid
  category                 String?                 @db.VarChar(50)
  is_active                Boolean
  metadata                 Json?
  created_at               DateTime                @default(now()) @db.Timestamptz(6)
  updated_at               DateTime                @default(now()) @db.Timestamptz(6)
  deleted_at               DateTime?               @db.Timestamptz(6)
  created_by               String?                 @db.Uuid
  updated_by               String?                 @db.Uuid
  deleted_by               String?                 @db.Uuid
  deletion_reason          String?
  name_translations        Json
  description_translations Json
  crm_quote_approvals      crm_quote_approvals[]
  bil_offer_rules          bil_offer_rules[]
  adm_providers            adm_providers?          @relation("bil_addons_provider", fields: [provider_id], references: [id], onDelete: Cascade, map: "bil_addons_provider_id_fkey")
  adm_provider_employees_created_by adm_provider_employees? @relation("E_d4dtif", fields: [created_by], references: [id], onDelete: Restrict, map: "fk_bil_addons_created_by")
  adm_provider_employees_deleted_by adm_provider_employees? @relation("E_5xxgie", fields: [deleted_by], references: [id], onDelete: Restrict, map: "fk_bil_addons_deleted_by")
  adm_provider_employees_updated_by adm_provider_employees? @relation("E_2be424", fields: [updated_by], references: [id], onDelete: Restrict, map: "fk_bil_addons_updated_by")

  @@unique([code, provider_id], map: "uq_bil_addons_code_provider")
  @@index([category], map: "idx_bil_addons_category")
  @@index([provider_id], map: "idx_bil_addons_provider")
}

/// Quote-to-Cash: bil_services
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model bil_services {
  id                       String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  provider_id              String?                 @db.Uuid
  code                     String                  @db.VarChar(50)
  service_type             String                  @db.VarChar(30)
  billing_interval         billing_interval?
  hourly_rate              Decimal?                @db.Decimal(10, 2)
  min_hours                Decimal?                @db.Decimal(5, 2)
  category                 String?                 @db.VarChar(50)
  is_active                Boolean
  metadata                 Json?
  created_at               DateTime                @default(now()) @db.Timestamptz(6)
  updated_at               DateTime                @default(now()) @db.Timestamptz(6)
  deleted_at               DateTime?               @db.Timestamptz(6)
  created_by               String?                 @db.Uuid
  updated_by               String?                 @db.Uuid
  deleted_by               String?                 @db.Uuid
  deletion_reason          String?
  name_translations        Json
  description_translations Json
  adm_providers            adm_providers?          @relation("bil_services_provider", fields: [provider_id], references: [id], onDelete: Cascade, map: "bil_services_provider_id_fkey")
  adm_provider_employees_created_by adm_provider_employees? @relation("E_gg5730", fields: [created_by], references: [id], onDelete: Restrict, map: "fk_bil_services_created_by")
  adm_provider_employees_deleted_by adm_provider_employees? @relation("E_99ou2z", fields: [deleted_by], references: [id], onDelete: Restrict, map: "fk_bil_services_deleted_by")
  adm_provider_employees_updated_by adm_provider_employees? @relation("E_10d9ih", fields: [updated_by], references: [id], onDelete: Restrict, map: "fk_bil_services_updated_by")

  @@unique([code, provider_id], map: "uq_bil_services_code_provider")
  @@index([service_type], map: "idx_bil_services_type")
  @@index([provider_id], map: "idx_bil_services_provider")
}

/// Quote-to-Cash: bil_offer_rules
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model bil_offer_rules {
  id                         String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  provider_id                String                  @db.Uuid
  code                       String                  @db.VarChar(50)
  name_translations          Json
  description_translations   Json?
  offer_type                 String                  @db.VarChar(30)
  free_months                Int?
  free_addon_id              String?                 @db.Uuid
  max_adjustment_percent     Decimal?                @db.Decimal(5, 2)
  volume_min_vehicles        Int?
  volume_price_per_vehicle   Decimal?                @db.Decimal(10, 2)
  min_vehicles               Int?
  max_vehicles               Int?
  min_contract_months        Int?
  country_codes              String[]
  requires_approval          Boolean                 @default(false)
  approval_threshold_percent Decimal?                @db.Decimal(5, 2)
  approval_role              String?                 @db.VarChar(50)
  visible_to_sales_rep       Boolean                 @default(true)
  effective_from             DateTime?               @db.Date
  effective_to               DateTime?               @db.Date
  is_active                  Boolean                 @default(true)
  display_order              Int?                    @default(0)
  metadata                   Json?
  created_at                 DateTime                @default(now()) @db.Timestamptz(6)
  created_by                 String?                 @db.Uuid
  updated_at                 DateTime                @default(now()) @db.Timestamptz(6)
  updated_by                 String?                 @db.Uuid
  deleted_at                 DateTime?               @db.Timestamptz(6)
  deleted_by                 String?                 @db.Uuid
  crm_quote_approvals        crm_quote_approvals[]
  adm_providers              adm_providers           @relation("bil_offer_rules_provider", fields: [provider_id], references: [id], onDelete: Cascade, map: "bil_offer_rules_provider_id_fkey")
  bil_addons                 bil_addons?             @relation(fields: [free_addon_id], references: [id], map: "bil_offer_rules_free_addon_id_fkey")

  @@unique([code, provider_id], map: "uq_bil_offer_rules_code_provider")
  @@index([is_active], map: "idx_bil_offer_rules_active")
  @@index([provider_id], map: "idx_bil_offer_rules_provider")
  @@index([offer_type], map: "idx_bil_offer_rules_type")
}

/// Quote-to-Cash: bil_catalog_prices
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model bil_catalog_prices {
  id           String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  catalog_type String   @db.VarChar(20)
  catalog_id   String   @db.Uuid
  country_code String   @db.VarChar(2)
  currency     String   @db.VarChar(3)
  base_price   Decimal  @db.Decimal(12, 2)
  min_price    Decimal? @db.Decimal(12, 2)
  is_active    Boolean  @default(true)
  created_at   DateTime @default(now()) @db.Timestamptz(6)
  updated_at   DateTime @default(now()) @db.Timestamptz(6)

  @@unique([catalog_type, catalog_id, country_code], map: "uq_catalog_price_per_country")
  @@index([catalog_type, catalog_id, country_code], map: "idx_bil_catalog_prices_lookup")
}

/// Quote-to-Cash: bil_amendments
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model bil_amendments {
  id                   String                    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  amendment_reference  String                    @unique @db.VarChar(50)
  tenant_id            String                    @db.Uuid
  subscription_id      String                    @db.Uuid
  schedule_id          String?                   @db.Uuid
  provider_id          String                    @db.Uuid
  amendment_type       amendment_type
  status               amendment_status          @default(draft)
  old_plan_id          String?                   @db.Uuid
  new_plan_id          String?                   @db.Uuid
  old_quantity         Int?
  new_quantity         Int?
  old_price            Decimal?                  @db.Decimal(15, 2)
  new_price            Decimal?                  @db.Decimal(15, 2)
  old_billing_cycle    billing_interval?
  new_billing_cycle    billing_interval?
  requested_at         DateTime                  @default(now()) @db.Timestamptz(6)
  effective_date       DateTime                  @db.Date
  applied_at           DateTime?                 @db.Timestamptz(6)
  proration_behavior   proration_behavior        @default(create_prorations)
  proration_amount     Decimal?                  @db.Decimal(15, 2)
  proration_invoice_id String?                   @db.VarChar(100)
  requires_approval    Boolean?                  @default(false)
  approved_by          String?                   @db.Uuid
  approved_at          DateTime?                 @db.Timestamptz(6)
  rejected_by          String?                   @db.Uuid
  rejected_at          DateTime?                 @db.Timestamptz(6)
  rejection_reason     String?
  stripe_amendment_id  String?                   @db.VarChar(100)
  stripe_invoice_id    String?                   @db.VarChar(100)
  reason               String?
  internal_notes       String?
  metadata             Json?                     @default("{}")
  created_by           String?                   @db.Uuid
  updated_by           String?                   @db.Uuid
  created_at           DateTime                  @default(now()) @db.Timestamptz(6)
  updated_at           DateTime                  @default(now()) @db.Timestamptz(6)
  deleted_at           DateTime?                 @db.Timestamptz(6)
  deleted_by           String?                   @db.Uuid
  bil_billing_plans_new bil_billing_plans?       @relation("bil_amendments_new_plan", fields: [new_plan_id], references: [id], onDelete: SetNull, map: "bil_amendments_new_plan_id_fkey")
  bil_billing_plans_old bil_billing_plans?       @relation("bil_amendments_old_plan", fields: [old_plan_id], references: [id], onDelete: SetNull, map: "bil_amendments_old_plan_id_fkey")
  adm_providers         adm_providers            @relation("bil_amendments_provider", fields: [provider_id], references: [id], onDelete: Cascade, map: "bil_amendments_provider_id_fkey")
  bil_subscription_schedules bil_subscription_schedules? @relation(fields: [schedule_id], references: [id], onDelete: SetNull, map: "bil_amendments_schedule_id_fkey")
  clt_subscriptions clt_subscriptions @relation(fields: [subscription_id], references: [id], onDelete: Cascade, map: "bil_amendments_subscription_id_fkey")
  adm_tenants           adm_tenants              @relation(fields: [tenant_id], references: [id], onDelete: Cascade, map: "bil_amendments_tenant_id_fkey")

  @@index([amendment_reference], map: "idx_bil_amendments_reference")
  @@index([effective_date], map: "idx_bil_amendments_effective_date")
  @@index([provider_id], map: "idx_bil_amendments_provider_id")
  @@index([schedule_id], map: "idx_bil_amendments_schedule_id")
  @@index([status], map: "idx_bil_amendments_status")
  @@index([subscription_id], map: "idx_bil_amendments_subscription_id")
  @@index([tenant_id], map: "idx_bil_amendments_tenant_id")
  @@index([amendment_type], map: "idx_bil_amendments_type")
}

/// Quote-to-Cash: bil_subscription_schedules
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model bil_subscription_schedules {
  id                     String                           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  schedule_reference     String                           @unique @db.VarChar(50)
  tenant_id              String                           @db.Uuid
  order_id               String?                          @db.Uuid
  provider_id            String                           @db.Uuid
  stripe_schedule_id     String?                          @db.VarChar(100)
  stripe_customer_id     String?                          @db.VarChar(100)
  stripe_subscription_id String?                          @db.VarChar(100)
  status                 schedule_status                  @default(not_started)
  end_behavior           schedule_end_behavior            @default(cancel)
  total_phases           Int                              @default(1)
  current_phase_number   Int?                             @default(1)
  start_date             DateTime                         @db.Date
  end_date               DateTime?                        @db.Date
  current_phase_start    DateTime?                        @db.Date
  current_phase_end      DateTime?                        @db.Date
  currency               String                           @default("EUR") @db.Char(3)
  total_contract_value   Decimal?                         @db.Decimal(18, 2)
  metadata               Json?                            @default("{}")
  last_synced_at         DateTime?                        @db.Timestamptz(6)
  sync_error             String?
  created_by             String?                          @db.Uuid
  updated_by             String?                          @db.Uuid
  created_at             DateTime                         @default(now()) @db.Timestamptz(6)
  updated_at             DateTime                         @default(now()) @db.Timestamptz(6)
  deleted_at             DateTime?                        @db.Timestamptz(6)
  deleted_by             String?                          @db.Uuid
  deletion_reason        String?
  bil_amendments         bil_amendments[]
  bil_subscription_schedule_phases bil_subscription_schedule_phases[]
  crm_orders             crm_orders?                      @relation(fields: [order_id], references: [id], onDelete: SetNull, map: "bil_subscription_schedules_order_id_fkey")
  adm_providers          adm_providers                    @relation("X_n952v8", fields: [provider_id], references: [id], onDelete: Cascade, map: "bil_subscription_schedules_provider_id_fkey")
  adm_tenants            adm_tenants                      @relation(fields: [tenant_id], references: [id], onDelete: Cascade, map: "bil_subscription_schedules_tenant_id_fkey")

  @@index([order_id], map: "idx_bil_schedules_order_id")
  @@index([provider_id], map: "idx_bil_schedules_provider_id")
  @@index([schedule_reference], map: "idx_bil_schedules_reference")
  @@index([status], map: "idx_bil_schedules_status")
  @@index([stripe_schedule_id], map: "idx_bil_schedules_stripe_schedule_id")
  @@index([stripe_subscription_id], map: "idx_bil_schedules_stripe_subscription_id")
  @@index([tenant_id], map: "idx_bil_schedules_tenant_id")
}

/// Quote-to-Cash: bil_subscription_schedule_phases
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model bil_subscription_schedule_phases {
  id                 String                     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  schedule_id        String                     @db.Uuid
  plan_id            String?                    @db.Uuid
  provider_id        String                     @db.Uuid
  phase_number       Int
  phase_name         String?                    @db.VarChar(100)
  start_date         DateTime                   @db.Date
  end_date           DateTime                   @db.Date
  duration_months    Int?
  unit_price         Decimal                    @db.Decimal(15, 2)
  quantity           Int                        @default(1)
  discount_percent   Decimal?                   @default(0) @db.Decimal(5, 2)
  discount_amount    Decimal?                   @default(0) @db.Decimal(15, 2)
  phase_total        Decimal                    @db.Decimal(15, 2)
  billing_cycle      billing_interval           @default(month)
  proration_behavior proration_behavior?        @default(create_prorations)
  trial_days         Int?                       @default(0)
  stripe_price_id    String?                    @db.VarChar(100)
  stripe_coupon_id   String?                    @db.VarChar(100)
  metadata           Json?                      @default("{}")
  created_at         DateTime                   @default(now()) @db.Timestamptz(6)
  updated_at         DateTime                   @default(now()) @db.Timestamptz(6)
  bil_subscription_schedules bil_subscription_schedules @relation(fields: [schedule_id], references: [id], onDelete: Cascade, map: "bil_subscription_schedule_phases_schedule_id_fkey")
  bil_billing_plans  bil_billing_plans?         @relation(fields: [plan_id], references: [id], onDelete: Restrict, map: "bil_subscription_schedule_phases_plan_id_fkey")
  adm_providers      adm_providers              @relation("X_j6pdo8", fields: [provider_id], references: [id], onDelete: Cascade, map: "bil_subscription_schedule_phases_provider_id_fkey")

  @@unique([schedule_id, phase_number], map: "idx_bil_schedule_phases_unique")
  @@index([plan_id], map: "idx_bil_schedule_phases_plan_id")
  @@index([provider_id], map: "idx_bil_schedule_phases_provider_id")
  @@index([schedule_id], map: "idx_bil_schedule_phases_schedule_id")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model crm_addresses {
  id            String          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  street_line1  String
  street_line2  String?
  city          String          @db.VarChar(100)
  state         String?         @db.VarChar(100)
  postal_code   String?         @db.VarChar(20)
  country_code  String          @db.Char(2)
  address_type  address_type?
  is_default    Boolean         @default(false)
  created_at    DateTime        @default(now()) @db.Timestamptz(6)
  provider_id   String?         @db.Uuid
  crm_contracts crm_contracts[]
  adm_providers adm_providers?  @relation("crm_addresses_provider", fields: [provider_id], references: [id], map: "fk_crm_addresses_provider")
  // Quote-to-Cash relations
  crm_orders    crm_orders[]    @relation("crm_orders_billing_address")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model crm_activities {
  id               String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  lead_id          String?                 @db.Uuid
  opportunity_id   String?                 @db.Uuid
  provider_id      String                  @db.Uuid
  activity_type    String                  @db.VarChar(50)
  subject          String                  @db.VarChar(255)
  description      String?
  activity_date    DateTime                @default(now()) @db.Timestamptz(6)
  duration_minutes Int?
  outcome          String?                 @db.VarChar(100)
  is_completed     Boolean?                @default(false)
  completed_at     DateTime?               @db.Timestamptz(6)
  created_by       String?                 @db.Uuid
  created_at       DateTime?               @default(now()) @db.Timestamptz(6)
  updated_at       DateTime?               @default(now()) @db.Timestamptz(6)
  adm_provider_employees adm_provider_employees? @relation(fields: [created_by], references: [id], map: "crm_activities_created_by_fkey")
  crm_leads              crm_leads?              @relation(fields: [lead_id], references: [id], onDelete: Cascade, map: "crm_activities_lead_id_fkey")
  crm_opportunities      crm_opportunities?      @relation(fields: [opportunity_id], references: [id], onDelete: Cascade, map: "crm_activities_opportunity_id_fkey")
  adm_providers          adm_providers           @relation(fields: [provider_id], references: [id], map: "crm_activities_provider_id_fkey")

  @@index([activity_date(sort: Desc)], map: "idx_activities_date")
  @@index([lead_id], map: "idx_activities_lead")
  @@index([opportunity_id], map: "idx_activities_opportunity")
  @@index([provider_id], map: "idx_activities_provider")
  @@index([activity_type], map: "idx_activities_type")
}

/// Quote-to-Cash: crm_quotes
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model crm_quotes {
  id                       String                 @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  quote_reference          String                 @unique @db.VarChar(50)
  quote_code               String                 @db.VarChar(30)
  quote_version            Int                    @default(1)
  parent_quote_id          String?                @db.Uuid
  opportunity_id           String?                @db.Uuid
  lead_id                  String?                @db.Uuid
  status                   quote_status           @default(draft)
  valid_from               DateTime               @default(dbgenerated("CURRENT_DATE")) @db.Date
  valid_until              DateTime               @db.Date
  contract_start_date      DateTime?              @db.Date
  contract_duration_months Int                    @default(12)
  billing_cycle            billing_interval       @default(month)
  currency                 String                 @default("EUR") @db.Char(3)
  subtotal                 Decimal                @default(0) @db.Decimal(15, 2)
  discount_type            discount_type?
  discount_value           Decimal?               @default(0) @db.Decimal(15, 2)
  discount_amount          Decimal?               @default(0) @db.Decimal(15, 2)
  tax_rate                 Decimal                @default(0) @db.Decimal(5, 2)
  tax_amount               Decimal?               @default(0) @db.Decimal(15, 2)
  total_value              Decimal?               @default(0) @db.Decimal(18, 2)
  monthly_recurring_value  Decimal?               @db.Decimal(15, 2)
  annual_recurring_value   Decimal?               @db.Decimal(15, 2)
  converted_to_order_id    String?                @db.Uuid
  converted_at             DateTime?              @db.Timestamptz(6)
  document_url             String?
  notes                    String?
  metadata                 Json                   @default("{}")
  created_by               String                 @db.Uuid
  updated_by               String?                @db.Uuid
  deleted_by               String?                @db.Uuid
  deletion_reason          String?
  created_at               DateTime               @default(now()) @db.Timestamptz(6)
  updated_at               DateTime               @default(now()) @db.Timestamptz(6)
  deleted_at               DateTime?              @db.Timestamptz(6)
  provider_id              String?                @db.Uuid
  sent_at                  DateTime?              @db.Timestamptz(6)
  first_viewed_at          DateTime?              @db.Timestamptz(6)
  last_viewed_at           DateTime?              @db.Timestamptz(6)
  view_count               Int?                   @default(0)
  accepted_at              DateTime?              @db.Timestamptz(6)
  rejected_at              DateTime?              @db.Timestamptz(6)
  rejection_reason         String?
  expired_at               DateTime?              @db.Timestamptz(6)
  document_generated_at    DateTime?              @db.Timestamptz(6)
  terms_and_conditions     String?
  public_token             String?                @unique @db.VarChar(64)
  // V5: Colonnes avantages commerciaux
  free_months              Int?                   @default(0)
  free_vehicles_count      Int?                   @default(0)
  free_vehicles_ratio      String?                @db.VarChar(10)
  unit_price_override      Decimal?               @db.Decimal(15, 2)
  unit_price_approved_by   String?                @db.Uuid
  unit_price_approved_at   DateTime?              @db.Timestamptz(6)
  escalation_required      Boolean?               @default(false)
  escalation_status        String?                @db.VarChar(20)
  escalated_at             DateTime?              @db.Timestamptz(6)
  escalation_decided_at    DateTime?              @db.Timestamptz(6)
  escalation_decided_by    String?                @db.Uuid
  // Relations
  crm_quote_items          crm_quote_items[]
  crm_quote_approvals      crm_quote_approvals[]
  crm_orders_from_quote    crm_orders[]           @relation("crm_orders_quote")
  parent_quote             crm_quotes?            @relation("crm_quotes_parent", fields: [parent_quote_id], references: [id], onDelete: SetNull, map: "fk_crm_quotes_parent_quote")
  child_quotes             crm_quotes[]           @relation("crm_quotes_parent")
  converted_order          crm_orders?            @relation("crm_quotes_converted_order", fields: [converted_to_order_id], references: [id], onDelete: SetNull, map: "fk_crm_quotes_converted_order")
  adm_providers            adm_providers?         @relation("crm_quotes_provider", fields: [provider_id], references: [id], map: "fk_crm_quotes_provider")
  // V5: Relation Quote  Lead (direct, sans Opportunity)
  crm_leads                crm_leads?             @relation("crm_quotes_lead", fields: [lead_id], references: [id], onDelete: SetNull, map: "fk_crm_quotes_lead")

  @@index([opportunity_id], map: "idx_crm_quotes_opportunity_id")
  @@index([lead_id], map: "idx_crm_quotes_lead_id")
  @@index([status], map: "idx_crm_quotes_status")
  @@index([valid_until], map: "idx_crm_quotes_valid_until")
  @@index([created_at(sort: Desc)], map: "idx_crm_quotes_created_at")
  @@index([created_by], map: "idx_crm_quotes_created_by")
  @@index([provider_id], map: "idx_crm_quotes_provider_id")
  @@index([parent_quote_id], map: "idx_crm_quotes_parent_quote_id")
}

/// Quote-to-Cash: crm_quote_items
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model crm_quote_items {
  id                   String           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  quote_id             String           @db.Uuid
  sort_order           Int              @default(0)
  item_type            quote_item_type
  recurrence           item_recurrence  @default(recurring)
  plan_id              String?          @db.Uuid
  addon_id             String?          @db.Uuid
  service_id           String?          @db.Uuid
  name                 String           @db.VarChar(200)
  description          String?
  sku                  String?          @db.VarChar(50)
  quantity             Int              @default(1)
  unit_price           Decimal          @db.Decimal(15, 2)
  line_discount_type   discount_type?
  line_discount_value  Decimal?         @default(0) @db.Decimal(15, 2)
  line_discount_amount Decimal?         @default(0) @db.Decimal(15, 2)
  line_total           Decimal?         @default(0) @db.Decimal(15, 2)
  metadata             Json             @default("{}")
  created_at           DateTime         @default(now()) @db.Timestamptz(6)
  updated_at           DateTime         @default(now()) @db.Timestamptz(6)
  provider_id          String?          @db.Uuid
  crm_quotes           crm_quotes       @relation(fields: [quote_id], references: [id], onDelete: Cascade, map: "crm_quote_items_quote_id_fkey")
  bil_plans            bil_plans?       @relation(fields: [plan_id], references: [id], onDelete: SetNull, map: "fk_crm_quote_items_plan")
  adm_providers        adm_providers?   @relation("crm_quote_items_provider", fields: [provider_id], references: [id], map: "fk_crm_quote_items_provider")

  @@index([quote_id], map: "idx_crm_quote_items_quote_id")
  @@index([item_type], map: "idx_crm_quote_items_item_type")
  @@index([plan_id], map: "idx_crm_quote_items_plan_id")
  @@index([provider_id], map: "idx_crm_quote_items_provider_id")
}

/// Quote-to-Cash: crm_quote_approvals
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model crm_quote_approvals {
  id                           String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  quote_id                     String       @db.Uuid
  offer_rule_id                String?      @db.Uuid
  requested_by                 String       @db.Uuid
  requested_at                 DateTime     @default(now()) @db.Timestamptz(6)
  request_reason               String?
  requested_adjustment_percent Decimal?     @db.Decimal(5, 2)
  requested_free_months        Int?
  requested_free_addon_id      String?      @db.Uuid
  requested_volume_price       Decimal?     @db.Decimal(10, 2)
  approval_role                String       @db.VarChar(50)
  approved_by                  String?      @db.Uuid
  approved_at                  DateTime?    @db.Timestamptz(6)
  status                       String       @default("pending") @db.VarChar(20)
  response_comment             String?
  rejection_reason             String?
  expires_at                   DateTime?    @db.Timestamptz(6)
  created_at                   DateTime     @default(now()) @db.Timestamptz(6)
  updated_at                   DateTime     @default(now()) @db.Timestamptz(6)
  crm_quotes                   crm_quotes   @relation(fields: [quote_id], references: [id], onDelete: Cascade, map: "crm_quote_approvals_quote_id_fkey")
  bil_offer_rules              bil_offer_rules? @relation(fields: [offer_rule_id], references: [id], map: "crm_quote_approvals_offer_rule_id_fkey")
  bil_addons                   bil_addons?  @relation(fields: [requested_free_addon_id], references: [id], map: "crm_quote_approvals_requested_free_addon_id_fkey")

  @@index([quote_id], map: "idx_crm_quote_approvals_quote")
  @@index([status], map: "idx_crm_quote_approvals_status")
  @@index([approval_role, status], map: "idx_crm_quote_approvals_role")
  @@index([requested_by], map: "idx_crm_quote_approvals_requested_by")
  @@index([expires_at], map: "idx_crm_quote_approvals_expires")
}

/// Quote-to-Cash: crm_orders
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model crm_orders {
  id                       String                    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  lead_id                  String                    @db.Uuid
  contract_date            DateTime                  @db.Date
  effective_date           DateTime                  @db.Date
  expiry_date              DateTime?                 @db.Date
  total_value              Decimal                   @db.Decimal(18, 2)
  currency                 String                    @db.VarChar(3)
  status                   String                    @default("active")
  metadata                 Json                      @default("{}")
  created_at               DateTime                  @default(now()) @db.Timestamptz(6)
  created_by               String?                   @db.Uuid
  updated_at               DateTime                  @default(now()) @db.Timestamptz(6)
  updated_by               String?                   @db.Uuid
  deleted_at               DateTime?                 @db.Timestamptz(6)
  deleted_by               String?                   @db.Uuid
  deletion_reason          String?
  opportunity_id           String?                   @db.Uuid
  signature_date           DateTime?                 @db.Date
  vat_rate                 Decimal?                  @db.Decimal(5, 2)
  renewal_type             renewal_type?
  auto_renew               Boolean?                  @default(false)
  renewal_date             DateTime?                 @db.Date
  notice_period_days       Int?
  renewed_from_contract_id String?                   @db.Uuid
  provider_id              String                    @db.Uuid
  plan_id                  String?                   @db.Uuid
  subscription_id          String?                   @db.Uuid
  company_name             String?
  contact_name             String?
  contact_email            String?                   @db.Citext
  contact_phone            String?                   @db.VarChar(50)
  billing_address_id       String?                   @db.Uuid
  version_number           Int?                      @default(1)
  document_url             String?
  notes                    String?
  approved_by              String?                   @db.Uuid
  quote_id                 String?                   @db.Uuid
  order_type               order_type?               @default(new)
  fulfillment_status       order_fulfillment_status? @default(pending)
  order_reference          String?                   @unique @db.VarChar(50)
  order_code               String?                   @db.VarChar(30)
  billing_cycle            billing_interval?         @default(month)
  monthly_value            Decimal?                  @db.Decimal(15, 2)
  annual_value             Decimal?                  @db.Decimal(15, 2)
  fulfilled_at             DateTime?                 @db.Timestamptz(6)
  activated_at             DateTime?                 @db.Timestamptz(6)
  cancelled_at             DateTime?                 @db.Timestamptz(6)
  cancellation_reason      String?
  client_tenant_id         String?                   @db.Uuid
  crm_agreements           crm_agreements[]
  crm_quotes_from_order    crm_quotes[]              @relation("crm_quotes_converted_order")
  crm_quotes_quote         crm_quotes?               @relation("crm_orders_quote", fields: [quote_id], references: [id], onDelete: SetNull, map: "crm_orders_quote_id_fkey")
  crm_opportunities        crm_opportunities?        @relation("crm_orders_opportunity", fields: [opportunity_id], references: [id], onDelete: SetNull, map: "crm_orders_opportunity_id_fkey")
  clt_members_created_by   clt_members?              @relation("M_b83s6b", fields: [created_by], references: [id], onUpdate: Cascade, onDelete: SetNull, map: "crm_orders_created_by_fkey")
  clt_members_deleted_by   clt_members?              @relation("M_tt34oc", fields: [deleted_by], references: [id], onUpdate: Cascade, onDelete: SetNull, map: "crm_orders_deleted_by_fkey")
  clt_members_updated_by   clt_members?              @relation("M_ji7x2u", fields: [updated_by], references: [id], onUpdate: Cascade, onDelete: SetNull, map: "crm_orders_updated_by_fkey")
  adm_provider_employees_approved_by adm_provider_employees? @relation("E_gbcmr", fields: [approved_by], references: [id], onDelete: SetNull, map: "fk_crm_orders_approved_by")
  crm_addresses            crm_addresses?            @relation("crm_orders_billing_address", fields: [billing_address_id], references: [id], onDelete: SetNull, map: "fk_crm_orders_billing_address")
  adm_provider_employees_created_by adm_provider_employees? @relation("E_zbcklq", fields: [created_by], references: [id], onDelete: SetNull, map: "fk_crm_orders_created_by")
  adm_provider_employees_deleted_by adm_provider_employees? @relation("E_s4w7lp", fields: [deleted_by], references: [id], onDelete: SetNull, map: "fk_crm_orders_deleted_by")
  crm_leads                crm_leads                 @relation(fields: [lead_id], references: [id], onUpdate: Cascade, onDelete: SetNull, map: "fk_crm_orders_lead")
  bil_billing_plans        bil_billing_plans?        @relation(fields: [plan_id], references: [id], onDelete: SetNull, map: "fk_crm_orders_plan")
  adm_providers            adm_providers             @relation("crm_orders_provider", fields: [provider_id], references: [id], map: "fk_crm_orders_provider")
  renewed_from_order       crm_orders?               @relation("crm_orders_renewed_from", fields: [renewed_from_contract_id], references: [id], onDelete: SetNull, map: "fk_crm_orders_renewed_from")
  renewed_orders           crm_orders[]              @relation("crm_orders_renewed_from")
  clt_subscriptions clt_subscriptions? @relation(fields: [subscription_id], references: [id], onDelete: SetNull, map: "fk_crm_orders_subscription")
  adm_provider_employees_updated_by adm_provider_employees? @relation("E_jvkn17", fields: [updated_by], references: [id], onDelete: SetNull, map: "fk_crm_orders_updated_by")
  adm_tenants              adm_tenants?              @relation(fields: [client_tenant_id], references: [id], map: "fk_crm_orders_client_tenant")
  bil_subscription_schedules bil_subscription_schedules[]

  @@index([lead_id], map: "crm_orders_lead_id_idx")
  @@index([contract_date], map: "crm_orders_contract_date_idx")
  @@index([created_by], map: "crm_orders_created_by_idx")
  @@index([deleted_at], map: "crm_orders_deleted_at_idx")
  @@index([effective_date], map: "crm_orders_effective_date_idx")
  @@index([expiry_date], map: "crm_orders_expiry_date_idx")
  @@index([metadata], type: Gin, map: "crm_orders_metadata_idx")
  @@index([updated_by], map: "crm_orders_updated_by_idx")
  @@index([opportunity_id], map: "idx_crm_orders_opportunity_id")
  @@index([provider_id], map: "idx_crm_orders_provider_id")
  @@index([fulfillment_status], map: "idx_crm_orders_fulfillment_status")
  @@index([order_type], map: "idx_crm_orders_order_type")
  @@index([quote_id], map: "idx_crm_orders_quote_id")
  @@index([subscription_id], map: "idx_crm_orders_subscription_id")
  @@index([billing_address_id], map: "idx_crm_orders_billing_address_id")
  @@index([client_tenant_id], map: "idx_crm_orders_client_tenant_id")
}

/// Quote-to-Cash: crm_agreements
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model crm_agreements {
  id                       String                  @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  agreement_reference      String                  @unique @db.VarChar(50)
  order_id                 String                  @db.Uuid
  agreement_type           agreement_type
  version_number           Int                     @default(1)
  parent_agreement_id      String?                 @db.Uuid
  status                   agreement_status        @default(draft)
  effective_date           DateTime?               @db.Date
  expiry_date              DateTime?               @db.Date
  signature_method         signature_method        @default(electronic)
  signature_provider       String?                 @db.VarChar(50)
  provider_envelope_id     String?
  provider_envelope_url    String?
  client_signatory_name    String?                 @db.VarChar(200)
  client_signatory_email   String?                 @db.VarChar(255)
  client_signatory_title   String?                 @db.VarChar(100)
  client_signed_at         DateTime?               @db.Timestamptz(6)
  client_signature_ip      String?                 @db.Inet
  provider_signatory_id    String?                 @db.Uuid
  provider_signatory_name  String?                 @db.VarChar(200)
  provider_signatory_title String?                 @db.VarChar(100)
  provider_signed_at       DateTime?               @db.Timestamptz(6)
  document_url             String?
  signed_document_url      String?
  terms_version            String?                 @db.VarChar(20)
  governing_law            String?                 @db.VarChar(100)
  jurisdiction             String?                 @db.VarChar(200)
  custom_clauses           Json?                   @default("[]")
  internal_notes           String?
  metadata                 Json                    @default("{}")
  created_by               String                  @db.Uuid
  updated_by               String?                 @db.Uuid
  deleted_by               String?                 @db.Uuid
  deletion_reason          String?
  created_at               DateTime                @default(now()) @db.Timestamptz(6)
  updated_at               DateTime                @default(now()) @db.Timestamptz(6)
  deleted_at               DateTime?               @db.Timestamptz(6)
  provider_id              String?                 @db.Uuid
  sent_for_signature_at    DateTime?               @db.Timestamptz(6)
  crm_orders               crm_orders              @relation(fields: [order_id], references: [id], onDelete: Cascade, map: "crm_agreements_order_id_fkey")
  parent_agreement         crm_agreements?         @relation("crm_agreements_parent", fields: [parent_agreement_id], references: [id], onDelete: SetNull, map: "fk_crm_agreements_parent")
  child_agreements         crm_agreements[]        @relation("crm_agreements_parent")
  adm_providers            adm_providers?          @relation("crm_agreements_provider", fields: [provider_id], references: [id], map: "fk_crm_agreements_provider")
  adm_provider_employees   adm_provider_employees? @relation(fields: [provider_signatory_id], references: [id], onDelete: SetNull, map: "fk_crm_agreements_signatory")

  @@index([order_id], map: "idx_crm_agreements_order_id")
  @@index([status], map: "idx_crm_agreements_status")
  @@index([agreement_type], map: "idx_crm_agreements_agreement_type")
  @@index([effective_date], map: "idx_crm_agreements_effective_date")
  @@index([expiry_date], map: "idx_crm_agreements_expiry_date")
  @@index([provider_id], map: "idx_crm_agreements_provider_id")
  @@index([provider_envelope_id], map: "idx_crm_agreements_provider_envelope_id")
}

/// DEPRECATED: crm_contracts - this table no longer exists in DB, replaced by crm_orders
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model crm_contracts {
  id                                                                       String                    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  lead_id                                                                  String                    @db.Uuid
  contract_reference                                                       String
  contract_date                                                            DateTime                  @db.Date
  effective_date                                                           DateTime                  @db.Date
  expiry_date                                                              DateTime?                 @db.Date
  total_value                                                              Decimal                   @db.Decimal(18, 2)
  currency                                                                 String                    @db.VarChar(3)
  status                                                                   String                    @default("active")
  metadata                                                                 Json                      @default("{}")
  created_at                                                               DateTime                  @default(now()) @db.Timestamptz(6)
  created_by                                                               String?                   @db.Uuid
  updated_at                                                               DateTime                  @default(now()) @db.Timestamptz(6)
  updated_by                                                               String?                   @db.Uuid
  deleted_at                                                               DateTime?                 @db.Timestamptz(6)
  deleted_by                                                               String?                   @db.Uuid
  deletion_reason                                                          String?
  opportunity_id                                                           String?                   @db.Uuid
  contract_code                                                            String?                   @unique
  signature_date                                                           DateTime?                 @db.Date
  expiration_date                                                          DateTime?                 @db.Date
  vat_rate                                                                 Decimal?                  @db.Decimal(5, 2)
  renewal_type                                                             renewal_type?
  auto_renew                                                               Boolean?                  @default(false)
  renewal_date                                                             DateTime?                 @db.Date
  notice_period_days                                                       Int?
  renewed_from_contract_id                                                 String?                   @db.Uuid
  tenant_id                                                                String                    @db.Uuid
  plan_id                                                                  String?                   @db.Uuid
  subscription_id                                                          String?                   @db.Uuid
  company_name                                                             String?
  contact_name                                                             String?
  contact_email                                                            String?                   @db.Citext
  contact_phone                                                            String?                   @db.VarChar(50)
  billing_address_id                                                       String?                   @db.Uuid
  version_number                                                           Int?                      @default(1)
  document_url                                                             String?
  notes                                                                    String?
  approved_by                                                              String?                   @db.Uuid
  mbnoypv                        clt_members?              @relation("M_2ejw59", fields: [created_by], references: [id])
  mtdhy4s                        clt_members?              @relation("M_weh19q", fields: [deleted_by], references: [id])
  xk2h2yo        crm_opportunities?        @relation("X_3eys29", fields: [opportunity_id], references: [id], onUpdate: NoAction)
  mjxt3me                        clt_members?              @relation("M_aoo11s", fields: [updated_by], references: [id])
  el3qno4 adm_provider_employees?   @relation("E_8gunbt", fields: [approved_by], references: [id], onUpdate: NoAction, map: "fk_crm_contracts_approved_by")
  crm_addresses                                                            crm_addresses?            @relation(fields: [billing_address_id], references: [id], onUpdate: NoAction, map: "fk_crm_contracts_billing_address")
  eeecazd  adm_provider_employees?   @relation("E_lb473o", fields: [created_by], references: [id], onUpdate: NoAction, map: "fk_crm_contracts_created_by")
  elksnze  adm_provider_employees?   @relation("E_e4nu3n", fields: [deleted_by], references: [id], onUpdate: NoAction, map: "fk_crm_contracts_deleted_by")
  crm_leads                                                                crm_leads                 @relation(fields: [lead_id], references: [id], onDelete: SetNull, map: "fk_crm_contracts_lead")
  bil_billing_plans                                                        bil_billing_plans?        @relation(fields: [plan_id], references: [id], onUpdate: NoAction, map: "fk_crm_contracts_plan")
  crm_contracts                                                            crm_contracts?            @relation("crm_contractsTocrm_contracts", fields: [renewed_from_contract_id], references: [id], onUpdate: NoAction, map: "fk_crm_contracts_renewed_from")
  other_crm_contracts                                                      crm_contracts[]           @relation("crm_contractsTocrm_contracts")
  clt_subscriptions                                                 clt_subscriptions? @relation(fields: [subscription_id], references: [id], onUpdate: NoAction, map: "fk_crm_contracts_subscription")
  adm_tenants                                                              adm_tenants               @relation(fields: [tenant_id], references: [id], onDelete: SetNull, onUpdate: NoAction, map: "fk_crm_contracts_tenant")
  etu48jw  adm_provider_employees?   @relation("E_5vc9j5", fields: [updated_by], references: [id], onUpdate: NoAction, map: "fk_crm_contracts_updated_by")
  xko9dx7           crm_opportunities[]       @relation("X_5vsr2s")

  @@index([lead_id], map: "crm_contracts_client_id_idx")
  @@index([contract_date])
  @@index([created_by])
  @@index([deleted_at])
  @@index([effective_date])
  @@index([expiry_date])
  @@index([metadata], type: Gin)
  @@index([updated_by])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model crm_countries {
  id                     String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  country_code           String         @unique @db.Char(2)
  country_name_en        String         @db.VarChar(100)
  country_name_fr        String         @db.VarChar(100)
  country_name_ar        String         @db.VarChar(100)
  flag_emoji             String         @db.VarChar(10)
  is_operational         Boolean        @default(false)
  is_visible             Boolean        @default(true)
  display_order          Int
  notification_locale    String         @default("en") @db.VarChar(5)
  created_at             DateTime       @default(now()) @db.Timestamptz(6)
  updated_at             DateTime       @default(now()) @db.Timestamptz(6)
  country_preposition_fr String?        @default("en") @db.VarChar(5)
  country_preposition_en String?        @default("in") @db.VarChar(10)
  country_gdpr           Boolean        @default(false)
  phone_prefix           String?        @db.VarChar(10)
  phone_example          String?        @db.VarChar(20)
  phone_min_digits       Int?           @default(8)
  phone_max_digits       Int?           @default(12)
  is_system              Boolean        @default(false)
  provider_id            String?        @db.Uuid
  crm_leads              crm_leads[]
  crm_waitlist           crm_waitlist[]
  adm_providers          adm_providers? @relation("crm_countries_provider", fields: [provider_id], references: [id], onDelete: SetNull, map: "fk_crm_countries_provider")

  @@index([country_code], map: "idx_crm_countries_code")
  @@index([country_gdpr], map: "idx_crm_countries_gdpr")
  @@index([is_operational], map: "idx_crm_countries_operational")
  @@index([is_visible], map: "idx_crm_countries_visible")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model crm_lead_activities {
  id                String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  lead_id           String    @db.Uuid
  activity_type     String    @db.VarChar(50)
  title             String?   @db.VarChar(255)
  description       String?
  metadata          Json?     @default("{}")
  scheduled_at      DateTime? @db.Timestamptz(6)
  completed_at      DateTime? @db.Timestamptz(6)
  is_completed      Boolean?  @default(false)
  performed_by      String?   @db.Uuid
  performed_by_name String?   @db.VarChar(255)
  created_at        DateTime? @default(now()) @db.Timestamptz(6)
  updated_at        DateTime? @default(now()) @db.Timestamptz(6)
  provider_id       String?   @db.Uuid
  crm_leads         crm_leads @relation(fields: [lead_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([created_at(sort: Desc)], map: "idx_crm_lead_activities_created_at")
  @@index([lead_id], map: "idx_crm_lead_activities_lead_id")
  @@index([activity_type], map: "idx_crm_lead_activities_type")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model crm_lead_sources {
  id                       String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  is_active                Boolean        @default(true)
  created_at               DateTime       @default(now()) @db.Timestamptz(6)
  is_system                Boolean        @default(false)
  provider_id              String?        @db.Uuid
  name_translations        Json?
  description_translations Json?
  crm_leads                crm_leads[]
  adm_providers            adm_providers? @relation("crm_lead_sources_provider", fields: [provider_id], references: [id], onDelete: SetNull, map: "fk_crm_lead_sources_provider")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model crm_leads {
  id                                                                   String                  @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  email                                                                String
  phone                                                                String?
  source                                                               String?
  status                                                               String                  @default("new")
  message                                                              String?
  created_at                                                           DateTime                @default(now()) @db.Timestamptz(6)
  updated_at                                                           DateTime                @default(now()) @db.Timestamptz(6)
  country_code                                                         String?                 @db.Char(2)
  fleet_size                                                           String?                 @db.VarChar(50)
  current_software                                                     String?                 @db.VarChar(255)
  assigned_to                                                          String?                 @db.Uuid
  qualification_score                                                  Int?
  qualification_notes                                                  String?
  qualified_date                                                       DateTime?               @db.Timestamptz(6)
  converted_date                                                       DateTime?               @db.Timestamptz(6)
  utm_source                                                           String?                 @db.VarChar(255)
  utm_medium                                                           String?                 @db.VarChar(255)
  utm_campaign                                                         String?                 @db.VarChar(255)
  metadata                                                             Json?                   @default("{}")
  created_by                                                           String?                 @db.Uuid
  updated_by                                                           String?                 @db.Uuid
  deleted_at                                                           DateTime?               @db.Timestamptz(6)
  deleted_by                                                           String?                 @db.Uuid
  deletion_reason                                                      String?
  lead_code                                                            String?                 @unique @db.VarChar(50)
  first_name                                                           String?
  last_name                                                            String?
  company_name                                                         String?
  industry                                                             String?
  company_size                                                         Int?
  website_url                                                          String?
  linkedin_url                                                         String?
  city                                                                 String?
  lead_stage                                                           lead_stage?
  fit_score                                                            Decimal?                @db.Decimal(5, 2)
  engagement_score                                                     Decimal?                @db.Decimal(5, 2)
  scoring                                                              Json?
  gdpr_consent                                                         Boolean?
  consent_at                                                           DateTime?               @db.Timestamptz(6)
  source_id                                                            String?                 @db.Uuid
  opportunity_id                                                       String?                 @db.Uuid
  next_action_date                                                     DateTime?               @db.Timestamptz(6)
  priority                                                             String?                 @default("medium") @db.VarChar(20)
  consent_ip                                                           String?                 @db.VarChar(45)
  last_activity_at                                                     DateTime?               @db.Timestamptz(6)
  provider_id                                                          String?                 @db.Uuid
  // V5: Colonnes CLOSING (kept: used in status workflow)
  stage_entered_at                                                     DateTime?               @default(now()) @db.Timestamptz(6)
  loss_reason_code                                                     String?                 @db.VarChar(50)
  loss_reason_detail                                                   String?
  competitor_name                                                      String?                 @db.VarChar(100)
  // V6.2: Colonnes BOOKING CAL.COM
  booking_slot_at                                                      DateTime?               @db.Timestamptz(6)
  booking_confirmed_at                                                 DateTime?               @db.Timestamptz(6)
  booking_calcom_uid                                                   String?                 @db.VarChar(100)
  platforms_used                                                       String[]
  // V6.2: Colonne WIZARD
  wizard_completed                                                     Boolean?                @default(false)
  // V6.2: Colonnes CONVERSION
  tenant_id                                                            String?                 @db.Uuid
  converted_at                                                         DateTime?               @db.Timestamptz(6)
  // V6.2.1: Colonnes STRIPE PAYMENT LINK
  stripe_checkout_session_id                                           String?                 @db.VarChar(255)
  stripe_payment_link_url                                              String?
  payment_link_created_at                                              DateTime?               @db.Timestamptz(6)
  payment_link_expires_at                                              DateTime?               @db.Timestamptz(6)
  // V6.2.2: Colonnes EMAIL VERIFICATION (Book Demo Wizard)
  email_verified                                                       Boolean                 @default(false)
  email_verification_code                                              String?                 @db.VarChar(255)
  email_verification_expires_at                                        DateTime?               @db.Timestamptz(6)
  email_verification_attempts                                          Int                     @default(0)
  // V6.2.6: Colonnes ATTENDANCE CONFIRMATION (J-1 Email Reminder)
  confirmation_token                                                   String?                 @db.VarChar(255)
  attendance_confirmed                                                 Boolean                 @default(false)
  attendance_confirmed_at                                              DateTime?               @db.Timestamptz(6)
  j1_reminder_sent_at                                                  DateTime?               @db.Timestamptz(6)
  // V6.3.3: Short token for iOS Mail compatible reschedule links
  reschedule_token                                                     String?                 @unique @db.VarChar(8)
  // V6.4: GeoIP detection (same pattern as crm_waitlist for spam detection)
  detected_country_code                                                String?                 @db.VarChar(2)
  ip_address                                                           String?                 @db.VarChar(45)
  // Relations
  crm_activities                                                       crm_activities[]
  crm_contracts                                                        crm_contracts[]
  crm_lead_activities                                                  crm_lead_activities[]
  eu1f9qh adm_provider_employees? @relation("E_q6cosq", fields: [assigned_to], references: [id], onUpdate: NoAction, map: "fk_crm_leads_assigned_to")
  adm_providers                                                        adm_providers?          @relation("crm_leads_provider", fields: [provider_id], references: [id], map: "fk_crm_leads_provider")
  crm_countries                                                        crm_countries?          @relation(fields: [country_code], references: [country_code], onDelete: Restrict, map: "fk_crm_leads_country")
  ewrnqup  adm_provider_employees? @relation("E_y5okea", fields: [created_by], references: [id], onUpdate: NoAction, map: "fk_crm_leads_created_by")
  epl7duo  adm_provider_employees? @relation("E_toz4kt", fields: [deleted_by], references: [id], onUpdate: NoAction, map: "fk_crm_leads_deleted_by")
  xylqz06        crm_opportunities?      @relation("X_wp88t7", fields: [opportunity_id], references: [id], onUpdate: NoAction, map: "fk_crm_leads_opportunity")
  crm_lead_sources                                                     crm_lead_sources?       @relation(fields: [source_id], references: [id], onUpdate: NoAction, map: "fk_crm_leads_source")
  ehbvta6  adm_provider_employees? @relation("E_lfnk0b", fields: [updated_by], references: [id], onUpdate: NoAction, map: "fk_crm_leads_updated_by")
  xdu9nqz               crm_opportunities[]     @relation("X_giac7o")
  // Quote-to-Cash relations
  crm_orders                                                           crm_orders[]
  // V5: Relation inverse Lead  Quotes (direct, sans Opportunity)
  crm_quotes_from_lead                                                 crm_quotes[]            @relation("crm_quotes_lead")
  // V6.2: Relation Lead  Tenant (aprs conversion)
  adm_tenants                                                          adm_tenants?            @relation("crm_leads_tenant", fields: [tenant_id], references: [id], onUpdate: NoAction, map: "fk_crm_leads_tenant")
  // V6.2-3: Relation inverse Lead  clt_masterdata (origine)
  clt_masterdata                                                       clt_masterdata[]

  @@index([created_at(sort: Desc)])
  @@index([deleted_at])
  @@index([status])
  @@index([assigned_to], map: "idx_crm_leads_assigned_to")
  @@index([country_code], map: "idx_crm_leads_country_code")
  @@index([lead_stage], map: "idx_crm_leads_lead_stage")
  @@index([metadata], map: "idx_crm_leads_metadata", type: Gin)
  @@index([qualification_score], map: "idx_crm_leads_qualification_score")
  @@index([deleted_at, status, lead_stage], map: "idx_crm_leads_status_stage_deleted")
  @@index([updated_at], map: "idx_crm_leads_updated_at")
  @@index([last_activity_at], map: "idx_crm_leads_last_activity_at")
  // V5: Index closing (kept columns only)
  @@index([stage_entered_at(sort: Desc)], map: "idx_crm_leads_stage_entered")
  @@index([loss_reason_code], map: "idx_crm_leads_loss_reason")
  // V6.2: Index booking/wizard/tenant
  @@index([booking_slot_at], map: "idx_crm_leads_booking_slot")
  @@index([booking_calcom_uid], map: "idx_crm_leads_booking_calcom_uid")
  @@index([wizard_completed], map: "idx_crm_leads_wizard_completed")
  @@index([tenant_id], map: "idx_crm_leads_tenant")
  // V6.2.2: Index email verification
  @@index([email, email_verified], map: "idx_crm_leads_email_verification")
  // V6.3.3: Index reschedule token for short URL lookups
  @@index([reschedule_token], map: "idx_crm_leads_reschedule_token")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model crm_opportunities {
  id                                                                           String                        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  lead_id                                                                      String                        @db.Uuid
  stage                                                                        String                        @default("prospect")
  expected_value                                                               Decimal?                      @db.Decimal(18, 2)
  close_date                                                                   DateTime?                     @db.Date
  assigned_to                                                                  String?                       @db.Uuid
  metadata                                                                     Json                          @default("{}")
  created_at                                                                   DateTime                      @default(now()) @db.Timestamptz(6)
  created_by                                                                   String?                       @db.Uuid
  updated_at                                                                   DateTime                      @default(now()) @db.Timestamptz(6)
  updated_by                                                                   String?                       @db.Uuid
  deleted_at                                                                   DateTime?                     @db.Timestamptz(6)
  deleted_by                                                                   String?                       @db.Uuid
  deletion_reason                                                              String?
  probability                                                                  Int?
  status                                                                       opportunity_status            @default(open)
  currency                                                                     String?                       @default("EUR") @db.Char(3)
  discount_amount                                                              Decimal?                      @db.Decimal(15, 2)
  probability_percent                                                          Decimal?                      @default(0) @db.Decimal(5, 2)
  forecast_value                                                               Decimal?                      @db.Decimal(15, 2)
  won_value                                                                    Decimal?                      @db.Decimal(15, 2)
  expected_close_date                                                          DateTime?                     @db.Date
  won_date                                                                     DateTime?                     @db.Date
  lost_date                                                                    DateTime?                     @db.Date
  owner_id                                                                     String?                       @db.Uuid
  loss_reason                                                                  String?                       @db.VarChar(50)
  plan_id                                                                      String?                       @db.Uuid
  contract_id                                                                  String?                       @db.Uuid
  pipeline_id                                                                  String?                       @db.Uuid
  notes                                                                        String?
  stage_entered_at                                                             DateTime                      @default(now()) @db.Timestamptz(6)
  max_days_in_stage                                                            Int?                          @default(14)
  provider_id                                                                  String?                       @db.Uuid
  crm_activities                                                               crm_activities[]
  x5nbuj4                crm_contracts[]               @relation("X_3eys29")
  adm_providers                                                                adm_providers?                @relation("crm_opportunities_provider", fields: [provider_id], references: [id], map: "fk_crm_opportunities_provider")
  xqh1y8s                        crm_leads[]                   @relation("X_wp88t7")
  mfiaerr                       clt_members?                  @relation("M_ibz5tf", fields: [assigned_to], references: [id])
  msnr7al                        clt_members?                  @relation("M_ds7hn1", fields: [created_by], references: [id])
  m1c5xtw                        clt_members?                  @relation("M_r8zf7m", fields: [deleted_by], references: [id])
  xva1wvf                               crm_leads                     @relation("X_giac7o", fields: [lead_id], references: [id], onDelete: Cascade)
  mkdn2e2                        clt_members?                  @relation("M_m2bmjk", fields: [updated_by], references: [id])
  esbu38v adm_provider_employees?       @relation("E_2fdy1w", fields: [assigned_to], references: [id], onUpdate: NoAction, map: "fk_crm_opportunities_assigned_to")
  xpgrakr                   crm_contracts?                @relation("X_5vsr2s", fields: [contract_id], references: [id], onUpdate: NoAction, map: "fk_crm_opportunities_contract")
  eqtkd3  adm_provider_employees?       @relation("E_hry82s", fields: [created_by], references: [id], onUpdate: NoAction, map: "fk_crm_opportunities_created_by")
  e6fmsmy  adm_provider_employees?       @relation("E_alhv2r", fields: [deleted_by], references: [id], onUpdate: NoAction, map: "fk_crm_opportunities_deleted_by")
  e4efrw0    adm_provider_employees?       @relation("E_b2k0n1", fields: [owner_id], references: [id], onUpdate: NoAction, map: "fk_crm_opportunities_owner")
  crm_pipelines                                                                crm_pipelines?                @relation(fields: [pipeline_id], references: [id], onUpdate: NoAction, map: "fk_crm_opportunities_pipeline")
  bil_billing_plans                                                            bil_billing_plans?            @relation(fields: [plan_id], references: [id], onUpdate: NoAction, map: "fk_crm_opportunities_plan")
  eeoyd7g  adm_provider_employees?       @relation("E_2c6ai9", fields: [updated_by], references: [id], onUpdate: NoAction, map: "fk_crm_opportunities_updated_by")
  // Quote-to-Cash relations
  crm_orders                                                                   crm_orders[]                  @relation("crm_orders_opportunity")

  @@index([assigned_to])
  @@index([close_date])
  @@index([created_by])
  @@index([deleted_at])
  @@index([lead_id])
  @@index([metadata], type: Gin)
  @@index([updated_by])
  @@index([provider_id], map: "idx_crm_opportunities_provider_id")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model crm_pipelines {
  id                       String              @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  stages                   Json
  default_probability      Json?
  is_default               Boolean             @default(false)
  is_active                Boolean             @default(true)
  created_at               DateTime            @default(now()) @db.Timestamptz(6)
  provider_id              String?             @db.Uuid
  name_translations        Json?
  description_translations Json?
  crm_opportunities        crm_opportunities[]
  adm_providers            adm_providers?      @relation("crm_pipelines_provider", fields: [provider_id], references: [id], map: "fk_crm_pipelines_provider")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model crm_settings {
  id                                                                     String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  setting_key                                                            String                  @unique @db.VarChar(100)
  setting_value                                                          Json
  description                                                            String?
  category                                                               String                  @db.VarChar(50)
  data_type                                                              String                  @db.VarChar(20)
  is_active                                                              Boolean                 @default(true)
  is_system                                                              Boolean                 @default(false)
  version                                                                Int                     @default(1)
  schema_version                                                         String?                 @db.VarChar(20)
  created_at                                                             DateTime                @default(now()) @db.Timestamptz(6)
  updated_at                                                             DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                                             String?                 @db.Uuid
  updated_by                                                             String?                 @db.Uuid
  deleted_at                                                             DateTime?               @db.Timestamptz(6)
  deleted_by                                                             String?                 @db.Uuid
  deletion_reason                                                        String?
  display_label                                                          String?                 @db.VarChar(100)
  display_order                                                          Int?                    @default(0)
  ui_component                                                           String?                 @db.VarChar(50)
  help_text                                                              String?
  documentation_url                                                      String?                 @db.VarChar(255)
  default_value                                                          Json?
  provider_id                                                            String?                 @db.Uuid
  e9a665 adm_provider_employees? @relation("E_uo2qnk", fields: [created_by], references: [id])
  e6x66tw adm_provider_employees? @relation("E_x6kybj", fields: [deleted_by], references: [id])
  ef6hree adm_provider_employees? @relation("E_ox9dr1", fields: [updated_by], references: [id])
  adm_providers                                                          adm_providers?          @relation("crm_settings_provider", fields: [provider_id], references: [id], onDelete: SetNull, map: "fk_crm_settings_provider")

  @@index([created_by], map: "idx_crm_settings_created_by")
  @@index([deleted_at], map: "idx_crm_settings_deleted")
  @@index([updated_by], map: "idx_crm_settings_updated_by")
  @@index([setting_value], map: "idx_crm_settings_value", type: Gin)
}

/// V6.2.3: Waitlist pour leads de pays non-oprationnels
/// V6.3: fleet_size now optional - collected via email survey
model crm_waitlist {
  id                     String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  short_token            String?   @unique @db.VarChar(8)

  // Contact
  email                  String    @db.VarChar(255)
  country_code           String    @db.VarChar(2)
  fleet_size             String?   @db.VarChar(20)

  // Dtection GeoIP
  detected_country_code  String?   @db.VarChar(2)
  ip_address             String?   @db.VarChar(45)

  // Consent GDPR
  marketing_consent      Boolean   @default(true)
  gdpr_consent           Boolean?
  gdpr_consent_at        DateTime? @db.Timestamptz(6)
  gdpr_consent_ip        String?   @db.VarChar(45)

  // Anti-spam
  honeypot_triggered     Boolean   @default(false)

  // Tracking
  source                 String    @default("wizard") @db.VarChar(50)
  locale                 String    @default("en") @db.VarChar(5)
  utm_source             String?   @db.VarChar(100)
  utm_medium             String?   @db.VarChar(100)
  utm_campaign           String?   @db.VarChar(100)

  // Timestamps
  created_at             DateTime  @default(now()) @db.Timestamptz(6)
  notified_at            DateTime? @db.Timestamptz(6)

  // Relations
  crm_countries          crm_countries @relation(fields: [country_code], references: [country_code])

  @@unique([email, country_code], map: "crm_waitlist_email_country_unique")
  @@index([country_code], map: "idx_crm_waitlist_country")
  @@index([fleet_size], map: "idx_crm_waitlist_fleet")
  @@index([created_at], map: "idx_crm_waitlist_created")
  @@index([email], map: "idx_crm_waitlist_email")
  @@index([short_token], map: "idx_crm_waitlist_short_token")
}

/// V6.2.1: Billing settings - same structure as crm_settings
model bil_settings {
  id             String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  setting_key    String    @db.VarChar(100)
  setting_value  Json
  category       String    @db.VarChar(50)
  data_type      String    @default("object") @db.VarChar(20)
  display_label  String?   @db.VarChar(100)
  schema_version String?   @default("1.0") @db.VarChar(10)
  is_system      Boolean   @default(false)
  is_active      Boolean   @default(true)
  description    String?
  provider_id    String?   @db.Uuid
  created_at     DateTime  @default(now()) @db.Timestamptz(6)
  updated_at     DateTime  @default(now()) @db.Timestamptz(6)
  // Relations
  adm_providers  adm_providers? @relation("bil_settings_provider", fields: [provider_id], references: [id], onDelete: SetNull)

  @@unique([setting_key, provider_id], map: "bil_settings_key_provider_unique")
  @@index([setting_key], map: "idx_bil_settings_key")
  @@index([provider_id], map: "idx_bil_settings_provider")
  @@index([category], map: "idx_bil_settings_category")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model dir_car_makes {
  id                                                                      String                  @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                               String                  @db.Uuid
  name                                                                    String
  created_at                                                              DateTime                @default(now()) @db.Timestamptz(6)
  updated_at                                                              DateTime                @default(now()) @db.Timestamptz(6)
  code                                                                    String                  @unique(map: "idx_dir_car_makes_code") @db.VarChar(50)
  country_of_origin                                                       String?                 @db.Char(2)
  parent_company                                                          String?                 @db.VarChar(100)
  founded_year                                                            Int?
  logo_url                                                                String?
  status                                                                  lifecycle_status        @default(active)
  metadata                                                                Json?
  created_by                                                              String?                 @db.Uuid
  updated_by                                                              String?                 @db.Uuid
  deleted_at                                                              DateTime?               @db.Timestamptz(6)
  deleted_by                                                              String?                 @db.Uuid
  deletion_reason                                                         String?
  adm_tenants                                                             adm_tenants             @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  ei1lgjl adm_provider_employees? @relation("E_hnv1jg", fields: [created_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_car_makes_created_by")
  ep81tjm adm_provider_employees? @relation("E_aheojf", fields: [deleted_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_car_makes_deleted_by")
  exhde44 adm_provider_employees? @relation("E_2833yx", fields: [updated_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_car_makes_updated_by")
  dir_car_models                                                          dir_car_models[]
  flt_vehicles                                                            flt_vehicles[]

  @@index([created_at])
  @@index([tenant_id])
  @@index([updated_at])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model dir_car_models {
  id                                                                       String                  @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                String                  @db.Uuid
  make_id                                                                  String                  @db.Uuid
  name                                                                     String
  created_at                                                               DateTime                @default(now()) @db.Timestamptz(6)
  updated_at                                                               DateTime                @default(now()) @db.Timestamptz(6)
  vehicle_class_id                                                         String?                 @db.Uuid
  code                                                                     String                  @db.VarChar(50)
  year_start                                                               Int?
  year_end                                                                 Int?
  body_type                                                                String?                 @db.VarChar(50)
  fuel_type                                                                String?                 @db.VarChar(50)
  transmission                                                             String?                 @db.VarChar(50)
  seats_min                                                                Int?
  seats_max                                                                Int?
  length_mm                                                                Int?
  width_mm                                                                 Int?
  height_mm                                                                Int?
  metadata                                                                 Json?
  status                                                                   car_model_status        @default(active)
  created_by                                                               String?                 @db.Uuid
  updated_by                                                               String?                 @db.Uuid
  deleted_at                                                               DateTime?               @db.Timestamptz(6)
  deleted_by                                                               String?                 @db.Uuid
  deletion_reason                                                          String?
  dir_car_makes                                                            dir_car_makes           @relation(fields: [make_id], references: [id], onDelete: Cascade)
  adm_tenants                                                              adm_tenants             @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  dir_vehicle_classes                                                      dir_vehicle_classes?    @relation(fields: [vehicle_class_id], references: [id])
  exfex46 adm_provider_employees? @relation("E_813tv1", fields: [created_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_car_models_created_by")
  euf8rux adm_provider_employees? @relation("E_ungv0", fields: [deleted_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_car_models_deleted_by")
  em5x7af adm_provider_employees? @relation("E_7eo3pi", fields: [updated_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_car_models_updated_by")
  flt_vehicles                                                             flt_vehicles[]

  @@unique([tenant_id, make_id, name], map: "dir_car_models_tenant_make_name_uq")
  @@unique([make_id, code], map: "idx_dir_car_models_make_code")
  @@index([created_at])
  @@index([make_id])
  @@index([tenant_id])
  @@index([updated_at])
  @@index([vehicle_class_id])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model dir_country_locales {
  id                                                                            String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  country_code                                                                  String                  @unique @db.Char(2)
  country_name                                                                  String                  @db.VarChar(100)
  primary_locale                                                                String                  @db.VarChar(10)
  fallback_locale                                                               String?                 @db.VarChar(10)
  supported_locales                                                             String[]                @default([])
  timezone                                                                      String                  @db.VarChar(50)
  currency                                                                      String                  @db.Char(3)
  currency_symbol                                                               String?                 @db.VarChar(10)
  currency_position                                                             String?                 @db.VarChar(10)
  number_format                                                                 String                  @default("1,234.56") @db.VarChar(20)
  date_format                                                                   String                  @db.VarChar(20)
  time_format                                                                   String                  @db.VarChar(20)
  first_day_of_week                                                             Int                     @default(1) @db.SmallInt
  rtl_enabled                                                                   Boolean                 @default(false)
  status                                                                        lifecycle_status        @default(active)
  created_at                                                                    DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                                                    String?                 @db.Uuid
  updated_at                                                                    DateTime                @default(now()) @db.Timestamptz(6)
  updated_by                                                                    String?                 @db.Uuid
  deleted_at                                                                    DateTime?               @db.Timestamptz(6)
  deleted_by                                                                    String?                 @db.Uuid
  deletion_reason                                                               String?
  el1qe3t adm_provider_employees? @relation("E_jxx9ai", fields: [created_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_country_locales_created_by")
  edva13s adm_provider_employees? @relation("E_r4dmaj", fields: [deleted_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_country_locales_deleted_by")
  e5lygja adm_provider_employees? @relation("E_zdp6v1", fields: [updated_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_country_locales_updated_by")

  @@index([country_code], map: "idx_dir_country_locales_country")
  @@index([deleted_at], map: "idx_dir_country_locales_deleted_at")
  @@index([status], map: "idx_dir_country_locales_status")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model dir_country_regulations {
  country_code                                                                          String                  @id @db.Char(2)
  vehicle_max_age                                                                       Int?
  min_vehicle_class                                                                     String?
  min_fare_per_trip                                                                     Decimal?                @db.Decimal(10, 2)
  min_fare_per_km                                                                       Decimal?                @db.Decimal(10, 2)
  min_fare_per_hour                                                                     Decimal?                @db.Decimal(10, 2)
  vat_rate                                                                              Decimal?                @db.Decimal(5, 2)
  currency                                                                              String                  @db.Char(3)
  timezone                                                                              String
  created_at                                                                            DateTime                @default(now()) @db.Timestamptz(6)
  updated_at                                                                            DateTime                @default(now()) @db.Timestamptz(6)
  requires_vtc_card                                                                     Boolean                 @default(false)
  min_vehicle_class_id                                                                  String?                 @db.Uuid
  min_vehicle_length_cm                                                                 Int?
  min_vehicle_width_cm                                                                  Int?
  min_vehicle_height_cm                                                                 Int?
  max_vehicle_weight_kg                                                                 Int?
  max_vehicle_mileage_km                                                                Int?
  requires_professional_license                                                         Boolean?
  required_documents                                                                    Json?
  effective_date                                                                        DateTime?               @db.Date
  expiry_date                                                                           DateTime?               @db.Date
  status                                                                                regulation_status       @default(active)
  created_by                                                                            String?                 @db.Uuid
  updated_by                                                                            String?                 @db.Uuid
  deleted_at                                                                            DateTime?               @db.Timestamptz(6)
  deleted_by                                                                            String?                 @db.Uuid
  deletion_reason                                                                       String?
  epjaoqv     adm_provider_employees? @relation("E_jh0igq", fields: [created_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_country_regulations_created_by")
  ewpr1qw     adm_provider_employees? @relation("E_qngvgr", fields: [deleted_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_country_regulations_deleted_by")
  vcm93xdh dir_vehicle_classes?    @relation("X_r03s31", fields: [min_vehicle_class_id], references: [id], onUpdate: NoAction, map: "fk_dir_country_regulations_min_vehicle_class")
  eu21fnq     adm_provider_employees? @relation("E_ywsg19", fields: [updated_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_country_regulations_updated_by")
  dir_toll_gates                                                                        dir_toll_gates[]
  xshf03l         dir_vehicle_classes[]   @relation("X_gxp9b5")
  flt_vehicles                                                                          flt_vehicles[]

  @@index([currency])
  @@index([timezone])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model dir_fine_types {
  id                String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  jurisdiction      String              @db.Char(2)
  code              String              @db.VarChar(50)
  description       String
  min_amount        Decimal             @db.Decimal(14, 2)
  max_amount        Decimal             @db.Decimal(14, 2)
  points            Int?
  is_criminal       Boolean             @default(false)
  active            Boolean             @default(true)
  metadata              Json                @default("{}")
  created_at            DateTime            @default(now()) @db.Timestamptz(6)
  updated_at            DateTime            @default(now()) @db.Timestamptz(6)
  description_translations Json
  fin_traffic_fines     fin_traffic_fines[]

  @@unique([jurisdiction, code], map: "dir_fine_types_jurisdiction_code_uq")
}

model dir_maintenance_types {
  id                        String                      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                 String                      @db.Uuid
  code                      String                      @db.VarChar(50)
  label                     String                      @db.VarChar(255)
  category                  maintenance_category
  default_frequency_km      Int?
  default_frequency_months  Int?
  estimated_duration_hours  Decimal?                    @db.Decimal(5, 2)
  estimated_cost_range      Json?
  is_mandatory              Boolean?                    @default(false)
  requires_vehicle_stoppage Boolean?                    @default(true)
  description               String?
  metadata                  Json?
  created_at                DateTime                    @default(now()) @db.Timestamptz(6)
  updated_at                DateTime                    @default(now()) @db.Timestamptz(6)
  created_by                String                      @db.Uuid
  updated_by                String?                     @db.Uuid
  deleted_at                DateTime?                   @db.Timestamptz(6)
  deleted_by                String?                     @db.Uuid
  deletion_reason           String?
  label_translations        Json
  description_translations  Json?
  adm_tenants               adm_tenants                 @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_maintenance_types_tenant")
  sch_maintenance_schedules sch_maintenance_schedules[]

  @@index([category, is_mandatory], map: "idx_maintenance_types_category_mandatory")
  @@index([deleted_at], map: "idx_maintenance_types_deleted")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model dir_notification_templates {
  id                                                                                   String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  template_code                                                                        String                  @db.VarChar(100)
  template_name                                                                        String                  @db.VarChar(200)
  channel                                                                              notification_channel
  supported_countries                                                                  String[]                @default([])
  supported_locales                                                                    String[]                @default([])
  subject_translations                                                                 Json
  body_translations                                                                    Json
  variables                                                                            Json?
  status                                                                               lifecycle_status        @default(active)
  created_at                                                                           DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                                                           String?                 @db.Uuid
  updated_at                                                                           DateTime                @default(now()) @db.Timestamptz(6)
  updated_by                                                                           String?                 @db.Uuid
  deleted_at                                                                           DateTime?               @db.Timestamptz(6)
  deleted_by                                                                           String?                 @db.Uuid
  deletion_reason                                                                      String?
  em24r4m adm_provider_employees? @relation("E_ipw24j", fields: [created_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_notification_templates_created_by")
  et8l44n adm_provider_employees? @relation("E_pwcf4k", fields: [deleted_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_notification_templates_deleted_by")
  exj7d9z adm_provider_employees? @relation("E_y5nzp2", fields: [updated_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_notification_templates_updated_by")

  @@unique([template_code, channel], map: "uq_dir_notification_templates_code_channel")
  @@index([channel], map: "idx_dir_notification_templates_channel")
  @@index([template_code], map: "idx_dir_notification_templates_code")
  @@index([supported_countries], map: "idx_dir_notification_templates_countries_gin", type: Gin)
  @@index([deleted_at], map: "idx_dir_notification_templates_deleted_at")
  @@index([supported_locales], map: "idx_dir_notification_templates_locales_gin", type: Gin)
  @@index([status], map: "idx_dir_notification_templates_status")
}

model dir_ownership_types {
  id                                                                            String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  code                                                                          String                  @unique @db.VarChar(50)
  name                                                                          String                  @db.VarChar(100)
  description                                                                   String?
  requires_owner                                                                Boolean?                @default(false)
  allows_leasing                                                                Boolean?                @default(false)
  depreciation                                                                  Boolean?                @default(true)
  maintenance_responsibility                                                    String?                 @db.VarChar(20)
  insurance_responsibility                                                      String?                 @db.VarChar(20)
  display_order                                                                 Int?
  is_active                                                                     Boolean?                @default(true)
  metadata                                                                      Json?
  created_at                                                                    DateTime                @default(now()) @db.Timestamptz(6)
  updated_at                                                                    DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                                                    String                  @db.Uuid
  updated_by                                                                    String?                 @db.Uuid
  deleted_at                                                                    DateTime?               @db.Timestamptz(6)
  deleted_by                                                                    String?                 @db.Uuid
  deletion_reason                                                               String?
  name_translations                                                             Json
  description_translations                                                      Json?
  ewj059s adm_provider_employees  @relation("E_2hjqoz", fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_dir_ownership_types_created_by")
  evbnjpb adm_provider_employees? @relation("E_9o03p0", fields: [deleted_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_dir_ownership_types_deleted_by")
  en2bz4t adm_provider_employees? @relation("E_hxbo9i", fields: [updated_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_dir_ownership_types_updated_by")
  flt_vehicles                                                                  flt_vehicles[]

  @@index([code], map: "idx_dir_ownership_types_code")
  @@index([is_active], map: "idx_dir_ownership_types_is_active")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model dir_platform_configs {
  id                                                                             String                  @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  platform_id                                                                    String                  @db.Uuid
  tenant_id                                                                      String                  @db.Uuid
  api_base_url                                                                   String
  auth_method                                                                    String?                 @db.VarChar(50)
  api_version                                                                    String?                 @db.VarChar(20)
  refresh_frequency_minutes                                                      Int?                    @default(60)
  webhook_endpoints                                                              Json?
  supported_services                                                             Json?
  sandbox_config                                                                 Json?
  production_config                                                              Json?
  secrets_vault_ref                                                              String?                 @db.VarChar(100)
  is_active                                                                      Boolean?                @default(true)
  created_at                                                                     DateTime                @default(now()) @db.Timestamptz(6)
  updated_at                                                                     DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                                                     String                  @db.Uuid
  updated_by                                                                     String?                 @db.Uuid
  deleted_at                                                                     DateTime?               @db.Timestamptz(6)
  deleted_by                                                                     String?                 @db.Uuid
  deletion_reason                                                                String?
  eskgnva adm_provider_employees  @relation("E_kpstmr", fields: [created_by], references: [id], onUpdate: NoAction, map: "fk_dir_platform_configs_created_by")
  eza713t adm_provider_employees? @relation("E_rw96ms", fields: [deleted_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_platform_configs_deleted_by")
  dir_platforms                                                                  dir_platforms           @relation(fields: [platform_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_dir_platform_configs_platform")
  adm_tenants                                                                    adm_tenants             @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_dir_platform_configs_tenant")
  er0vgjb adm_provider_employees? @relation("E_yvjaru", fields: [updated_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_platform_configs_updated_by")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model dir_platforms {
  id                                                                      String                     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name                                                                    String                     @unique(map: "dir_platforms_name_uq")
  api_config                                                              Json?
  created_at                                                              DateTime                   @default(now()) @db.Timestamptz(6)
  updated_at                                                              DateTime                   @default(now()) @db.Timestamptz(6)
  code                                                                    String                     @db.VarChar(50)
  description                                                             String?
  logo_url                                                                String?
  provider_category                                                       String?                    @db.VarChar(50)
  supported_countries                                                     Json?
  status                                                                  lifecycle_status           @default(active)
  metadata                                                                Json?
  created_by                                                              String?                    @db.Uuid
  updated_by                                                              String?                    @db.Uuid
  deleted_at                                                              DateTime?                  @db.Timestamptz(6)
  deleted_by                                                              String?                    @db.Uuid
  deletion_reason                                                         String?
  name_translations                                                       Json
  description_translations                                                Json?
  dir_platform_configs                                                    dir_platform_configs[]
  eu85ywp adm_provider_employees?    @relation("E_53hkze", fields: [created_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_platforms_created_by")
  en1plwo adm_provider_employees?    @relation("E_c9xxzf", fields: [deleted_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_platforms_deleted_by")
  eese1c6 adm_provider_employees?    @relation("E_kj9ijx", fields: [updated_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_platforms_updated_by")
  rev_driver_revenues                                                     rev_driver_revenues[]
  rev_reconciliation_lines                                                rev_reconciliation_lines[]
  rev_revenue_imports                                                     rev_revenue_imports[]
  rid_driver_performances                                                 rid_driver_performances[]
  trp_platform_accounts                                                   trp_platform_accounts[]
  trp_trips                                                               trp_trips[]

  @@index([api_config], map: "dir_platforms_api_config_gin", type: Gin)
}

model dir_toll_gates {
  id                      String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  country_code            String                  @db.Char(2)
  gate_code               String                  @db.VarChar(50)
  gate_name               String
  location                Unsupported("point")?
  base_fee                Decimal                 @default(0) @db.Decimal(12, 2)
  currency                String                  @db.Char(3)
  rate_schedule           Json?                   @default("{}")
  status                  toll_gate_status        @default(active)
  active_from             DateTime?               @db.Date
  active_to               DateTime?               @db.Date
  operator                String?                 @db.VarChar(100)
  metadata                Json                    @default("{}")
  created_at              DateTime                @default(now()) @db.Timestamptz(6)
  updated_at              DateTime                @default(now()) @db.Timestamptz(6)
  dir_country_regulations dir_country_regulations @relation(fields: [country_code], references: [country_code], onDelete: Cascade, map: "fk_dir_toll_gates_country")
  fin_toll_transactions   fin_toll_transactions[]

  @@unique([country_code, gate_code], map: "dir_toll_gates_country_gate_code_uq")
}

model dir_transaction_statuses {
  code                     String             @id @db.VarChar(30)
  description              String
  created_at               DateTime           @default(now()) @db.Timestamptz(6)
  description_translations Json
  fin_transactions         fin_transactions[]
}

model dir_transaction_types {
  code                     String             @id @db.VarChar(30)
  description              String
  created_at               DateTime           @default(now()) @db.Timestamptz(6)
  description_translations Json
  fin_transactions         fin_transactions[]
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model dir_vehicle_classes {
  id                                                                                        String                       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  country_code                                                                              String                       @db.Char(2)
  name                                                                                      String
  description                                                                               String?
  max_age                                                                                   Int?
  created_at                                                                                DateTime                     @default(now()) @db.Timestamptz(6)
  updated_at                                                                                DateTime                     @default(now()) @db.Timestamptz(6)
  code                                                                                      String                       @db.VarChar(50)
  min_length_cm                                                                             Int?
  max_length_cm                                                                             Int?
  min_width_cm                                                                              Int?
  max_width_cm                                                                              Int?
  min_height_cm                                                                             Int?
  max_height_cm                                                                             Int?
  min_seats                                                                                 Int?
  max_seats                                                                                 Int?
  min_age                                                                                   Int?
  min_weight_kg                                                                             Int?
  max_weight_kg                                                                             Int?
  criteria                                                                                  Json?
  status                                                                                    lifecycle_status             @default(active)
  metadata                                                                                  Json?
  created_by                                                                                String?                      @db.Uuid
  updated_by                                                                                String?                      @db.Uuid
  deleted_at                                                                                DateTime?                    @db.Timestamptz(6)
  deleted_by                                                                                String?                      @db.Uuid
  deletion_reason                                                                           String?
  name_translations                                                                         Json
  description_translations                                                                  Json
  adm_tenant_vehicle_classes                                                                adm_tenant_vehicle_classes[]
  dir_car_models                                                                            dir_car_models[]
  vc7ljjnm dir_country_regulations[]    @relation("X_r03s31")
  xdsw2lu         dir_country_regulations      @relation("X_gxp9b5", fields: [country_code], references: [country_code], onDelete: Cascade)
  e44mz6u             adm_provider_employees?      @relation("E_y63drn", fields: [created_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_vehicle_classes_created_by")
  e31tdt7             adm_provider_employees?      @relation("E_qzn0rm", fields: [deleted_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_vehicle_classes_deleted_by")
  ebb4ydp             adm_provider_employees?      @relation("E_iqbg74", fields: [updated_by], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_dir_vehicle_classes_updated_by")
  flt_vehicles                                                                              flt_vehicles[]

  @@unique([country_code, name], map: "dir_vehicle_classes_country_name_uq")
  @@index([country_code])
  @@index([created_at])
  @@index([updated_at])
}

model dir_vehicle_statuses {
  id                                                                             String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  code                                                                           String                  @unique @db.VarChar(50)
  name                                                                           String                  @db.VarChar(100)
  description                                                                    String?
  color                                                                          String?                 @db.VarChar(7)
  allowed_transitions                                                            Json?
  requires_approval                                                              Boolean?                @default(false)
  blocking_status                                                                Boolean?                @default(false)
  automatic_actions                                                              Json?
  notification_rules                                                             Json?
  required_documents                                                             Json?
  validation_rules                                                               Json?
  display_order                                                                  Int?
  is_active                                                                      Boolean?                @default(true)
  metadata                                                                       Json?
  created_at                                                                     DateTime                @default(now()) @db.Timestamptz(6)
  updated_at                                                                     DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                                                     String                  @db.Uuid
  updated_by                                                                     String?                 @db.Uuid
  deleted_at                                                                     DateTime?               @db.Timestamptz(6)
  deleted_by                                                                     String?                 @db.Uuid
  deletion_reason                                                                String?
  name_translations                                                              Json
  description_translations                                                       Json?
  edqtjjw adm_provider_employees  @relation("E_llhdsf", fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_dir_vehicle_statuses_created_by")
  e6kd6jv adm_provider_employees? @relation("E_ef10se", fields: [deleted_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_dir_vehicle_statuses_deleted_by")
  e1oye0n adm_provider_employees? @relation("E_65pg7w", fields: [updated_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_dir_vehicle_statuses_updated_by")
  flt_vehicles                                                                   flt_vehicles[]

  @@index([code], map: "idx_dir_vehicle_statuses_code")
  @@index([is_active], map: "idx_dir_vehicle_statuses_is_active")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model doc_document_types {
  code                                                                         String                  @id @db.VarChar(50)
  name                                                                         String
  description                                                                  String?
  requires_expiry                                                              Boolean                 @default(false)
  default_validity_days                                                        Int?
  requires_verification                                                        Boolean                 @default(true)
  allowed_mime_types                                                           String[]
  max_file_size_mb                                                             Int?                    @default(10)
  category                                                                     String?                 @db.VarChar(50)
  is_mandatory                                                                 Boolean                 @default(false)
  display_order                                                                Int                     @default(0)
  icon                                                                         String?                 @db.VarChar(50)
  created_at                                                                   DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                                                   String?                 @db.Uuid
  updated_at                                                                   DateTime                @default(now()) @db.Timestamptz(6)
  updated_by                                                                   String?                 @db.Uuid
  deleted_at                                                                   DateTime?               @db.Timestamptz(6)
  deleted_by                                                                   String?                 @db.Uuid
  deletion_reason                                                              String?
  name_translations                                                            Json
  description_translations                                                     Json?
  edi95b9 adm_provider_employees? @relation("E_qrmvd4", fields: [created_by], references: [id], onUpdate: NoAction, map: "fk_doc_document_types_created_by")
  e6bssb8 adm_provider_employees? @relation("E_xy38d5", fields: [deleted_by], references: [id], onUpdate: NoAction, map: "fk_doc_document_types_deleted_by")
  e1xis9a adm_provider_employees? @relation("E_stp91h", fields: [updated_by], references: [id], onUpdate: NoAction, map: "fk_doc_document_types_updated_by")
  doc_documents                                                                doc_documents[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model doc_document_versions {
  id                  String        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  document_id         String        @db.Uuid
  version_number      Int
  storage_provider    String        @db.VarChar(50)
  storage_key         String
  file_name           String        @db.VarChar(255)
  file_size           Int
  mime_type           String        @db.VarChar(100)
  issue_date          DateTime?     @db.Date
  expiry_date         DateTime?     @db.Date
  verification_status String        @db.VarChar(20)
  verified_by         String?       @db.Uuid
  verified_at         DateTime?     @db.Timestamptz(6)
  rejection_reason    String?
  metadata            Json          @default("{}")
  created_at          DateTime      @default(now()) @db.Timestamptz(6)
  created_by          String        @db.Uuid
  change_reason       String?
  clt_members         clt_members   @relation(fields: [created_by], references: [id], onUpdate: NoAction, map: "fk_doc_document_versions_created_by")
  doc_documents       doc_documents @relation(fields: [document_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_doc_document_versions_document")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model doc_documents {
  id                                                 String                  @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                          String                  @db.Uuid
  entity_type                                        String
  entity_id                                          String                  @db.Uuid
  document_type                                      String
  file_url                                           String
  issue_date                                         DateTime?               @db.Date
  expiry_date                                        DateTime?               @db.Date
  verified                                           Boolean                 @default(false)
  created_at                                         DateTime                @default(now()) @db.Timestamptz(6)
  updated_at                                         DateTime                @default(now()) @db.Timestamptz(6)
  file_name                                          String?                 @db.VarChar(255)
  file_size                                          Int?
  mime_type                                          String?                 @db.VarChar(100)
  metadata                                           Json?                   @default("{}")
  storage_provider                                   storage_provider?       @default(supabase)
  storage_key                                        String?
  access_level                                       access_level?           @default(private)
  verification_status                                verification_status?    @default(pending)
  verified_by                                        String?                 @db.Uuid
  verified_at                                        DateTime?               @db.Timestamptz(6)
  rejection_reason                                   String?
  status                                             document_status         @default(active)
  expiry_notification_sent                           Boolean?                @default(false)
  created_by                                         String?                 @db.Uuid
  updated_by                                         String?                 @db.Uuid
  deleted_at                                         DateTime?               @db.Timestamptz(6)
  deleted_by                                         String?                 @db.Uuid
  deletion_reason                                    String?
  doc_document_versions                              doc_document_versions[]
  adm_tenants                                        adm_tenants             @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  m8tyf64  clt_members?            @relation("M_i33hqq", fields: [created_by], references: [id], onUpdate: NoAction, map: "fk_doc_documents_created_by")
  ml5ypyd  clt_members?            @relation("M_bwtndr", fields: [deleted_by], references: [id], onUpdate: NoAction, map: "fk_doc_documents_deleted_by")
  doc_document_types                                 doc_document_types      @relation(fields: [document_type], references: [code], onUpdate: NoAction, map: "fk_doc_documents_document_type")
  doc_entity_types                                   doc_entity_types        @relation(fields: [entity_type], references: [code], onUpdate: NoAction, map: "fk_doc_documents_entity_type")
  mjua9l  clt_members?            @relation("M_9szcu7", fields: [updated_by], references: [id], onUpdate: NoAction, map: "fk_doc_documents_updated_by")
  mwdazbw clt_members?            @relation("M_z47z6e", fields: [verified_by], references: [id], onUpdate: NoAction, map: "fk_doc_documents_verified_by")
  rid_driver_documents                               rid_driver_documents[]

  @@index([created_at])
  @@index([document_type])
  @@index([entity_id])
  @@index([entity_type])
  @@index([expiry_date])
  @@index([tenant_id, document_type], map: "doc_documents_tenant_document_type_idx")
  @@index([tenant_id, entity_type, entity_id], map: "doc_documents_tenant_entity_idx")
  @@index([tenant_id])
  @@index([updated_at])
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model doc_entity_types {
  code                                                                       String                  @id @db.VarChar(50)
  description                                                                String
  table_name                                                                 String                  @db.VarChar(100)
  is_active                                                                  Boolean                 @default(true)
  display_order                                                              Int                     @default(0)
  metadata                                                                   Json                    @default("{}")
  created_at                                                                 DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                                                 String?                 @db.Uuid
  updated_at                                                                 DateTime                @default(now()) @db.Timestamptz(6)
  updated_by                                                                 String?                 @db.Uuid
  deleted_at                                                                 DateTime?               @db.Timestamptz(6)
  deleted_by                                                                 String?                 @db.Uuid
  description_translations                                                   Json
  doc_documents                                                              doc_documents[]
  e4cw0yl adm_provider_employees? @relation("E_1yslow", fields: [created_by], references: [id], onUpdate: NoAction, map: "fk_doc_entity_types_created_by")
  e2tkc1g adm_provider_employees? @relation("E_958yox", fields: [deleted_by], references: [id], onUpdate: NoAction, map: "fk_doc_entity_types_deleted_by")
  eb2vwly adm_provider_employees? @relation("E_hekj9f", fields: [updated_by], references: [id], onUpdate: NoAction, map: "fk_doc_entity_types_updated_by")
}

model fin_account_types {
  code                     String         @id
  label                    String
  description              String?
  created_at               DateTime       @default(now()) @db.Timestamptz(6)
  updated_at               DateTime       @default(now()) @db.Timestamptz(6)
  label_translations       Json
  description_translations Json?
  fin_accounts             fin_accounts[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model fin_accounts {
  id                                                                      String                       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                               String                       @db.Uuid
  account_name                                                            String
  account_type                                                            String
  currency                                                                String                       @db.VarChar(3)
  balance                                                                 Decimal                      @default(0) @db.Decimal(18, 2)
  metadata                                                                Json                         @default("{}")
  created_at                                                              DateTime                     @default(now()) @db.Timestamptz(6)
  created_by                                                              String?                      @db.Uuid
  updated_at                                                              DateTime                     @default(now()) @db.Timestamptz(6)
  updated_by                                                              String?                      @db.Uuid
  deleted_at                                                              DateTime?                    @db.Timestamptz(6)
  deleted_by                                                              String?                      @db.Uuid
  deletion_reason                                                         String?
  provider                                                                String?
  provider_account_id                                                     String?
  status                                                                  account_status               @default(active)
  opened_at                                                               DateTime?                    @db.Timestamptz(6)
  closed_at                                                               DateTime?                    @db.Timestamptz(6)
  max_balance                                                             Decimal?                     @db.Decimal(18, 2)
  min_balance                                                             Decimal?                     @db.Decimal(18, 2)
  account_number_last4                                                    String?                      @db.Char(4)
  bank_name                                                               String?
  iban                                                                    String?
  swift_bic                                                               String?
  description                                                             String?
  m30zij5                        clt_members?                 @relation("M_rxloyf", fields: [created_by], references: [id])
  mx0wnnm                        clt_members?                 @relation("M_d3l7w8", fields: [deleted_by], references: [id])
  adm_tenants                                                             adm_tenants                  @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  mbb3nfo                        clt_members?                 @relation("M_yte846", fields: [updated_by], references: [id])
  fin_account_types                                                       fin_account_types            @relation(fields: [account_type], references: [code], map: "fk_fin_accounts_account_type")
  fin_driver_payment_batches                                              fin_driver_payment_batches[]
  fin_driver_payments                                                     fin_driver_payments[]
  xnov7ky              fin_transactions[]           @relation("X_gb6ymw")
  xzbd3o7 fin_transactions[]           @relation("X_82qf4v")

  @@index([account_name], map: "idx_fin_accounts_account_name")
  @@index([account_type], map: "idx_fin_accounts_account_type")
  @@index([created_by], map: "idx_fin_accounts_created_by")
  @@index([currency], map: "idx_fin_accounts_currency")
  @@index([deleted_at], map: "idx_fin_accounts_deleted_at")
  @@index([metadata], map: "idx_fin_accounts_metadata", type: Gin)
  @@index([tenant_id], map: "idx_fin_accounts_tenant_id")
  @@index([updated_by], map: "idx_fin_accounts_updated_by")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model fin_driver_payment_batches {
  id                                                                                   String                     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                            String                     @db.Uuid
  batch_reference                                                                      String
  payment_date                                                                         DateTime                   @db.Date
  total_amount                                                                         Decimal                    @db.Decimal(18, 2)
  currency                                                                             String                     @db.VarChar(3)
  status                                                                               String                     @default("pending")
  metadata                                                                             Json                       @default("{}")
  created_at                                                                           DateTime                   @default(now()) @db.Timestamptz(6)
  created_by                                                                           String?                    @db.Uuid
  updated_at                                                                           DateTime                   @default(now()) @db.Timestamptz(6)
  updated_by                                                                           String?                    @db.Uuid
  deleted_at                                                                           DateTime?                  @db.Timestamptz(6)
  deleted_by                                                                           String?                    @db.Uuid
  deletion_reason                                                                      String?
  period_start                                                                         DateTime?                  @db.Date
  period_end                                                                           DateTime?                  @db.Date
  payroll_cycle                                                                        payroll_cycle?
  payment_method                                                                       finance_payment_method?
  batch_type                                                                           batch_type?
  payout_account_id                                                                    String?                    @db.Uuid
  status_reason                                                                        String?
  file_url                                                                             String?
  exported_at                                                                          DateTime?                  @db.Timestamptz(6)
  sent_at                                                                              DateTime?                  @db.Timestamptz(6)
  processed_at                                                                         DateTime?                  @db.Timestamptz(6)
  error_details                                                                        Json?
  m5hswcd                       clt_members?               @relation("M_yaypj", fields: [created_by], references: [id])
  moi48s4                       clt_members?               @relation("M_t1m6ey", fields: [deleted_by], references: [id])
  adm_tenants                                                                          adm_tenants                @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  m2sb8k6                       clt_members?               @relation("M_7bt670", fields: [updated_by], references: [id])
  ef83n2t adm_provider_employees?    @relation("E_ikcc2w", fields: [created_by], references: [id], onDelete: Restrict, map: "fk_fin_driver_payment_batches_created_by")
  e81na2s adm_provider_employees?    @relation("E_bdvz2v", fields: [deleted_by], references: [id], onDelete: Restrict, map: "fk_fin_driver_payment_batches_deleted_by")
  fin_accounts                                                                         fin_accounts?              @relation(fields: [payout_account_id], references: [id], onDelete: Restrict, map: "fk_fin_driver_payment_batches_payout_account")
  fin_payment_batch_statuses                                                           fin_payment_batch_statuses @relation(fields: [status], references: [code], map: "fk_fin_driver_payment_batches_status")
  e7oahq adm_provider_employees?    @relation("E_34keid", fields: [updated_by], references: [id], onDelete: Restrict, map: "fk_fin_driver_payment_batches_updated_by")
  fin_driver_payments                                                                  fin_driver_payments[]
  fin_toll_transactions                                                                fin_toll_transactions[]

  @@index([batch_reference])
  @@index([created_by])
  @@index([deleted_at])
  @@index([metadata], type: Gin)
  @@index([payment_date(sort: Desc)])
  @@index([tenant_id])
  @@index([updated_by])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model fin_driver_payments {
  id                                                                            String                     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                     String                     @db.Uuid
  driver_id                                                                     String                     @db.Uuid
  payment_batch_id                                                              String                     @db.Uuid
  amount                                                                        Decimal                    @db.Decimal(18, 2)
  currency                                                                      String                     @db.VarChar(3)
  payment_date                                                                  DateTime                   @db.Date
  status                                                                        String                     @default("pending")
  metadata                                                                      Json                       @default("{}")
  created_at                                                                    DateTime                   @default(now()) @db.Timestamptz(6)
  created_by                                                                    String?                    @db.Uuid
  updated_at                                                                    DateTime                   @default(now()) @db.Timestamptz(6)
  updated_by                                                                    String?                    @db.Uuid
  deleted_at                                                                    DateTime?                  @db.Timestamptz(6)
  deleted_by                                                                    String?                    @db.Uuid
  deletion_reason                                                               String?
  period_start                                                                  DateTime?                  @db.Date
  period_end                                                                    DateTime?                  @db.Date
  amount_in_tenant_currency                                                     Decimal?                   @db.Decimal(18, 2)
  exchange_rate                                                                 Decimal?                   @db.Decimal(12, 6)
  payment_method                                                                finance_payment_method?
  payout_account_id                                                             String?                    @db.Uuid
  transaction_reference                                                         String?
  status_reason                                                                 String?
  error_details                                                                 Json?
  processed_at                                                                  DateTime?                  @db.Timestamptz(6)
  failed_at                                                                     DateTime?                  @db.Timestamptz(6)
  cancelled_at                                                                  DateTime?                  @db.Timestamptz(6)
  notes                                                                         String?
  mn417n7                       clt_members?               @relation("M_vimqxf", fields: [created_by], references: [id])
  mhx5p7g                       clt_members?               @relation("M_1iplsy", fields: [deleted_by], references: [id])
  rid_drivers                                                                   rid_drivers                @relation(fields: [driver_id], references: [id], onDelete: Cascade)
  fin_driver_payment_batches                                                    fin_driver_payment_batches @relation(fields: [payment_batch_id], references: [id], onDelete: Cascade)
  adm_tenants                                                                   adm_tenants                @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  mve5cjq                       clt_members?               @relation("M_n8im0w", fields: [updated_by], references: [id])
  e8tsryh adm_provider_employees?    @relation("E_l7nmmc", fields: [created_by], references: [id], onDelete: Restrict, map: "fk_fin_driver_payments_created_by")
  eg094yi adm_provider_employees?    @relation("E_e179mb", fields: [deleted_by], references: [id], onDelete: Restrict, map: "fk_fin_driver_payments_deleted_by")
  fin_accounts                                                                  fin_accounts?              @relation(fields: [payout_account_id], references: [id], map: "fk_fin_driver_payments_payout_account")
  fin_payment_statuses                                                          fin_payment_statuses       @relation(fields: [status], references: [code], map: "fk_fin_driver_payments_status")
  eo9kpj0 adm_provider_employees?    @relation("E_5rvp1t", fields: [updated_by], references: [id], onDelete: Restrict, map: "fk_fin_driver_payments_updated_by")
  fin_toll_transactions                                                         fin_toll_transactions[]
  fin_traffic_fines                                                             fin_traffic_fines[]

  @@index([created_by])
  @@index([deleted_at])
  @@index([driver_id])
  @@index([metadata], type: Gin)
  @@index([payment_batch_id])
  @@index([payment_date(sort: Desc)])
  @@index([tenant_id])
  @@index([updated_by])
}

model fin_payment_batch_statuses {
  code                       String                       @id
  label                      String
  description                String?
  created_at                 DateTime                     @default(now()) @db.Timestamptz(6)
  label_translations         Json
  description_translations   Json?
  fin_driver_payment_batches fin_driver_payment_batches[]
}

model fin_payment_statuses {
  code                     String                @id
  label                    String
  description              String?
  created_at               DateTime              @default(now()) @db.Timestamptz(6)
  label_translations       Json
  description_translations Json?
  fin_driver_payments      fin_driver_payments[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model fin_toll_transactions {
  id                                                        String                      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                 String                      @db.Uuid
  driver_id                                                 String                      @db.Uuid
  vehicle_id                                                String                      @db.Uuid
  toll_gate                                                 String
  toll_date                                                 DateTime                    @db.Date
  amount                                                    Decimal                     @db.Decimal(14, 2)
  currency                                                  String                      @db.VarChar(3)
  metadata                                                  Json                        @default("{}")
  created_at                                                DateTime                    @default(now()) @db.Timestamptz(6)
  created_by                                                String?                     @db.Uuid
  updated_at                                                DateTime                    @default(now()) @db.Timestamptz(6)
  updated_by                                                String?                     @db.Uuid
  deleted_at                                                DateTime?                   @db.Timestamptz(6)
  deleted_by                                                String?                     @db.Uuid
  deletion_reason                                           String?
  toll_gate_id                                              String?                     @db.Uuid
  toll_timestamp                                            DateTime?                   @db.Timestamptz(6)
  source                                                    toll_transaction_source?
  status                                                    toll_transaction_status
  payment_batch_id                                          String?                     @db.Uuid
  driver_payment_id                                         String?                     @db.Uuid
  trip_id                                                   String?                     @db.Uuid
  mlo1ofc clt_members?                @relation("M_egobz6", fields: [created_by], references: [id])
  mjd58fb clt_members?                @relation("M_qkikvh", fields: [deleted_by], references: [id])
  rid_drivers                                               rid_drivers                 @relation(fields: [driver_id], references: [id], onDelete: Cascade)
  adm_tenants                                               adm_tenants                 @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  mty5tbv clt_members?                @relation("M_mqsgvp", fields: [updated_by], references: [id])
  flt_vehicles                                              flt_vehicles                @relation(fields: [vehicle_id], references: [id], onDelete: Cascade)
  fin_driver_payments                                       fin_driver_payments?        @relation(fields: [driver_payment_id], references: [id], map: "fk_fin_toll_transactions_driver_payment")
  fin_driver_payment_batches                                fin_driver_payment_batches? @relation(fields: [payment_batch_id], references: [id], map: "fk_fin_toll_transactions_payment_batch")
  dir_toll_gates                                            dir_toll_gates?             @relation(fields: [toll_gate_id], references: [id], onDelete: Restrict, map: "fk_fin_toll_transactions_toll_gate")
  trp_trips                                                 trp_trips?                  @relation(fields: [trip_id], references: [id], map: "fk_fin_toll_transactions_trip")

  @@index([created_by])
  @@index([deleted_at])
  @@index([driver_id])
  @@index([metadata], type: Gin)
  @@index([tenant_id])
  @@index([toll_date(sort: Desc)])
  @@index([updated_by])
  @@index([vehicle_id])
}

model fin_traffic_fine_disputes {
  id                                                                        String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  fine_id                                                                   String              @db.Uuid
  submitted_by                                                              String              @db.Uuid
  submitted_at                                                              DateTime            @default(now()) @db.Timestamptz(6)
  reason                                                                    String
  supporting_documents                                                      Json?
  status                                                                    dispute_status      @default(pending)
  reviewed_by                                                               String?             @db.Uuid
  resolved_at                                                               DateTime?           @db.Timestamptz(6)
  resolution_notes                                                          String?
  metadata                                                                  Json                @default("{}")
  created_at                                                                DateTime            @default(now()) @db.Timestamptz(6)
  updated_at                                                                DateTime            @default(now()) @db.Timestamptz(6)
  xdupy85    fin_traffic_fines   @relation("X_xrqr7b", fields: [fine_id], references: [id], onDelete: Cascade, map: "fk_fin_traffic_fine_disputes_fine")
  mylosli            clt_members?        @relation("M_vvxbqs", fields: [reviewed_by], references: [id], map: "fk_fin_traffic_fine_disputes_reviewed_by")
  m76mito           clt_members         @relation("M_8geo42", fields: [submitted_by], references: [id], onDelete: Cascade, map: "fk_fin_traffic_fine_disputes_submitted_by")
  x67sqmj fin_traffic_fines[] @relation("X_1izzin")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model fin_traffic_fines {
  id                                                                                String                      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                         String                      @db.Uuid
  driver_id                                                                         String                      @db.Uuid
  vehicle_id                                                                        String                      @db.Uuid
  fine_reference                                                                    String
  fine_date                                                                         DateTime                    @db.Date
  fine_type                                                                         String
  amount                                                                            Decimal                     @db.Decimal(14, 2)
  currency                                                                          String                      @db.VarChar(3)
  status                                                                            String                      @default("pending")
  metadata                                                                          Json                        @default("{}")
  created_at                                                                        DateTime                    @default(now()) @db.Timestamptz(6)
  created_by                                                                        String?                     @db.Uuid
  updated_at                                                                        DateTime                    @default(now()) @db.Timestamptz(6)
  updated_by                                                                        String?                     @db.Uuid
  deleted_at                                                                        DateTime?                   @db.Timestamptz(6)
  deleted_by                                                                        String?                     @db.Uuid
  deletion_reason                                                                   String?
  fine_timestamp                                                                    DateTime?                   @db.Timestamptz(6)
  fine_type_id                                                                      String?                     @db.Uuid
  location                                                                          Unsupported("point")?
  address                                                                           String?
  points_penalty                                                                    Int?
  issuing_authority                                                                 String?
  deadline_date                                                                     DateTime?                   @db.Date
  paid_at                                                                           DateTime?                   @db.Timestamptz(6)
  payment_method_id                                                                 String?                     @db.Uuid
  driver_payment_id                                                                 String?                     @db.Uuid
  dispute_id                                                                        String?                     @db.Uuid
  xd19nzq    fin_traffic_fine_disputes[] @relation("X_xrqr7b")
  m7wj8zq                             clt_members?                @relation("M_kom41s", fields: [created_by], references: [id])
  mx4nnux                             clt_members?                @relation("M_9bb12p", fields: [deleted_by], references: [id])
  rid_drivers                                                                       rid_drivers                 @relation(fields: [driver_id], references: [id], onDelete: Cascade)
  adm_tenants                                                                       adm_tenants                 @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  mg6ndw9                             clt_members?                @relation("M_cehz59", fields: [updated_by], references: [id])
  flt_vehicles                                                                      flt_vehicles                @relation(fields: [vehicle_id], references: [id], onDelete: Cascade)
  xsrtacw fin_traffic_fine_disputes?  @relation("X_1izzin", fields: [dispute_id], references: [id], map: "fk_fin_traffic_fines_dispute")
  fin_driver_payments                                                               fin_driver_payments?        @relation(fields: [driver_payment_id], references: [id], map: "fk_fin_traffic_fines_driver_payment")
  dir_fine_types                                                                    dir_fine_types?             @relation(fields: [fine_type_id], references: [id], onDelete: Restrict, map: "fk_fin_traffic_fines_fine_type")
  bil_payment_methods                                                               bil_payment_methods?        @relation(fields: [payment_method_id], references: [id], map: "fk_fin_traffic_fines_payment_method")

  @@index([created_by])
  @@index([deleted_at])
  @@index([driver_id])
  @@index([fine_date(sort: Desc)])
  @@index([metadata], type: Gin)
  @@index([tenant_id])
  @@index([updated_by])
  @@index([vehicle_id])
}

model fin_transaction_categories {
  id                               String                       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  code                             String                       @unique @db.VarChar(50)
  name                             String
  description                      String?
  category_type                    transaction_category_type
  parent_category_id               String?                      @db.Uuid
  is_active                        Boolean                      @default(true)
  created_at                       DateTime                     @default(now()) @db.Timestamptz(6)
  updated_at                       DateTime                     @default(now()) @db.Timestamptz(6)
  name_translations                Json
  description_translations         Json?
  fin_transaction_categories       fin_transaction_categories?  @relation("X_tk9jib", fields: [parent_category_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_fin_transaction_categories_parent")
  other_fin_transaction_categories fin_transaction_categories[] @relation("X_tk9jib")
  fin_transactions                 fin_transactions[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model fin_transactions {
  id                                                                  String                      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                           String                      @db.Uuid
  account_id                                                          String                      @db.Uuid
  transaction_type                                                    String
  amount                                                              Decimal                     @db.Decimal(18, 2)
  currency                                                            String                      @db.VarChar(3)
  reference                                                           String
  description                                                         String?
  transaction_date                                                    DateTime                    @db.Timestamptz(6)
  status                                                              String                      @default("pending")
  metadata                                                            Json                        @default("{}")
  created_at                                                          DateTime                    @default(now()) @db.Timestamptz(6)
  created_by                                                          String?                     @db.Uuid
  updated_at                                                          DateTime                    @default(now()) @db.Timestamptz(6)
  updated_by                                                          String?                     @db.Uuid
  deleted_at                                                          DateTime?                   @db.Timestamptz(6)
  deleted_by                                                          String?                     @db.Uuid
  deletion_reason                                                     String?
  counterparty_account_id                                             String?                     @db.Uuid
  net_amount                                                          Decimal?                    @db.Decimal(18, 2)
  tax_rate                                                            Decimal?                    @db.Decimal(5, 2)
  tax_amount                                                          Decimal?                    @db.Decimal(18, 2)
  exchange_rate                                                       Decimal?                    @db.Decimal(18, 6)
  category_id                                                         String?                     @db.Uuid
  entity_type                                                         String?                     @db.VarChar(50)
  entity_id                                                           String?                     @db.Uuid
  payment_method_id                                                   String?                     @db.Uuid
  source_system                                                       String?                     @db.VarChar(50)
  validated_by                                                        String?                     @db.Uuid
  validated_at                                                        DateTime?                   @db.Timestamptz(6)
  xicgodv              fin_accounts                @relation("X_gb6ymw", fields: [account_id], references: [id], onDelete: Cascade)
  mdbzzls                clt_members?                @relation("M_yd3ie", fields: [created_by], references: [id])
  mrp6x8v                clt_members?                @relation("M_uya8mv", fields: [deleted_by], references: [id])
  adm_tenants                                                         adm_tenants                 @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  mlm44ib                clt_members?                @relation("M_98h8ex", fields: [updated_by], references: [id])
  fin_transaction_categories                                          fin_transaction_categories? @relation(fields: [category_id], references: [id], map: "fk_fin_transactions_category")
  xitpp7e fin_accounts?               @relation("X_82qf4v", fields: [counterparty_account_id], references: [id], map: "fk_fin_transactions_counterparty")
  bil_payment_methods                                                 bil_payment_methods?        @relation(fields: [payment_method_id], references: [id], map: "fk_fin_transactions_payment_method")
  dir_transaction_statuses                                            dir_transaction_statuses    @relation(fields: [status], references: [code], map: "fk_fin_transactions_status")
  dir_transaction_types                                               dir_transaction_types       @relation(fields: [transaction_type], references: [code], map: "fk_fin_transactions_transaction_type")
  myhl352              clt_members?                @relation("M_nbijw", fields: [validated_by], references: [id], map: "fk_fin_transactions_validated_by")

  @@index([account_id])
  @@index([created_by])
  @@index([deleted_at])
  @@index([metadata], type: Gin)
  @@index([tenant_id])
  @@index([transaction_date(sort: Desc)])
  @@index([updated_by])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model flt_vehicle_assignments {
  id                                                                                String                   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                         String                   @db.Uuid
  driver_id                                                                         String                   @db.Uuid
  vehicle_id                                                                        String                   @db.Uuid
  start_date                                                                        DateTime                 @db.Date
  end_date                                                                          DateTime?                @db.Date
  assignment_type                                                                   String                   @default("permanent") @db.VarChar(50)
  metadata                                                                          Json                     @default("{}")
  status                                                                            String                   @default("active") @db.VarChar(50)
  created_at                                                                        DateTime                 @default(now()) @db.Timestamptz(6)
  created_by                                                                        String?                  @db.Uuid
  updated_at                                                                        DateTime                 @default(now()) @db.Timestamptz(6)
  updated_by                                                                        String?                  @db.Uuid
  deleted_at                                                                        DateTime?                @db.Timestamptz(6)
  deleted_by                                                                        String?                  @db.Uuid
  deletion_reason                                                                   String?
  handover_date                                                                     DateTime?                @db.Timestamptz(6)
  handover_location                                                                 String?
  handover_type                                                                     String?                  @db.VarChar(20)
  initial_odometer                                                                  Int?
  initial_fuel_level                                                                Int?
  initial_condition                                                                 Json?
  handover_photos                                                                   Json?
  photos_metadata                                                                   Json?
  driver_signature                                                                  String?
  fleet_signature                                                                   String?
  handover_checklist                                                                Json?
  return_date                                                                       DateTime?                @db.Timestamptz(6)
  return_odometer                                                                   Int?
  return_fuel_level                                                                 Int?
  return_condition                                                                  Json?
  damages_reported                                                                  Json?
  penalty_amount                                                                    Decimal?                 @db.Decimal(18, 2)
  notes                                                                             String?
  ezdg7lx adm_provider_employees?  @relation("E_tldo32", fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_assignments_created_by")
  es6zulw adm_provider_employees?  @relation("E_y9a0w1", fields: [deleted_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_assignments_deleted_by")
  rid_drivers                                                                       rid_drivers              @relation(fields: [driver_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_assignments_driver_id")
  adm_tenants                                                                       adm_tenants              @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_flt_vehicle_assignments_tenant_id")
  ejxoa1e adm_provider_employees?  @relation("E_pzygbj", fields: [updated_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_assignments_updated_by")
  flt_vehicles                                                                      flt_vehicles             @relation(fields: [vehicle_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_assignments_vehicle_id")
  md8ynmt                       clt_members?             @relation("M_kidcbl", fields: [created_by], references: [id])
  mrs897u                       clt_members?             @relation("M_9hjssw", fields: [deleted_by], references: [id])
  mlj2sjc                       clt_members?             @relation("M_c897f2", fields: [updated_by], references: [id])
  flt_vehicle_equipments                                                            flt_vehicle_equipments[]
  flt_vehicle_events                                                                flt_vehicle_events[]

  @@index([created_by])
  @@index([deleted_at])
  @@index([driver_id])
  @@index([end_date])
  @@index([metadata], type: Gin)
  @@index([start_date])
  @@index([tenant_id])
  @@index([updated_by])
  @@index([vehicle_id])
}

model flt_vehicle_equipments {
  id                                                                               String                   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                                                        String                   @db.Uuid
  vehicle_id                                                                       String                   @db.Uuid
  equipment_type                                                                   String                   @db.VarChar(50)
  name                                                                             String                   @db.VarChar(100)
  description                                                                      String?
  serial_number                                                                    String?                  @db.VarChar(100)
  provided_date                                                                    DateTime                 @db.Date
  return_date                                                                      DateTime?                @db.Date
  expiry_date                                                                      DateTime?                @db.Date
  purchase_price                                                                   Decimal?                 @db.Decimal(18, 2)
  current_value                                                                    Decimal?                 @db.Decimal(18, 2)
  currency                                                                         String?                  @db.Char(3)
  depreciation_rate                                                                Decimal?                 @db.Decimal(5, 2)
  condition_at_provision                                                           String?                  @db.VarChar(20)
  condition_at_return                                                              String?                  @db.VarChar(20)
  damage_notes                                                                     String?
  status                                                                           String                   @db.VarChar(20)
  current_assignment_id                                                            String?                  @db.Uuid
  warranty_expiry                                                                  DateTime?                @db.Date
  warranty_provider                                                                String?                  @db.VarChar(100)
  last_maintenance_date                                                            DateTime?                @db.Date
  next_maintenance_date                                                            DateTime?                @db.Date
  notes                                                                            String?
  metadata                                                                         Json?
  created_at                                                                       DateTime                 @default(now()) @db.Timestamptz(6)
  updated_at                                                                       DateTime                 @default(now()) @db.Timestamptz(6)
  created_by                                                                       String                   @db.Uuid
  updated_by                                                                       String?                  @db.Uuid
  deleted_at                                                                       DateTime?                @db.Timestamptz(6)
  deleted_by                                                                       String?                  @db.Uuid
  name_translations                                                                Json
  description_translations                                                         Json?
  es694u0 adm_provider_employees   @relation("E_qmekvp", fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_equipments_created_by")
  flt_vehicle_assignments                                                          flt_vehicle_assignments? @relation(fields: [current_assignment_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_equipments_current_assignment_id")
  ekzsrtz adm_provider_employees?  @relation("E_xsuxvq", fields: [deleted_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_equipments_deleted_by")
  adm_tenants                                                                      adm_tenants              @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_flt_vehicle_equipments_tenant_id")
  ecqh79h adm_provider_employees?  @relation("E_syxjiw", fields: [updated_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_equipments_updated_by")
  flt_vehicles                                                                     flt_vehicles             @relation(fields: [vehicle_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_equipments_vehicle_id")

  @@index([current_assignment_id], map: "idx_flt_vehicle_equipments_current_assignment_id")
  @@index([status], map: "idx_flt_vehicle_equipments_status")
  @@index([tenant_id], map: "idx_flt_vehicle_equipments_tenant_id")
  @@index([vehicle_id], map: "idx_flt_vehicle_equipments_vehicle_id")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model flt_vehicle_events {
  id                                                                           String                   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                    String                   @db.Uuid
  vehicle_id                                                                   String                   @db.Uuid
  event_type                                                                   String
  event_date                                                                   DateTime                 @db.Timestamptz(6)
  severity                                                                     String?
  downtime_hours                                                               Int?
  cost_amount                                                                  Decimal?                 @db.Decimal(10, 2)
  currency                                                                     String                   @default("EUR") @db.Char(3)
  details                                                                      Json                     @default("{}")
  notes                                                                        String?
  created_at                                                                   DateTime                 @default(now()) @db.Timestamptz(6)
  created_by                                                                   String?                  @db.Uuid
  updated_at                                                                   DateTime                 @default(now()) @db.Timestamptz(6)
  updated_by                                                                   String?                  @db.Uuid
  deleted_at                                                                   DateTime?                @db.Timestamptz(6)
  deleted_by                                                                   String?                  @db.Uuid
  deletion_reason                                                              String?
  driver_id                                                                    String?                  @db.Uuid
  ride_id                                                                      String?                  @db.Uuid
  assignment_id                                                                String?                  @db.Uuid
  responsible_party                                                            String?                  @db.VarChar(20)
  fault_percentage                                                             Int?
  liability_assessment                                                         Json?
  police_report_number                                                         String?
  police_station                                                               String?
  insurance_claim_id                                                           String?                  @db.Uuid
  claim_status                                                                 String?                  @db.VarChar(20)
  repair_status                                                                String?                  @db.VarChar(20)
  repair_shop_id                                                               String?                  @db.Uuid
  estimated_repair_days                                                        Int?
  actual_repair_days                                                           Int?
  repair_invoice_id                                                            String?                  @db.Uuid
  photos                                                                       Json?
  flt_vehicle_assignments                                                      flt_vehicle_assignments? @relation(fields: [assignment_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_events_assignment_id")
  ebcwqf0 adm_provider_employees?  @relation("E_jebavr", fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_events_created_by")
  eijd3f1 adm_provider_employees?  @relation("E_c7uxvq", fields: [deleted_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_events_deleted_by")
  rid_drivers                                                                  rid_drivers?             @relation(fields: [driver_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_events_driver_id")
  adm_tenants                                                                  adm_tenants              @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_flt_vehicle_events_tenant_id")
  eqsonzj adm_provider_employees?  @relation("E_3yjdb8", fields: [updated_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_events_updated_by")
  flt_vehicles                                                                 flt_vehicles             @relation(fields: [vehicle_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_events_vehicle_id")
  mr13x84                       clt_members?             @relation("M_6t5nd2", fields: [created_by], references: [id])
  me02zmj                       clt_members?             @relation("M_n6rhrf", fields: [deleted_by], references: [id])
  mzb824n                       clt_members?             @relation("M_1gyhjh", fields: [updated_by], references: [id])

  @@index([created_at(sort: Desc)])
  @@index([created_by])
  @@index([deleted_at])
  @@index([details], type: Gin)
  @@index([event_date])
  @@index([event_type])
  @@index([tenant_id])
  @@index([updated_by])
  @@index([vehicle_id])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model flt_vehicle_expenses {
  id                                                                                      String                  @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                               String                  @db.Uuid
  vehicle_id                                                                              String                  @db.Uuid
  driver_id                                                                               String?                 @db.Uuid
  ride_id                                                                                 String?                 @db.Uuid
  expense_date                                                                            DateTime                @db.Date
  expense_category                                                                        String
  amount                                                                                  Decimal                 @db.Decimal(10, 2)
  currency                                                                                String                  @default("EUR") @db.Char(3)
  payment_method                                                                          String?
  receipt_url                                                                             String?
  odometer_reading                                                                        Int?
  quantity                                                                                Decimal?                @db.Decimal(10, 2)
  unit_price                                                                              Decimal?                @db.Decimal(10, 2)
  location                                                                                String?
  vendor                                                                                  String?
  description                                                                             String?
  reimbursed                                                                              Boolean                 @default(false)
  reimbursed_at                                                                           DateTime?               @db.Timestamptz(6)
  reimbursed_in_batch_id                                                                  String?                 @db.Uuid
  notes                                                                                   String?
  metadata                                                                                Json                    @default("{}")
  created_at                                                                              DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                                                              String?                 @db.Uuid
  updated_at                                                                              DateTime                @default(now()) @db.Timestamptz(6)
  updated_by                                                                              String?                 @db.Uuid
  deleted_at                                                                              DateTime?               @db.Timestamptz(6)
  deleted_by                                                                              String?                 @db.Uuid
  deletion_reason                                                                         String?
  expense_subcategory                                                                     String?                 @db.VarChar(50)
  period_start                                                                            DateTime?               @db.Date
  period_end                                                                              DateTime?               @db.Date
  mileage_start                                                                           Int?
  mileage_end                                                                             Int?
  trip_ids                                                                                String[]                @db.Uuid
  requires_approval                                                                       Boolean?                @default(true)
  approval_threshold                                                                      Decimal?                @db.Decimal(18, 2)
  approval_status                                                                         String?                 @db.VarChar(20)
  approved_by                                                                             String?                 @db.Uuid
  approved_at                                                                             DateTime?               @db.Timestamptz(6)
  rejection_reason                                                                        String?
  receipt_status                                                                          String?                 @db.VarChar(20)
  receipt_verified_by                                                                     String?                 @db.Uuid
  receipt_verified_at                                                                     DateTime?               @db.Timestamptz(6)
  receipt_issues                                                                          Json?
  ocr_extracted_data                                                                      Json?
  allocation_rule                                                                         String?                 @db.VarChar(20)
  driver_share_percent                                                                    Int?
  fleet_share_percent                                                                     Int?
  client_share_percent                                                                    Int?
  cost_center_id                                                                          String?                 @db.Uuid
  payment_batch_id                                                                        String?                 @db.Uuid
  payment_status                                                                          String?                 @db.VarChar(20)
  payment_date                                                                            DateTime?               @db.Date
  payment_reference                                                                       String?
  esjk9l         adm_provider_employees? @relation("E_v3qfom", fields: [approved_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_expenses_approved_by")
  ea5fm4i          adm_provider_employees? @relation("E_i03gd1", fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_expenses_created_by")
  e2yz94h          adm_provider_employees? @relation("E_atn3d0", fields: [deleted_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_expenses_deleted_by")
  rid_drivers                                                                             rid_drivers?            @relation(fields: [driver_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_expenses_driver_id")
  e5l1lpd adm_provider_employees? @relation("E_5it5qq", fields: [receipt_verified_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_expenses_receipt_verified_by")
  adm_tenants                                                                             adm_tenants             @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_flt_vehicle_expenses_tenant_id")
  e5acbg1          adm_provider_employees? @relation("E_2kbisi", fields: [updated_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_expenses_updated_by")
  flt_vehicles                                                                            flt_vehicles            @relation(fields: [vehicle_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_expenses_vehicle_id")
  mssqop6                                clt_members?            @relation("M_hko51g", fields: [created_by], references: [id])
  m176gfb                                clt_members?            @relation("M_cf9031", fields: [deleted_by], references: [id])
  trp_trips                                                                               trp_trips?              @relation(fields: [ride_id], references: [id], onUpdate: NoAction)
  mkimjsn                                clt_members?            @relation("M_9ak04x", fields: [updated_by], references: [id])

  @@index([created_at(sort: Desc)])
  @@index([created_by])
  @@index([deleted_at])
  @@index([driver_id])
  @@index([expense_category])
  @@index([expense_date])
  @@index([metadata], type: Gin)
  @@index([ride_id])
  @@index([tenant_id])
  @@index([updated_by])
  @@index([vehicle_id])
}

model flt_vehicle_inspections {
  id                                                                                String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                                                         String                  @db.Uuid
  vehicle_id                                                                        String                  @db.Uuid
  inspection_type                                                                   String                  @db.VarChar(50)
  scheduled_date                                                                    DateTime                @db.Date
  actual_date                                                                       DateTime?               @db.Date
  status                                                                            String                  @db.VarChar(20)
  passed                                                                            Boolean?                @default(false)
  score                                                                             Int?
  inspector_name                                                                    String?                 @db.VarChar(100)
  inspection_center                                                                 String?                 @db.VarChar(200)
  certificate_number                                                                String?                 @db.VarChar(100)
  expiry_date                                                                       DateTime?               @db.Date
  issues_found                                                                      Json?
  corrective_actions                                                                Json?
  report_url                                                                        String?
  certificate_url                                                                   String?
  photos_urls                                                                       Json?
  cost_amount                                                                       Decimal?                @db.Decimal(18, 2)
  currency                                                                          String?                 @db.Char(3)
  next_inspection_date                                                              DateTime?               @db.Date
  reminder_sent                                                                     Boolean?                @default(false)
  notes                                                                             String?
  metadata                                                                          Json?
  created_at                                                                        DateTime?               @default(now()) @db.Timestamptz(6)
  updated_at                                                                        DateTime?               @default(now()) @db.Timestamptz(6)
  created_by                                                                        String                  @db.Uuid
  updated_by                                                                        String?                 @db.Uuid
  e87f80k adm_provider_employees  @relation("E_2551qf", fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_inspections_created_by")
  adm_tenants                                                                       adm_tenants             @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_flt_vehicle_inspections_tenant_id")
  enn75l3 adm_provider_employees? @relation("E_hkwzay", fields: [updated_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_inspections_updated_by")
  flt_vehicles                                                                      flt_vehicles            @relation(fields: [vehicle_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_inspections_vehicle_id")

  @@index([scheduled_date], map: "idx_flt_vehicle_inspections_scheduled_date")
  @@index([status], map: "idx_flt_vehicle_inspections_status")
  @@index([tenant_id], map: "idx_flt_vehicle_inspections_tenant_id")
  @@index([vehicle_id], map: "idx_flt_vehicle_inspections_vehicle_id")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model flt_vehicle_insurances {
  id                                                                               String                   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                        String                   @db.Uuid
  vehicle_id                                                                       String                   @db.Uuid
  provider_name                                                                    String
  policy_number                                                                    String
  policy_type                                                                      String
  coverage_amount                                                                  Decimal?                 @db.Decimal(12, 2)
  currency                                                                         String                   @default("EUR") @db.Char(3)
  deductible_amount                                                                Decimal?                 @db.Decimal(10, 2)
  premium_amount                                                                   Decimal                  @db.Decimal(10, 2)
  premium_frequency                                                                String                   @default("annual")
  start_date                                                                       DateTime                 @db.Date
  end_date                                                                         DateTime                 @db.Date
  is_active                                                                        Boolean                  @default(true)
  auto_renew                                                                       Boolean                  @default(false)
  contact_name                                                                     String?
  contact_phone                                                                    String?
  contact_email                                                                    String?
  document_url                                                                     String?
  claim_count                                                                      Int                      @default(0)
  last_claim_date                                                                  DateTime?                @db.Date
  notes                                                                            String?
  metadata                                                                         Json                     @default("{}")
  created_at                                                                       DateTime                 @default(now()) @db.Timestamptz(6)
  created_by                                                                       String?                  @db.Uuid
  updated_at                                                                       DateTime                 @default(now()) @db.Timestamptz(6)
  updated_by                                                                       String?                  @db.Uuid
  deleted_at                                                                       DateTime?                @db.Timestamptz(6)
  deleted_by                                                                       String?                  @db.Uuid
  deletion_reason                                                                  String?
  policy_category                                                                  String?                  @db.VarChar(20)
  policy_priority                                                                  Int?
  parent_policy_id                                                                 String?                  @db.Uuid
  coverage_territories                                                             String[]
  coverage_drivers                                                                 String?                  @db.VarChar(20)
  driver_restrictions                                                              Json?
  vehicle_usage                                                                    String?                  @db.VarChar(20)
  base_premium                                                                     Decimal?                 @db.Decimal(18, 2)
  excess_details                                                                   Json?
  no_claims_years                                                                  Int?                     @default(0)
  no_claims_bonus                                                                  Int?                     @default(0)
  claims_loading                                                                   Int?                     @default(0)
  claims_count                                                                     Int?                     @default(0)
  claims_detail                                                                    Json?
  total_claims_amount                                                              Decimal?                 @db.Decimal(18, 2)
  claims_ratio                                                                     Decimal?                 @db.Decimal(8, 4)
  risk_rating                                                                      String?                  @db.VarChar(10)
  risk_factors                                                                     Json?
  special_conditions                                                               Json?
  exclusions                                                                       Json?
  broker_id                                                                        String?                  @db.Uuid
  broker_commission                                                                Decimal?                 @db.Decimal(5, 2)
  broker_reference                                                                 String?
  renewal_date                                                                     DateTime?                @db.Date
  renewal_notice_sent                                                              Boolean?                 @default(false)
  renewal_quote                                                                    Decimal?                 @db.Decimal(18, 2)
  competitor_quotes                                                                Json?
  payment_frequency                                                                String?                  @db.VarChar(20)
  payment_method                                                                   String?                  @db.VarChar(20)
  payment_schedule                                                                 Json?
  next_payment_date                                                                DateTime?                @db.Date
  outstanding_amount                                                               Decimal?                 @db.Decimal(18, 2)
  co_insurance                                                                     Boolean?                 @default(false)
  co_insurers                                                                      Json?
  lead_insurer                                                                     String?                  @db.VarChar(200)
  ebxdypo adm_provider_employees?  @relation("E_4b2djr", fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_insurances_created_by")
  ej3ubpp adm_provider_employees?  @relation("E_2vdzga", fields: [deleted_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_insurances_deleted_by")
  flt_vehicle_insurances                                                           flt_vehicle_insurances?  @relation("X_vefbxn", fields: [parent_policy_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_insurances_parent_policy_id")
  other_flt_vehicle_insurances                                                     flt_vehicle_insurances[] @relation("X_vefbxn")
  adm_tenants                                                                      adm_tenants              @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_flt_vehicle_insurances_tenant_id")
  erd5wa7 adm_provider_employees?  @relation("E_b4pk0s", fields: [updated_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_insurances_updated_by")
  flt_vehicles                                                                     flt_vehicles             @relation(fields: [vehicle_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_insurances_vehicle_id")
  m72ybhw                       clt_members?             @relation("M_3678hy", fields: [created_by], references: [id])
  mxy8lcr                       clt_members?             @relation("M_qtpwmj", fields: [deleted_by], references: [id])
  mfd2gef                       clt_members?             @relation("M_53wwel", fields: [updated_by], references: [id])

  @@index([created_at(sort: Desc)])
  @@index([metadata], type: Gin)
  @@index([policy_number])
  @@index([policy_type])
  @@index([tenant_id])
  @@index([vehicle_id])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model flt_vehicle_maintenance {
  id                                                                                      String                      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                               String                      @db.Uuid
  vehicle_id                                                                              String                      @db.Uuid
  maintenance_type                                                                        String
  scheduled_date                                                                          DateTime                    @db.Date
  completed_date                                                                          DateTime?                   @db.Date
  odometer_reading                                                                        Int?
  next_service_km                                                                         Int?
  next_service_date                                                                       DateTime?                   @db.Date
  provider_name                                                                           String?
  provider_contact                                                                        String?
  cost_amount                                                                             Decimal?                    @db.Decimal(10, 2)
  currency                                                                                String                      @default("EUR") @db.Char(3)
  invoice_reference                                                                       String?
  parts_replaced                                                                          String?
  notes                                                                                   String?
  status                                                                                  String                      @default("scheduled")
  metadata                                                                                Json                        @default("{}")
  created_at                                                                              DateTime                    @default(now()) @db.Timestamptz(6)
  created_by                                                                              String?                     @db.Uuid
  updated_at                                                                              DateTime                    @default(now()) @db.Timestamptz(6)
  updated_by                                                                              String?                     @db.Uuid
  actual_start                                                                            DateTime?                   @db.Timestamptz(6)
  actual_end                                                                              DateTime?                   @db.Timestamptz(6)
  maintenance_category                                                                    String?                     @db.VarChar(20)
  priority                                                                                String?                     @db.VarChar(20)
  regulatory_requirement                                                                  Boolean?                    @default(false)
  blocking_vehicle                                                                        Boolean?                    @default(false)
  warranty_covered                                                                        Boolean?                    @default(false)
  warranty_claim_number                                                                   String?
  warranty_amount                                                                         Decimal?                    @db.Decimal(18, 2)
  insurance_covered                                                                       Boolean?                    @default(false)
  insurance_claim_ref                                                                     String?
  requested_by                                                                            String?                     @db.Uuid
  requested_at                                                                            DateTime?                   @db.Timestamptz(6)
  approved_by                                                                             String?                     @db.Uuid
  approved_at                                                                             DateTime?                   @db.Timestamptz(6)
  approval_notes                                                                          String?
  labor_hours                                                                             Decimal?                    @db.Decimal(8, 2)
  labor_rate                                                                              Decimal?                    @db.Decimal(18, 2)
  labor_cost                                                                              Decimal?                    @db.Decimal(18, 2)
  parts_cost                                                                              Decimal?                    @db.Decimal(18, 2)
  other_costs                                                                             Decimal?                    @db.Decimal(18, 2)
  tax_amount                                                                              Decimal?                    @db.Decimal(18, 2)
  total_cost_excl_tax                                                                     Decimal?                    @db.Decimal(18, 2)
  total_cost_incl_tax                                                                     Decimal?                    @db.Decimal(18, 2)
  parts_detail                                                                            Json?
  garage_id                                                                               String?                     @db.Uuid
  work_order_number                                                                       String?
  mechanic_name                                                                           String?
  mechanic_certification                                                                  String?
  quality_check_by                                                                        String?                     @db.Uuid
  quality_check_at                                                                        DateTime?                   @db.Timestamptz(6)
  blocked_periods                                                                         Json?
  deleted_at                                                                              DateTime?                   @db.Timestamptz(6)
  deleted_by                                                                              String?                     @db.Uuid
  deletion_reason                                                                         String?
  ek77mtf      adm_provider_employees?     @relation("E_4xd4dm", fields: [approved_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_maintenance_approved_by")
  earyyzc       adm_provider_employees?     @relation("E_gu959h", fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_maintenance_created_by")
  e3lilzb       adm_provider_employees?     @relation("E_9nss9g", fields: [deleted_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_maintenance_deleted_by")
  eg5mjd4 adm_provider_employees?     @relation("E_r9hat7", fields: [quality_check_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_maintenance_quality_check_by")
  e5m17rm     adm_provider_employees?     @relation("E_80eefz", fields: [requested_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_maintenance_requested_by")
  adm_tenants                                                                             adm_tenants                 @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_flt_vehicle_maintenance_tenant_id")
  e4nsyl7       adm_provider_employees?     @relation("E_1eh7oy", fields: [updated_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_maintenance_updated_by")
  flt_vehicles                                                                            flt_vehicles                @relation(fields: [vehicle_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicle_maintenance_vehicle_id")
  mwrijny                             clt_members?                @relation("M_4i9ics", fields: [created_by], references: [id])
  moheerf                             clt_members?                @relation("M_csdn9b", fields: [updated_by], references: [id])
  sch_maintenance_schedules                                                               sch_maintenance_schedules[]

  @@index([created_at(sort: Desc)])
  @@index([created_by])
  @@index([maintenance_type])
  @@index([metadata], type: Gin)
  @@index([scheduled_date], map: "flt_vehicle_maintenance_scheduled_date_active_idx")
  @@index([status], map: "flt_vehicle_maintenance_status_active_idx")
  @@index([tenant_id])
  @@index([updated_by])
  @@index([vehicle_id])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model flt_vehicles {
  id                                                                     String                      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                              String                      @db.Uuid
  make_id                                                                String                      @db.Uuid
  model_id                                                               String                      @db.Uuid
  license_plate                                                          String
  vin                                                                    String?
  year                                                                   Int
  color                                                                  String?
  seats                                                                  Int                         @default(4)
  vehicle_class                                                          String?
  fuel_type                                                              String?
  transmission                                                           String?
  registration_date                                                      DateTime?                   @db.Date
  insurance_number                                                       String?
  insurance_expiry                                                       DateTime?                   @db.Date
  last_inspection                                                        DateTime?                   @db.Date
  next_inspection                                                        DateTime?                   @db.Date
  odometer                                                               Int?
  ownership_type                                                         String                      @default("owned")
  metadata                                                               Json                        @default("{}")
  status                                                                 String                      @default("pending")
  created_at                                                             DateTime                    @default(now()) @db.Timestamptz(6)
  created_by                                                             String?                     @db.Uuid
  updated_at                                                             DateTime                    @default(now()) @db.Timestamptz(6)
  updated_by                                                             String?                     @db.Uuid
  deleted_at                                                             DateTime?                   @db.Timestamptz(6)
  deleted_by                                                             String?                     @db.Uuid
  deletion_reason                                                        String?
  country_code                                                           String?                     @db.Char(2)
  requires_professional_license                                          Boolean?                    @default(false)
  documents_status                                                       Json?
  body_type                                                              String?                     @db.VarChar(20)
  passenger_capacity                                                     Int?
  car_length_cm                                                          Int?
  car_width_cm                                                           Int?
  car_height_cm                                                          Int?
  vehicle_class_id                                                       String?                     @db.Uuid
  first_registration_date                                                DateTime?                   @db.Date
  warranty_expiry                                                        DateTime?                   @db.Date
  service_interval_km                                                    Int?
  next_service_at_km                                                     Int?
  insurance_policy_number                                                String?
  insurance_coverage_type                                                String?
  insurance_amount                                                       Decimal?                    @db.Decimal(18, 2)
  insurance_issue_date                                                   DateTime?                   @db.Date
  ownership_type_id                                                      String?                     @db.Uuid
  owner_id                                                               String?                     @db.Uuid
  acquisition_date                                                       DateTime?                   @db.Date
  lease_end_date                                                         DateTime?                   @db.Date
  residual_value                                                         Decimal?                    @db.Decimal(18, 2)
  status_id                                                              String?                     @db.Uuid
  status_changed_at                                                      DateTime?                   @db.Timestamptz(6)
  fin_toll_transactions                                                  fin_toll_transactions[]
  fin_traffic_fines                                                      fin_traffic_fines[]
  flt_vehicle_assignments                                                flt_vehicle_assignments[]
  flt_vehicle_equipments                                                 flt_vehicle_equipments[]
  flt_vehicle_events                                                     flt_vehicle_events[]
  flt_vehicle_expenses                                                   flt_vehicle_expenses[]
  flt_vehicle_inspections                                                flt_vehicle_inspections[]
  flt_vehicle_insurances                                                 flt_vehicle_insurances[]
  flt_vehicle_maintenance                                                flt_vehicle_maintenance[]
  dir_country_regulations                                                dir_country_regulations?    @relation(fields: [country_code], references: [country_code], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicles_country_code")
  euhl93 adm_provider_employees?     @relation("E_vrui2s", fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicles_created_by")
  e80xy94 adm_provider_employees?     @relation("E_w2t6wb", fields: [deleted_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicles_deleted_by")
  dir_car_makes                                                          dir_car_makes               @relation(fields: [make_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicles_make_id")
  dir_car_models                                                         dir_car_models              @relation(fields: [model_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicles_model_id")
  dir_ownership_types                                                    dir_ownership_types?        @relation(fields: [ownership_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicles_ownership_type_id")
  dir_vehicle_statuses                                                   dir_vehicle_statuses?       @relation(fields: [status_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicles_status_id")
  adm_tenants                                                            adm_tenants                 @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_flt_vehicles_tenant_id")
  ega9itm adm_provider_employees?     @relation("E_nthmbt", fields: [updated_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicles_updated_by")
  dir_vehicle_classes                                                    dir_vehicle_classes?        @relation(fields: [vehicle_class_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_flt_vehicles_vehicle_class_id")
  mueoscx                       clt_members?                @relation("M_5i2lxn", fields: [created_by], references: [id])
  mern8g                       clt_members?                @relation("M_ohuj6u", fields: [deleted_by], references: [id])
  mm4knge                       clt_members?                @relation("M_2s1iyw", fields: [updated_by], references: [id])
  sch_maintenance_schedules                                              sch_maintenance_schedules[]
  trp_trips                                                              trp_trips[]

  @@index([created_by])
  @@index([deleted_at])
  @@index([license_plate])
  @@index([make_id])
  @@index([metadata], type: Gin)
  @@index([model_id])
  @@index([next_inspection])
  @@index([tenant_id])
  @@index([updated_by])
  @@index([vin])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model rev_driver_revenues {
  id                                                        String                      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                 String                      @db.Uuid
  driver_id                                                 String                      @db.Uuid
  period_start                                              DateTime                    @db.Date
  period_end                                                DateTime                    @db.Date
  total_revenue                                             Decimal                     @default(0) @db.Decimal(18, 2)
  commission_amount                                         Decimal                     @default(0) @db.Decimal(18, 2)
  net_revenue                                               Decimal                     @default(0) @db.Decimal(18, 2)
  metadata                                                  Json                        @default("{}")
  created_at                                                DateTime                    @default(now()) @db.Timestamptz(6)
  created_by                                                String?                     @db.Uuid
  updated_at                                                DateTime                    @default(now()) @db.Timestamptz(6)
  updated_by                                                String?                     @db.Uuid
  deleted_at                                                DateTime?                   @db.Timestamptz(6)
  deleted_by                                                String?                     @db.Uuid
  deletion_reason                                           String?
  platform_id                                               String?                     @db.Uuid
  period_type                                               driver_revenue_period_type?
  currency                                                  String?                     @db.Char(3)
  import_id                                                 String?                     @db.Uuid
  status                                                    driver_revenue_status       @default(pending)
  validated_by                                              String?                     @db.Uuid
  validated_at                                              DateTime?                   @db.Timestamptz(6)
  adjustment_reason                                         String?
  mq42rlh   clt_members?                @relation("M_sil6z5", fields: [created_by], references: [id], map: "fk_rev_driver_revenues_created_by")
  mex4596   clt_members?                @relation("M_1hby5c", fields: [deleted_by], references: [id], map: "fk_rev_driver_revenues_deleted_by")
  rid_drivers                                               rid_drivers                 @relation(fields: [driver_id], references: [id], map: "fk_rev_driver_revenues_driver")
  rev_revenue_imports                                       rev_revenue_imports?        @relation(fields: [import_id], references: [id], onDelete: Restrict, map: "fk_rev_driver_revenues_import")
  dir_platforms                                             dir_platforms?              @relation(fields: [platform_id], references: [id], onDelete: Restrict, map: "fk_rev_driver_revenues_platform")
  adm_tenants                                               adm_tenants                 @relation(fields: [tenant_id], references: [id], onDelete: Cascade, map: "fk_rev_driver_revenues_tenant")
  mye6wi0   clt_members?                @relation("M_k8h22m", fields: [updated_by], references: [id], map: "fk_rev_driver_revenues_updated_by")
  mrn8t97 clt_members?                @relation("M_kfvgt1", fields: [validated_by], references: [id], map: "fk_rev_driver_revenues_validated_by")

  @@index([created_by])
  @@index([deleted_at])
  @@index([driver_id])
  @@index([metadata], type: Gin)
  @@index([period_end(sort: Desc)])
  @@index([period_start(sort: Desc)])
  @@index([tenant_id])
  @@index([updated_by])
}

model rev_reconciliation_lines {
  id                  String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  reconciliation_id   String              @db.Uuid
  driver_id           String?             @db.Uuid
  platform_id         String?             @db.Uuid
  expected_amount     Decimal             @db.Decimal(18, 2)
  received_amount     Decimal             @db.Decimal(18, 2)
  notes               String?
  metadata            Json?               @default("{}")
  rid_drivers         rid_drivers?        @relation(fields: [driver_id], references: [id], onDelete: Restrict, map: "fk_rev_reconciliation_lines_driver")
  dir_platforms       dir_platforms?      @relation(fields: [platform_id], references: [id], onDelete: Restrict, map: "fk_rev_reconciliation_lines_platform")
  rev_reconciliations rev_reconciliations @relation(fields: [reconciliation_id], references: [id], onDelete: Cascade, map: "fk_rev_reconciliation_lines_reconciliation")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model rev_reconciliations {
  id                                                       String                     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                String                     @db.Uuid
  import_id                                                String                     @db.Uuid
  reconciliation_date                                      DateTime                   @db.Date
  status                                                   String                     @default("pending")
  notes                                                    String?
  metadata                                                 Json                       @default("{}")
  created_at                                               DateTime                   @default(now()) @db.Timestamptz(6)
  created_by                                               String?                    @db.Uuid
  updated_at                                               DateTime                   @default(now()) @db.Timestamptz(6)
  updated_by                                               String?                    @db.Uuid
  deleted_at                                               DateTime?                  @db.Timestamptz(6)
  deleted_by                                               String?                    @db.Uuid
  deletion_reason                                          String?
  reconciliation_type                                      reconciliation_type?
  expected_amount                                          Decimal?                   @db.Decimal(18, 2)
  received_amount                                          Decimal?                   @db.Decimal(18, 2)
  tolerance_amount                                         Decimal?                   @db.Decimal(18, 2)
  currency                                                 String?                    @db.Char(3)
  auto_matched                                             Boolean?                   @default(false)
  assigned_to                                              String?                    @db.Uuid
  resolved_at                                              DateTime?                  @db.Timestamptz(6)
  resolved_by                                              String?                    @db.Uuid
  resolution_notes                                         String?
  requires_action                                          Boolean?                   @default(false)
  driver_id                                                String?                    @db.Uuid
  rev_reconciliation_lines                                 rev_reconciliation_lines[]
  mqr0wsj clt_members?               @relation("M_x20liv", fields: [assigned_to], references: [id], map: "fk_rev_reconciliations_assigned_to")
  mhj1tef  clt_members?               @relation("M_xxhwsx", fields: [created_by], references: [id], map: "fk_rev_reconciliations_created_by")
  mni53g8  clt_members?               @relation("M_73p01q", fields: [deleted_by], references: [id], map: "fk_rev_reconciliations_deleted_by")
  rid_drivers                                              rid_drivers?               @relation(fields: [driver_id], references: [id], onDelete: Restrict, map: "fk_rev_reconciliations_driver")
  rev_revenue_imports                                      rev_revenue_imports        @relation(fields: [import_id], references: [id], map: "fk_rev_reconciliations_import")
  mducnqn clt_members?               @relation("M_2ma42x", fields: [resolved_by], references: [id], map: "fk_rev_reconciliations_resolved_by")
  adm_tenants                                              adm_tenants                @relation(fields: [tenant_id], references: [id], onDelete: Cascade, map: "fk_rev_reconciliations_tenant")
  mpt5yay  clt_members?               @relation("M_sti09o", fields: [updated_by], references: [id], map: "fk_rev_reconciliations_updated_by")
  trp_settlements                                          trp_settlements[]

  @@index([created_by])
  @@index([deleted_at])
  @@index([import_id])
  @@index([metadata], type: Gin)
  @@index([reconciliation_date(sort: Desc)])
  @@index([tenant_id])
  @@index([updated_by])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model rev_revenue_imports {
  id                                                      String                      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                               String                      @db.Uuid
  import_reference                                        String
  import_date                                             DateTime                    @db.Date
  status                                                  String                      @default("pending")
  total_revenue                                           Decimal                     @default(0) @db.Decimal(18, 2)
  currency                                                String                      @db.VarChar(3)
  metadata                                                Json                        @default("{}")
  created_at                                              DateTime                    @default(now()) @db.Timestamptz(6)
  created_by                                              String?                     @db.Uuid
  updated_at                                              DateTime                    @default(now()) @db.Timestamptz(6)
  updated_by                                              String?                     @db.Uuid
  deleted_at                                              DateTime?                   @db.Timestamptz(6)
  deleted_by                                              String?                     @db.Uuid
  deletion_reason                                         String?
  platform_id                                             String?                     @db.Uuid
  source_type                                             revenue_import_source_type?
  file_url                                                String?
  source_currency                                         String?                     @db.Char(3)
  exchange_rate                                           Decimal?                    @db.Decimal(12, 6)
  converted_amount                                        Decimal?                    @db.Decimal(18, 2)
  rows_count                                              Int?                        @default(0)
  errors_count                                            Int?                        @default(0)
  warnings_count                                          Int?                        @default(0)
  processing_started_at                                   DateTime?                   @db.Timestamptz(6)
  processing_completed_at                                 DateTime?                   @db.Timestamptz(6)
  status_reason                                           String?
  retry_count                                             Int?                        @default(0)
  last_error                                              String?
  rev_driver_revenues                                     rev_driver_revenues[]
  rev_reconciliations                                     rev_reconciliations[]
  mn4oz1u clt_members?                @relation("M_vhyzis", fields: [created_by], references: [id], map: "fk_rev_revenue_imports_created_by")
  mhwhxst clt_members?                @relation("M_1i1ueb", fields: [deleted_by], references: [id], map: "fk_rev_revenue_imports_deleted_by")
  dir_platforms                                           dir_platforms?              @relation(fields: [platform_id], references: [id], onDelete: Restrict, map: "fk_rev_revenue_imports_platform")
  adm_tenants                                             adm_tenants                 @relation(fields: [tenant_id], references: [id], onDelete: Cascade, map: "fk_rev_revenue_imports_tenant")
  mvet3yd clt_members?                @relation("M_n7uum9", fields: [updated_by], references: [id], map: "fk_rev_revenue_imports_updated_by")

  @@index([created_by])
  @@index([deleted_at])
  @@index([import_date(sort: Desc)])
  @@index([metadata], type: Gin)
  @@index([tenant_id])
  @@index([updated_by])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model rid_driver_blacklists {
  id                                                                String              @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                         String              @db.Uuid
  driver_id                                                         String              @db.Uuid
  reason                                                            String
  start_date                                                        DateTime            @db.Timestamptz(6)
  end_date                                                          DateTime?           @db.Timestamptz(6)
  metadata                                                          Json                @default("{}")
  created_at                                                        DateTime            @default(now()) @db.Timestamptz(6)
  created_by                                                        String?             @db.Uuid
  updated_at                                                        DateTime            @default(now()) @db.Timestamptz(6)
  updated_by                                                        String?             @db.Uuid
  deleted_at                                                        DateTime?           @db.Timestamptz(6)
  deleted_by                                                        String?             @db.Uuid
  deletion_reason                                                   String?
  category                                                          blacklist_category?
  severity                                                          blacklist_severity?
  status                                                            blacklist_status?   @default(active)
  incident_date                                                     DateTime?           @db.Timestamptz(6)
  incident_location                                                 String?
  incident_description                                              String?
  evidence_documents                                                Json?               @default("[]")
  decided_by                                                        String?             @db.Uuid
  decided_at                                                        DateTime?           @db.Timestamptz(6)
  decision_notes                                                    String?
  decision_reviewed                                                 Boolean?            @default(false)
  reviewed_by                                                       String?             @db.Uuid
  reviewed_at                                                       DateTime?           @db.Timestamptz(6)
  appeal_status                                                     appeal_status?      @default(not_applicable)
  appeal_submitted_at                                               DateTime?           @db.Timestamptz(6)
  appeal_reason                                                     String?
  appeal_reviewed_at                                                DateTime?           @db.Timestamptz(6)
  appeal_reviewed_by                                                String?             @db.Uuid
  appeal_decision                                                   String?
  appeal_outcome                                                    String?             @db.VarChar(50)
  legal_review_required                                             Boolean?            @default(false)
  legal_reviewed_at                                                 DateTime?           @db.Timestamptz(6)
  legal_reviewed_by                                                 String?             @db.Uuid
  legal_case_number                                                 String?             @db.VarChar(100)
  legal_notes                                                       String?
  reinstatement_conditions                                          String?
  reinstatement_eligible_date                                       DateTime?           @db.Date
  reinstated_at                                                     DateTime?           @db.Timestamptz(6)
  reinstated_by                                                     String?             @db.Uuid
  driver_notified_at                                                DateTime?           @db.Timestamptz(6)
  notification_method                                               String?             @db.VarChar(50)
  acknowledgment_received                                           Boolean?            @default(false)
  acknowledgment_date                                               DateTime?           @db.Timestamptz(6)
  mf4upq5 clt_members?        @relation("M_jegzb", fields: [appeal_reviewed_by], references: [id], onUpdate: NoAction)
  mks3nk2         clt_members?        @relation("M_rzh008", fields: [created_by], references: [id])
  mw3wufm         clt_members?        @relation("M_owjhzg", fields: [decided_by], references: [id], onUpdate: NoAction)
  mbm7cc7        clt_members?        @relation("M_lvcwc1", fields: [reviewed_by], references: [id], onUpdate: NoAction, map: "rid_driver_blacklists_decision_reviewed_by_fkey")
  m97thkf         clt_members?        @relation("M_20g549", fields: [deleted_by], references: [id])
  rid_drivers                                                       rid_drivers         @relation(fields: [driver_id], references: [id], onDelete: Cascade)
  m68504x  clt_members?        @relation("M_pdqhw5", fields: [legal_reviewed_by], references: [id], onUpdate: NoAction)
  mizdskd      clt_members?        @relation("M_x4dee5", fields: [reinstated_by], references: [id], onUpdate: NoAction)
  adm_tenants                                                       adm_tenants         @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  mchzinj         clt_members?        @relation("M_jpcv3p", fields: [updated_by], references: [id])

  @@index([created_by])
  @@index([deleted_at])
  @@index([driver_id])
  @@index([end_date])
  @@index([metadata], map: "rid_driver_blacklists_metadata_gin", type: Gin)
  @@index([start_date])
  @@index([tenant_id])
  @@index([updated_by])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model rid_driver_cooperation_terms {
  id                                                                             String                         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                      String                         @db.Uuid
  driver_id                                                                      String                         @db.Uuid
  terms_version                                                                  String
  accepted_at                                                                    DateTime?                      @db.Timestamptz(6)
  effective_date                                                                 DateTime?                      @db.Date
  expiry_date                                                                    DateTime?                      @db.Date
  metadata                                                                       Json                           @default("{}")
  created_at                                                                     DateTime                       @default(now()) @db.Timestamptz(6)
  created_by                                                                     String?                        @db.Uuid
  updated_at                                                                     DateTime                       @default(now()) @db.Timestamptz(6)
  updated_by                                                                     String?                        @db.Uuid
  deleted_at                                                                     DateTime?                      @db.Timestamptz(6)
  deleted_by                                                                     String?                        @db.Uuid
  deletion_reason                                                                String?
  status                                                                         cooperation_status?            @default(pending)
  compensation_model                                                             compensation_model?
  fixed_rental_amount                                                            Decimal?                       @db.Decimal(12, 2)
  percentage_split_company                                                       Decimal?                       @db.Decimal(5, 2)
  percentage_split_driver                                                        Decimal?                       @db.Decimal(5, 2)
  salary_amount                                                                  Decimal?                       @db.Decimal(12, 2)
  crew_rental_terms                                                              String?
  buyout_amount                                                                  Decimal?                       @db.Decimal(12, 2)
  custom_terms                                                                   String?
  signature_method                                                               signature_method?
  signature_data                                                                 Json?
  signature_ip                                                                   String?                        @db.VarChar(45)
  signature_timestamp                                                            DateTime?                      @db.Timestamptz(6)
  digital_signature_verified                                                     Boolean?                       @default(false)
  previous_version_id                                                            String?                        @db.Uuid
  version_change_reason                                                          String?
  legal_review_required                                                          Boolean?                       @default(false)
  legal_reviewed_at                                                              DateTime?                      @db.Timestamptz(6)
  legal_reviewed_by                                                              String?                        @db.Uuid
  legal_review_notes                                                             String?
  auto_renewal                                                                   Boolean?                       @default(false)
  auto_renewal_notice_days                                                       Int?                           @default(30)
  renewal_reminder_sent_at                                                       DateTime?                      @db.Timestamptz(6)
  termination_date                                                               DateTime?                      @db.Timestamptz(6)
  termination_reason                                                             String?
  termination_initiated_by                                                       String?                        @db.Uuid
  early_termination_penalty                                                      Decimal?                       @db.Decimal(12, 2)
  mujj7md               clt_members?                   @relation("M_8vpcbp", fields: [created_by], references: [id])
  mahnp8a               clt_members?                   @relation("M_l47sss", fields: [deleted_by], references: [id])
  rid_drivers                                                                    rid_drivers                    @relation(fields: [driver_id], references: [id], onDelete: Cascade)
  mgnlqs8        clt_members?                   @relation("M_3tku7i", fields: [legal_reviewed_by], references: [id], onUpdate: NoAction)
  rid_driver_cooperation_terms                                                   rid_driver_cooperation_terms?  @relation("X_mngod3", fields: [previous_version_id], references: [id], onUpdate: NoAction, map: "rid_driver_cooperation_terms_previous_version_fkey")
  other_rid_driver_cooperation_terms                                             rid_driver_cooperation_terms[] @relation("X_mngod3")
  adm_tenants                                                                    adm_tenants                    @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  mbcvvfn clt_members?                   @relation("M_hi3n19", fields: [termination_initiated_by], references: [id], onUpdate: NoAction, map: "rid_driver_cooperation_terms_termination_by_fkey")
  mw7gpg8               clt_members?                   @relation("M_ll7f6", fields: [updated_by], references: [id])

  @@index([accepted_at])
  @@index([created_by])
  @@index([deleted_at])
  @@index([driver_id])
  @@index([effective_date])
  @@index([expiry_date])
  @@index([metadata], map: "rid_driver_cooperation_terms_metadata_gin", type: Gin)
  @@index([tenant_id])
  @@index([terms_version])
  @@index([updated_by])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model rid_driver_documents {
  id                                                        String                        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                 String                        @db.Uuid
  driver_id                                                 String                        @db.Uuid
  document_id                                               String                        @db.Uuid
  expiry_date                                               DateTime?                     @db.Date
  verified                                                  Boolean                       @default(false)
  verified_by                                               String?                       @db.Uuid
  verified_at                                               DateTime?                     @db.Timestamptz(6)
  created_at                                                DateTime                      @default(now()) @db.Timestamptz(6)
  created_by                                                String?                       @db.Uuid
  updated_at                                                DateTime                      @default(now()) @db.Timestamptz(6)
  updated_by                                                String?                       @db.Uuid
  deleted_at                                                DateTime?                     @db.Timestamptz(6)
  deleted_by                                                String?                       @db.Uuid
  deletion_reason                                           String?
  document_type                                             driver_document_type?
  requires_renewal                                          Boolean?                      @default(true)
  renewal_frequency_days                                    Int?
  reminder_sent_at                                          DateTime?                     @db.Timestamptz(6)
  reminder_days_before                                      Int?                          @default(30)
  verification_status                                       document_verification_status? @default(pending)
  rejection_reason                                          String?
  verification_method                                       String?                       @db.VarChar(50)
  document_number                                           String?                       @db.VarChar(100)
  issuing_authority                                         String?                       @db.VarChar(255)
  issuing_country                                           String?                       @db.Char(2)
  issue_date                                                DateTime?                     @db.Date
  replaced_document_id                                      String?                       @db.Uuid
  replacement_reason                                        String?
  ocr_data                                                  Json?
  confidence_score                                          Decimal?                      @db.Decimal(5, 2)
  mcwkhiu  clt_members?                  @relation("M_1ohxv4", fields: [created_by], references: [id])
  mh3cnln  clt_members?                  @relation("M_sbf79d", fields: [deleted_by], references: [id])
  doc_documents                                             doc_documents                 @relation(fields: [document_id], references: [id], onDelete: Cascade)
  rid_drivers                                               rid_drivers                   @relation(fields: [driver_id], references: [id], onDelete: Cascade)
  rid_driver_documents                                      rid_driver_documents?         @relation("X_bn441r", fields: [replaced_document_id], references: [id], onUpdate: NoAction, map: "rid_driver_documents_replaced_document_fkey")
  other_rid_driver_documents                                rid_driver_documents[]        @relation("X_bn441r")
  adm_tenants                                               adm_tenants                   @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  m4mgcmb  clt_members?                  @relation("M_6lm71f", fields: [updated_by], references: [id])
  mgk2wc2 clt_members?                  @relation("M_nrg8s8", fields: [verified_by], references: [id])

  @@index([created_by])
  @@index([deleted_at])
  @@index([document_id])
  @@index([driver_id])
  @@index([expiry_date])
  @@index([tenant_id])
  @@index([updated_by])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model rid_driver_languages {
  id                                                       String       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                String       @db.Uuid
  driver_id                                                String       @db.Uuid
  language_code                                            String       @db.Char(2)
  proficiency                                              String?
  created_at                                               DateTime     @default(now()) @db.Timestamptz(6)
  created_by                                               String?      @db.Uuid
  updated_at                                               DateTime     @default(now()) @db.Timestamptz(6)
  updated_by                                               String?      @db.Uuid
  deleted_at                                               DateTime?    @db.Timestamptz(6)
  deleted_by                                               String?      @db.Uuid
  deletion_reason                                          String?
  m18a5kd clt_members? @relation("M_cgcp83", fields: [created_by], references: [id])
  mv87aou clt_members? @relation("M_sku7mk", fields: [deleted_by], references: [id])
  rid_drivers                                              rid_drivers  @relation(fields: [driver_id], references: [id], onDelete: Cascade)
  adm_tenants                                              adm_tenants  @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  m9ieagw clt_members? @relation("M_kqgu4m", fields: [updated_by], references: [id])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model rid_driver_performances {
  id                                                          String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                   String         @db.Uuid
  driver_id                                                   String         @db.Uuid
  period_start                                                DateTime       @db.Date
  period_end                                                  DateTime       @db.Date
  trips_completed                                             Int            @default(0)
  trips_cancelled                                             Int            @default(0)
  on_time_rate                                                Decimal?       @db.Decimal(5, 2)
  avg_rating                                                  Decimal?       @db.Decimal(3, 2)
  incidents_count                                             Int            @default(0)
  earnings_total                                              Decimal        @default(0) @db.Decimal(12, 2)
  hours_online                                                Decimal?       @db.Decimal(7, 2)
  metadata                                                    Json           @default("{}")
  created_at                                                  DateTime       @default(now()) @db.Timestamptz(6)
  created_by                                                  String?        @db.Uuid
  updated_at                                                  DateTime       @default(now()) @db.Timestamptz(6)
  updated_by                                                  String?        @db.Uuid
  deleted_at                                                  DateTime?      @db.Timestamptz(6)
  deleted_by                                                  String?        @db.Uuid
  deletion_reason                                             String?
  platform_id                                                 String?        @db.Uuid
  platform_trips_completed                                    Int?           @default(0)
  platform_earnings                                           Decimal?       @default(0) @db.Decimal(12, 2)
  cash_trips                                                  Int?           @default(0)
  cash_earnings                                               Decimal?       @default(0) @db.Decimal(12, 2)
  card_trips                                                  Int?           @default(0)
  card_earnings                                               Decimal?       @default(0) @db.Decimal(12, 2)
  wallet_trips                                                Int?           @default(0)
  wallet_earnings                                             Decimal?       @default(0) @db.Decimal(12, 2)
  mixed_payment_trips                                         Int?           @default(0)
  rank_in_period                                              Int?
  tier                                                        String?        @db.VarChar(20)
  tier_change                                                 String?        @db.VarChar(10)
  acceptance_rate                                             Decimal?       @db.Decimal(5, 2)
  cancellation_rate                                           Decimal?       @db.Decimal(5, 2)
  completion_rate                                             Decimal?       @db.Decimal(5, 2)
  avg_trip_duration_minutes                                   Decimal?       @db.Decimal(7, 2)
  avg_earnings_per_trip                                       Decimal?       @db.Decimal(10, 2)
  avg_earnings_per_hour                                       Decimal?       @db.Decimal(10, 2)
  total_ratings_received                                      Int?           @default(0)
  five_star_ratings                                           Int?           @default(0)
  one_star_ratings                                            Int?           @default(0)
  compliments_received                                        Int?           @default(0)
  complaints_received                                         Int?           @default(0)
  total_fuel_cost                                             Decimal?       @default(0) @db.Decimal(12, 2)
  total_expenses                                              Decimal?       @default(0) @db.Decimal(12, 2)
  net_earnings                                                Decimal?       @default(0) @db.Decimal(12, 2)
  bonus_earned                                                Decimal?       @default(0) @db.Decimal(12, 2)
  incentives_earned                                           Decimal?       @default(0) @db.Decimal(12, 2)
  penalties_deducted                                          Decimal?       @default(0) @db.Decimal(12, 2)
  total_distance_km                                           Decimal?       @default(0) @db.Decimal(10, 2)
  hours_logged                                                Decimal?       @db.Decimal(7, 2)
  mfk3n2j clt_members?   @relation("M_i78cvv", fields: [created_by], references: [id])
  mph39s4 clt_members?   @relation("M_bsos8m", fields: [deleted_by], references: [id])
  rid_drivers                                                 rid_drivers    @relation(fields: [driver_id], references: [id], onDelete: Cascade)
  dir_platforms                                               dir_platforms? @relation(fields: [platform_id], references: [id], onUpdate: NoAction)
  adm_tenants                                                 adm_tenants    @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  mnu7rz2 clt_members?   @relation("M_9x47zc", fields: [updated_by], references: [id])

  @@index([created_by])
  @@index([deleted_at])
  @@index([driver_id])
  @@index([metadata], map: "rid_driver_performances_metadata_gin", type: Gin)
  @@index([period_end])
  @@index([period_start])
  @@index([tenant_id])
  @@index([updated_by])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model rid_driver_requests {
  id                                                               String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                        String               @db.Uuid
  driver_id                                                        String               @db.Uuid
  request_date                                                     DateTime             @db.Date
  details                                                          Json                 @default("{}")
  resolution_notes                                                 String?
  created_at                                                       DateTime             @default(now()) @db.Timestamptz(6)
  created_by                                                       String?              @db.Uuid
  updated_at                                                       DateTime             @default(now()) @db.Timestamptz(6)
  updated_by                                                       String?              @db.Uuid
  deleted_at                                                       DateTime?            @db.Timestamptz(6)
  deleted_by                                                       String?              @db.Uuid
  deletion_reason                                                  String?
  request_type                                                     driver_request_type?
  status                                                           request_status?      @default(pending)
  priority                                                         request_priority?    @default(normal)
  sla_deadline                                                     DateTime?            @db.Timestamptz(6)
  sla_breached                                                     Boolean?             @default(false)
  response_required_by                                             DateTime?            @db.Timestamptz(6)
  assigned_to                                                      String?              @db.Uuid
  assigned_at                                                      DateTime?            @db.Timestamptz(6)
  review_started_at                                                DateTime?            @db.Timestamptz(6)
  reviewed_by                                                      String?              @db.Uuid
  approved_at                                                      DateTime?            @db.Timestamptz(6)
  approved_by                                                      String?              @db.Uuid
  rejected_at                                                      DateTime?            @db.Timestamptz(6)
  rejected_by                                                      String?              @db.Uuid
  rejection_reason                                                 String?
  completed_at                                                     DateTime?            @db.Timestamptz(6)
  escalated                                                        Boolean?             @default(false)
  escalated_at                                                     DateTime?            @db.Timestamptz(6)
  escalated_to                                                     String?              @db.Uuid
  escalation_reason                                                String?
  requires_manager_approval                                        Boolean?             @default(false)
  manager_approved_at                                              DateTime?            @db.Timestamptz(6)
  manager_approved_by                                              String?              @db.Uuid
  requires_hr_approval                                             Boolean?             @default(false)
  hr_approved_at                                                   DateTime?            @db.Timestamptz(6)
  hr_approved_by                                                   String?              @db.Uuid
  driver_notified_at                                               DateTime?            @db.Timestamptz(6)
  manager_notified_at                                              DateTime?            @db.Timestamptz(6)
  notification_method                                              String?              @db.VarChar(50)
  attachments                                                      Json?                @default("[]")
  mrs6uz         clt_members?         @relation("M_bzuqip", fields: [approved_by], references: [id], onUpdate: NoAction)
  mb47aoi         clt_members?         @relation("M_3v8z8", fields: [assigned_to], references: [id], onUpdate: NoAction)
  mph0wwc          clt_members?         @relation("M_t5n1oa", fields: [created_by], references: [id])
  mfk5zyb          clt_members?         @relation("M_ua3g7", fields: [deleted_by], references: [id])
  rid_drivers                                                      rid_drivers          @relation(fields: [driver_id], references: [id], onDelete: Cascade)
  mi74nf2        clt_members?         @relation("M_pehzv8", fields: [escalated_to], references: [id], onUpdate: NoAction)
  mmvvhtc      clt_members?         @relation("M_avgi52", fields: [hr_approved_by], references: [id], onUpdate: NoAction)
  meebnqr clt_members?         @relation("M_h7juab", fields: [manager_approved_by], references: [id], onUpdate: NoAction)
  mlch9xe         clt_members?         @relation("M_wkjtl4", fields: [rejected_by], references: [id], onUpdate: NoAction)
  m1mh69n         clt_members?         @relation("M_cujpxd", fields: [reviewed_by], references: [id], onUpdate: NoAction)
  adm_tenants                                                      adm_tenants          @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  mxr51sv          clt_members?         @relation("M_kviwrr", fields: [updated_by], references: [id])

  @@index([created_by])
  @@index([deleted_at])
  @@index([details], map: "rid_driver_requests_details_gin", type: Gin)
  @@index([driver_id])
  @@index([request_date])
  @@index([tenant_id])
  @@index([updated_by])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model rid_driver_training {
  id                                                        String                  @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                 String                  @db.Uuid
  driver_id                                                 String                  @db.Uuid
  training_name                                             String
  provider                                                  String?
  assigned_at                                               DateTime?               @db.Timestamptz(6)
  due_at                                                    DateTime?               @db.Timestamptz(6)
  completed_at                                              DateTime?               @db.Timestamptz(6)
  score                                                     Decimal?                @db.Decimal(5, 2)
  certificate_url                                           String?
  metadata                                                  Json                    @default("{}")
  created_at                                                DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                                String?                 @db.Uuid
  updated_at                                                DateTime                @default(now()) @db.Timestamptz(6)
  updated_by                                                String?                 @db.Uuid
  deleted_at                                                DateTime?               @db.Timestamptz(6)
  deleted_by                                                String?                 @db.Uuid
  deletion_reason                                           String?
  training_type                                             training_type?
  status                                                    training_status?        @default(planned)
  provider_type                                             provider_type?
  provider_id                                               String?                 @db.Uuid
  provider_contact                                          String?                 @db.VarChar(255)
  provider_location                                         String?
  description                                               String?
  duration_hours                                            Decimal?                @db.Decimal(5, 2)
  total_sessions                                            Int?                    @default(1)
  sessions_completed                                        Int?                    @default(0)
  materials_url                                             String?
  prerequisites_met                                         Boolean?                @default(true)
  prerequisite_training_ids                                 Json?                   @default("[]")
  prerequisite_documents                                    Json?                   @default("[]")
  scheduled_start                                           DateTime?               @db.Timestamptz(6)
  scheduled_end                                             DateTime?               @db.Timestamptz(6)
  actual_start                                              DateTime?               @db.Timestamptz(6)
  actual_end                                                DateTime?               @db.Timestamptz(6)
  location                                                  String?
  online_meeting_url                                        String?
  attendance_percentage                                     Decimal?                @db.Decimal(5, 2)
  absences_count                                            Int?                    @default(0)
  late_arrivals_count                                       Int?                    @default(0)
  evaluation_method                                         String?                 @db.VarChar(100)
  passing_score                                             Decimal?                @db.Decimal(5, 2)
  max_score                                                 Decimal?                @db.Decimal(5, 2)
  pass_fail_status                                          String?                 @db.VarChar(20)
  evaluation_date                                           DateTime?               @db.Timestamptz(6)
  evaluated_by                                              String?                 @db.Uuid
  evaluation_notes                                          String?
  certificate_issued                                        Boolean?                @default(false)
  certificate_number                                        String?                 @db.VarChar(100)
  certificate_issued_date                                   DateTime?               @db.Date
  certificate_expiry_date                                   DateTime?               @db.Date
  recertification_required                                  Boolean?                @default(false)
  recertification_frequency_months                          Int?
  training_cost                                             Decimal?                @db.Decimal(12, 2)
  paid_by                                                   paid_by?
  budget_code                                               String?                 @db.VarChar(50)
  invoice_number                                            String?                 @db.VarChar(100)
  driver_feedback                                           String?
  driver_rating                                             Decimal?                @db.Decimal(3, 2)
  feedback_submitted_at                                     DateTime?               @db.Timestamptz(6)
  description_translations                                  Json?
  mz1hode   clt_members?            @relation("M_jl6a78", fields: [created_by], references: [id])
  m5zp8h9   clt_members?            @relation("M_aequx9", fields: [deleted_by], references: [id])
  rid_drivers                                               rid_drivers             @relation(fields: [driver_id], references: [id], onDelete: Cascade)
  mlcfn6t clt_members?            @relation("M_e52aqn", fields: [evaluated_by], references: [id], onUpdate: NoAction)
  adm_provider_employees                                    adm_provider_employees? @relation(fields: [provider_id], references: [id], onUpdate: NoAction)
  adm_tenants                                               adm_tenants             @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  mrpi8p7   clt_members?            @relation("M_bb25ap", fields: [updated_by], references: [id])

  @@index([created_by])
  @@index([deleted_at])
  @@index([driver_id])
  @@index([due_at])
  @@index([metadata], map: "rid_driver_training_metadata_gin", type: Gin)
  @@index([tenant_id])
  @@index([training_name])
  @@index([updated_by])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model rid_drivers {
  id                                                                           String                         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                                    String                         @db.Uuid
  first_name                                                                   String
  last_name                                                                    String
  email                                                                        String
  phone                                                                        String
  license_number                                                               String
  license_issue_date                                                           DateTime?                      @db.Date
  license_expiry_date                                                          DateTime?                      @db.Date
  professional_card_no                                                         String?
  professional_expiry                                                          DateTime?                      @db.Date
  created_at                                                                   DateTime                       @default(now()) @db.Timestamptz(6)
  updated_at                                                                   DateTime                       @default(now()) @db.Timestamptz(6)
  deleted_at                                                                   DateTime?                      @db.Timestamptz(6)
  rating                                                                       Decimal?                       @db.Decimal
  notes                                                                        String?
  date_of_birth                                                                DateTime?                      @db.Date
  gender                                                                       String?
  nationality                                                                  String?                        @db.Char(2)
  hire_date                                                                    DateTime?                      @db.Date
  employment_status                                                            String                         @default("active")
  cooperation_type                                                             cooperation_type?
  emergency_contact_name                                                       String?
  emergency_contact_phone                                                      String?
  place_of_birth                                                               String?                        @db.VarChar(100)
  emirates_id                                                                  String?                        @db.VarChar(50)
  emirates_id_expiry                                                           DateTime?                      @db.Date
  preferred_name                                                               String?                        @db.VarChar(100)
  secondary_phone                                                              String?                        @db.VarChar(20)
  emergency_contact_relation                                                   String?                        @db.VarChar(50)
  address_line1                                                                String?
  address_line2                                                                String?
  city                                                                         String?                        @db.VarChar(100)
  state                                                                        String?                        @db.VarChar(100)
  postal_code                                                                  String?                        @db.VarChar(20)
  country_code                                                                 String?                        @db.Char(2)
  bank_name                                                                    String?                        @db.VarChar(100)
  bank_account_number                                                          String?                        @db.VarChar(50)
  bank_iban                                                                    String?                        @db.VarChar(34)
  bank_swift_code                                                              String?                        @db.VarChar(11)
  preferred_payment_method                                                     preferred_payment_method?
  wps_eligible                                                                 Boolean?                       @default(false)
  driver_status                                                                driver_status?                 @default(active)
  onboarded_at                                                                 DateTime?                      @db.Timestamptz(6)
  last_active_at                                                               DateTime?                      @db.Timestamptz(6)
  total_trips_completed                                                        Int?                           @default(0)
  lifetime_earnings                                                            Decimal?                       @default(0) @db.Decimal(18, 2)
  suspension_reason                                                            String?
  suspension_start_date                                                        DateTime?                      @db.Date
  suspension_end_date                                                          DateTime?                      @db.Date
  termination_reason                                                           String?
  termination_date                                                             DateTime?                      @db.Date
  rehire_eligible                                                              Boolean?                       @default(true)
  photo_url                                                                    String?
  photo_verified_at                                                            DateTime?                      @db.Timestamptz(6)
  photo_verified_by                                                            String?                        @db.Uuid
  average_rating                                                               Decimal?                       @db.Decimal(3, 2)
  metadata                                                                     Json?                          @default("{}")
  preferences                                                                  Json?                          @default("{}")
  created_by                                                                   String?                        @db.Uuid
  updated_by                                                                   String?                        @db.Uuid
  verified_by                                                                  String?                        @db.Uuid
  verified_at                                                                  DateTime?                      @db.Timestamptz(6)
  deleted_by                                                                   String?                        @db.Uuid
  deletion_reason                                                              String?
  fin_driver_payments                                                          fin_driver_payments[]
  fin_toll_transactions                                                        fin_toll_transactions[]
  fin_traffic_fines                                                            fin_traffic_fines[]
  flt_vehicle_assignments                                                      flt_vehicle_assignments[]
  flt_vehicle_events                                                           flt_vehicle_events[]
  flt_vehicle_expenses                                                         flt_vehicle_expenses[]
  rev_driver_revenues                                                          rev_driver_revenues[]
  rev_reconciliation_lines                                                     rev_reconciliation_lines[]
  rev_reconciliations                                                          rev_reconciliations[]
  rid_driver_blacklists                                                        rid_driver_blacklists[]
  rid_driver_cooperation_terms                                                 rid_driver_cooperation_terms[]
  rid_driver_documents                                                         rid_driver_documents[]
  rid_driver_languages                                                         rid_driver_languages[]
  rid_driver_performances                                                      rid_driver_performances[]
  rid_driver_requests                                                          rid_driver_requests[]
  rid_driver_training                                                          rid_driver_training[]
  eb4zuoi        adm_provider_employees?        @relation("E_qtdkfv", fields: [created_by], references: [id], onUpdate: NoAction, map: "rid_drivers_created_by_employee_fkey")
  eibg7oj        adm_provider_employees?        @relation("E_jmx7fu", fields: [deleted_by], references: [id], onUpdate: NoAction, map: "rid_drivers_deleted_by_employee_fkey")
  e255fsf adm_provider_employees?        @relation("E_wwdh36", fields: [photo_verified_by], references: [id], onUpdate: NoAction)
  adm_tenants                                                                  adm_tenants                    @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  eqkrs91        adm_provider_employees?        @relation("E_bdlmvc", fields: [updated_by], references: [id], onUpdate: NoAction, map: "rid_drivers_updated_by_employee_fkey")
  e34x5ok       adm_provider_employees?        @relation("E_y2a2i9", fields: [verified_by], references: [id], onUpdate: NoAction, map: "rid_drivers_verified_by_employee_fkey")
  x2p55as                                 sch_shifts[]                   @relation("X_w4waib")
  xzaomkn                     sch_shifts[]                   @relation("X_ekt20w")
  sup_customer_feedback                                                        sup_customer_feedback[]
  trp_trips                                                                    trp_trips[]

  @@index([metadata], map: "idx_rid_drivers_metadata", type: Gin)
  @@index([created_at(sort: Desc)])
  @@index([deleted_at])
  @@index([email])
  @@index([first_name])
  @@index([last_name])
  @@index([license_number])
  @@index([phone])
  @@index([tenant_id])
}

model sch_goal_achievements {
  id                String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  goal_id           String          @db.Uuid
  achievement_date  DateTime        @db.Timestamptz(6)
  final_value       Decimal         @db.Decimal(12, 2)
  threshold_reached goal_threshold?
  reward_granted    Boolean?        @default(false)
  reward_amount     Decimal?        @db.Decimal(10, 2)
  certificate_url   String?         @db.VarChar(500)
  notes             String?
  metadata          Json?
  created_at        DateTime?       @default(now()) @db.Timestamptz(6)
  created_by        String          @db.Uuid
  sch_goals         sch_goals       @relation(fields: [goal_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_goal_achievements_goal")

  @@index([achievement_date], map: "idx_goal_achievements_date")
  @@index([goal_id, achievement_date], map: "idx_goal_achievements_goal_date")
  @@index([reward_granted], map: "idx_goal_achievements_reward")
}

model sch_goal_types {
  id                 String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id          String            @db.Uuid
  code               String            @db.VarChar(50)
  label              String            @db.VarChar(255)
  category           goal_category
  unit               String            @db.VarChar(50)
  calculation_method String?
  data_source_table  String?           @db.VarChar(100)
  data_source_field  String?           @db.VarChar(100)
  aggregation_type   aggregation_type?
  is_higher_better   Boolean?          @default(true)
  icon               String?           @db.VarChar(50)
  color              String?           @db.VarChar(20)
  metadata           Json?
  created_at         DateTime          @default(now()) @db.Timestamptz(6)
  updated_at         DateTime          @default(now()) @db.Timestamptz(6)
  created_by         String            @db.Uuid
  updated_by         String?           @db.Uuid
  deleted_at         DateTime?         @db.Timestamptz(6)
  deleted_by         String?           @db.Uuid
  deletion_reason    String?
  label_translations Json
  adm_tenants        adm_tenants       @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_goal_types_tenant")
  sch_goals          sch_goals[]

  @@index([category], map: "idx_goal_types_category")
  @@index([deleted_at], map: "idx_goal_types_deleted")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model sch_goals {
  id                                            String                  @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                     String                  @db.Uuid
  goal_type                                     String
  target_value                                  Decimal                 @db.Decimal
  period_start                                  DateTime                @db.Date
  period_end                                    DateTime                @db.Date
  assigned_to                                   String                  @db.Uuid
  metadata                                      Json                    @default("{}")
  created_at                                    DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                    String?                 @db.Uuid
  updated_at                                    DateTime                @default(now()) @db.Timestamptz(6)
  updated_by                                    String?                 @db.Uuid
  deleted_at                                    DateTime?               @db.Timestamptz(6)
  deleted_by                                    String?                 @db.Uuid
  deletion_reason                               String?
  goal_type_id                                  String?                 @db.Uuid
  goal_category                                 goal_category?
  target_type                                   goal_target_type?
  target_entity_type                            String?                 @db.VarChar(50)
  target_entity_id                              String?                 @db.Uuid
  period_type                                   goal_period_type?
  recurrence_pattern                            String?                 @db.VarChar(100)
  current_value                                 Decimal?                @default(0) @db.Decimal(12, 2)
  progress_percent                              Decimal?                @db.Decimal(5, 2)
  unit                                          String?                 @db.VarChar(50)
  weight                                        Decimal?                @default(1.0) @db.Decimal(5, 2)
  reward_type                                   goal_reward_type?
  reward_amount                                 Decimal?                @db.Decimal(10, 2)
  threshold_bronze                              Decimal?                @db.Decimal(12, 2)
  threshold_silver                              Decimal?                @db.Decimal(12, 2)
  threshold_gold                                Decimal?                @db.Decimal(12, 2)
  achievement_date                              DateTime?               @db.Timestamptz(6)
  last_calculated_at                            DateTime?               @db.Timestamptz(6)
  last_notified_at                              DateTime?               @db.Timestamptz(6)
  notification_frequency_days                   Int?
  status                                        goal_status?            @default(active)
  notes                                         String?
  sch_goal_achievements                         sch_goal_achievements[]
  sch_goal_types                                sch_goal_types?         @relation(fields: [goal_type_id], references: [id], onUpdate: NoAction, map: "fk_goals_goal_type")
  adm_tenants                                   adm_tenants             @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_goals_tenant")
  mbrejh8 clt_members?            @relation("M_1b1p7a", fields: [created_by], references: [id])
  mt9sddf clt_members?            @relation("M_vayubr", fields: [deleted_by], references: [id])
  mk1iodr clt_members?            @relation("M_9l5u3t", fields: [updated_by], references: [id])

  @@index([achievement_date], map: "idx_goals_achievement_date")
  @@index([progress_percent, status], map: "idx_goals_progress_status")
  @@index([status, deleted_at], map: "idx_goals_status_deleted")
  @@index([target_entity_type, target_entity_id, status], map: "idx_goals_target_entity_status")
  @@index([assigned_to])
  @@index([created_by])
  @@index([deleted_at])
  @@index([goal_type])
  @@index([metadata], map: "sch_goals_metadata_gin", type: Gin)
  @@index([period_end])
  @@index([period_start])
  @@index([tenant_id])
  @@index([updated_by])
}

model sch_locations {
  id              String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id       String       @db.Uuid
  name            String       @db.VarChar(255)
  code            String       @db.VarChar(50)
  polygon         Json?
  city            String?      @db.VarChar(100)
  country         String?      @db.VarChar(100)
  description     String?
  is_active       Boolean?     @default(true)
  metadata        Json?
  created_at      DateTime     @default(now()) @db.Timestamptz(6)
  updated_at      DateTime     @default(now()) @db.Timestamptz(6)
  created_by      String       @db.Uuid
  updated_by      String?      @db.Uuid
  deleted_at      DateTime?    @db.Timestamptz(6)
  deleted_by      String?      @db.Uuid
  deletion_reason String?
  adm_tenants     adm_tenants  @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_locations_tenant")
  sch_shifts      sch_shifts[]

  @@index([is_active, deleted_at], map: "idx_locations_active_deleted")
  @@index([city, country], map: "idx_locations_city_country")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model sch_maintenance_schedules {
  id                                                              String                      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                       String                      @db.Uuid
  vehicle_id                                                      String                      @db.Uuid
  scheduled_date                                                  DateTime                    @db.Date
  maintenance_type                                                String
  metadata                                                        Json                        @default("{}")
  created_at                                                      DateTime                    @default(now()) @db.Timestamptz(6)
  created_by                                                      String?                     @db.Uuid
  updated_at                                                      DateTime                    @default(now()) @db.Timestamptz(6)
  updated_by                                                      String?                     @db.Uuid
  deleted_at                                                      DateTime?                   @db.Timestamptz(6)
  deleted_by                                                      String?                     @db.Uuid
  deletion_reason                                                 String?
  maintenance_type_id                                             String?                     @db.Uuid
  scheduled_by                                                    String?                     @db.Uuid
  estimated_duration_hours                                        Decimal?                    @db.Decimal(5, 2)
  estimated_cost                                                  Decimal?                    @db.Decimal(10, 2)
  odometer_reading                                                Int?
  trigger_type                                                    maintenance_trigger_type?
  reminder_sent_at                                                DateTime?                   @db.Timestamptz(6)
  reminder_count                                                  Int?                        @default(0)
  completed_maintenance_id                                        String?                     @db.Uuid
  rescheduled_from                                                String?                     @db.Uuid
  rescheduled_reason                                              String?
  blocking_operations                                             Boolean?                    @default(false)
  required_parts                                                  Json?
  assigned_garage                                                 String?                     @db.VarChar(255)
  garage_contact                                                  String?                     @db.VarChar(255)
  notes                                                           String?
  status                                                          maintenance_status?         @default(scheduled)
  flt_vehicle_maintenance                                         flt_vehicle_maintenance?    @relation(fields: [completed_maintenance_id], references: [id], onUpdate: NoAction, map: "fk_maintenance_schedules_completed_maintenance")
  dir_maintenance_types                                           dir_maintenance_types?      @relation(fields: [maintenance_type_id], references: [id], onUpdate: NoAction, map: "fk_maintenance_schedules_maintenance_type")
  sch_maintenance_schedules                                       sch_maintenance_schedules?  @relation("X_vqjrj9", fields: [rescheduled_from], references: [id], onUpdate: NoAction, map: "fk_maintenance_schedules_rescheduled_from")
  other_sch_maintenance_schedules                                 sch_maintenance_schedules[] @relation("X_vqjrj9")
  mut6gfl clt_members?                @relation("M_tjeb57", fields: [scheduled_by], references: [id], onUpdate: NoAction, map: "fk_maintenance_schedules_scheduled_by")
  adm_tenants                                                     adm_tenants                 @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_maintenance_schedules_tenant")
  flt_vehicles                                                    flt_vehicles                @relation(fields: [vehicle_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_maintenance_schedules_vehicle")
  m4eaj9w   clt_members?                @relation("M_e2vqg6", fields: [created_by], references: [id])
  mplmlul   clt_members?                @relation("M_qyb6eh", fields: [deleted_by], references: [id])
  m3vtlmn   clt_members?                @relation("M_mczvcp", fields: [updated_by], references: [id])

  @@index([odometer_reading], map: "idx_maintenance_schedules_odometer")
  @@index([reminder_sent_at], map: "idx_maintenance_schedules_reminder_sent")
  @@index([status, deleted_at], map: "idx_maintenance_schedules_status_deleted")
  @@index([vehicle_id, scheduled_date, status], map: "idx_maintenance_schedules_vehicle_date_status")
  @@index([created_by])
  @@index([deleted_at])
  @@index([maintenance_type])
  @@index([metadata], map: "sch_maintenance_schedules_metadata_gin", type: Gin)
  @@index([scheduled_date])
  @@index([tenant_id])
  @@index([updated_by])
  @@index([vehicle_id])
}

model sch_shift_types {
  id              String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id       String       @db.Uuid
  code            String       @db.VarChar(50)
  label           String       @db.VarChar(255)
  pay_multiplier  Decimal      @db.Decimal(4, 2)
  color_code      String?      @db.VarChar(20)
  is_active       Boolean?     @default(true)
  metadata        Json?
  created_at      DateTime     @default(now()) @db.Timestamptz(6)
  updated_at      DateTime     @default(now()) @db.Timestamptz(6)
  created_by      String       @db.Uuid
  updated_by      String?      @db.Uuid
  deleted_at      DateTime?    @db.Timestamptz(6)
  deleted_by      String?      @db.Uuid
  deletion_reason    String?
  label_translations Json
  adm_tenants        adm_tenants  @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_shift_types_tenant")
  sch_shifts         sch_shifts[]

  @@index([is_active, deleted_at], map: "idx_shift_types_active_deleted")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model sch_shifts {
  id                                                        String           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                 String           @db.Uuid
  driver_id                                                 String           @db.Uuid
  start_time                                                DateTime         @db.Timestamptz(6)
  end_time                                                  DateTime         @db.Timestamptz(6)
  metadata                                                  Json             @default("{}")
  created_at                                                DateTime         @default(now()) @db.Timestamptz(6)
  created_by                                                String?          @db.Uuid
  updated_at                                                DateTime         @default(now()) @db.Timestamptz(6)
  updated_by                                                String?          @db.Uuid
  deleted_at                                                DateTime?        @db.Timestamptz(6)
  deleted_by                                                String?          @db.Uuid
  deletion_reason                                           String?
  shift_type_id                                             String?          @db.Uuid
  shift_category                                            String?          @db.VarChar(50)
  location_id                                               String?          @db.Uuid
  zone_name                                                 String?          @db.VarChar(255)
  check_in_at                                               DateTime?        @db.Timestamptz(6)
  check_out_at                                              DateTime?        @db.Timestamptz(6)
  break_duration_minutes                                    Int?
  actual_work_minutes                                       Int?
  pay_multiplier                                            Decimal?         @db.Decimal(4, 2)
  status                                                    shift_status?
  approved_by                                               String?          @db.Uuid
  approved_at                                               DateTime?        @db.Timestamptz(6)
  cancellation_reason                                       String?          @db.VarChar(255)
  replacement_driver_id                                     String?          @db.Uuid
  m8bwrnc           clt_members?     @relation("M_mxzpam", fields: [approved_by], references: [id], onUpdate: NoAction, map: "fk_shifts_approved_by")
  xq3skz             rid_drivers      @relation("X_w4waib", fields: [driver_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_shifts_driver")
  sch_locations                                             sch_locations?   @relation(fields: [location_id], references: [id], onUpdate: NoAction, map: "fk_shifts_location")
  x70lql6 rid_drivers?     @relation("X_ekt20w", fields: [replacement_driver_id], references: [id], onUpdate: NoAction, map: "fk_shifts_replacement_driver")
  sch_shift_types                                           sch_shift_types? @relation(fields: [shift_type_id], references: [id], onUpdate: NoAction, map: "fk_shifts_shift_type")
  adm_tenants                                               adm_tenants      @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_shifts_tenant")
  maxzvbl            clt_members?     @relation("M_k4ibzp", fields: [created_by], references: [id])
  mj1x9sw            clt_members?     @relation("M_kwokuy", fields: [deleted_by], references: [id])
  m2nvqf2            clt_members?     @relation("M_semgw8", fields: [updated_by], references: [id])

  @@index([start_time(sort: Desc)], map: "idx_sch_shifts_start_time")
  @@index([check_in_at], map: "idx_shifts_checkin")
  @@index([check_out_at], map: "idx_shifts_checkout")
  @@index([driver_id, check_in_at], map: "idx_shifts_driver_checkin")
  @@index([shift_type_id, location_id], map: "idx_shifts_shift_type_location")
  @@index([status, deleted_at], map: "idx_shifts_status_deleted")
  @@index([created_by])
  @@index([deleted_at])
  @@index([driver_id])
  @@index([end_time])
  @@index([metadata], map: "sch_shifts_metadata_gin", type: Gin)
  @@index([start_time])
  @@index([tenant_id])
  @@index([updated_by])
}

model sch_task_comments {
  id           String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  task_id      String            @db.Uuid
  comment_type task_comment_type
  author_id    String            @db.Uuid
  comment_text String
  attachments  Json?
  is_internal  Boolean?          @default(false)
  metadata     Json?
  created_at   DateTime?         @default(now()) @db.Timestamptz(6)
  clt_members  clt_members       @relation(fields: [author_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_task_comments_author")
  sch_tasks    sch_tasks         @relation(fields: [task_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_task_comments_task")

  @@index([author_id], map: "idx_task_comments_author")
  @@index([task_id, created_at], map: "idx_task_comments_task_created")
  @@index([comment_type], map: "idx_task_comments_type")
}

model sch_task_history {
  id            String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  task_id       String           @db.Uuid
  changed_by    String           @db.Uuid
  change_type   task_change_type
  old_values    Json?
  new_values    Json?
  change_reason String?
  metadata      Json?
  created_at    DateTime?        @default(now()) @db.Timestamptz(6)
  clt_members   clt_members      @relation(fields: [changed_by], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_task_history_changed_by")
  sch_tasks     sch_tasks        @relation(fields: [task_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_task_history_task")

  @@index([change_type], map: "idx_task_history_change_type")
  @@index([changed_by], map: "idx_task_history_changed_by")
  @@index([task_id, created_at], map: "idx_task_history_task_created")
}

model sch_task_types {
  id                       String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                String         @db.Uuid
  code                     String         @db.VarChar(50)
  label                    String         @db.VarChar(255)
  category                 task_category
  default_priority         task_priority?
  default_duration_minutes Int?
  requires_verification    Boolean?       @default(false)
  default_checklist        Json?
  auto_assignment_rule     Json?
  sla_hours                Int?
  escalation_hours         Int?
  description_template     String?
  metadata                 Json?
  created_at               DateTime       @default(now()) @db.Timestamptz(6)
  updated_at               DateTime       @default(now()) @db.Timestamptz(6)
  created_by               String         @db.Uuid
  updated_by               String?        @db.Uuid
  deleted_at               DateTime?      @db.Timestamptz(6)
  deleted_by               String?        @db.Uuid
  deletion_reason          String?
  label_translations       Json
  adm_tenants              adm_tenants    @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_task_types_tenant")
  sch_tasks                sch_tasks[]

  @@index([category, default_priority], map: "idx_task_types_category_priority")
  @@index([deleted_at], map: "idx_task_types_deleted")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model sch_tasks {
  id                                              String              @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                       String              @db.Uuid
  task_type                                       String
  description                                     String
  target_id                                       String              @db.Uuid
  due_at                                          DateTime?           @db.Timestamptz(6)
  metadata                                        Json                @default("{}")
  created_at                                      DateTime            @default(now()) @db.Timestamptz(6)
  created_by                                      String?             @db.Uuid
  updated_at                                      DateTime            @default(now()) @db.Timestamptz(6)
  updated_by                                      String?             @db.Uuid
  deleted_at                                      DateTime?           @db.Timestamptz(6)
  deleted_by                                      String?             @db.Uuid
  deletion_reason                                 String?
  task_type_id                                    String?             @db.Uuid
  task_category                                   task_category?
  title                                           String?             @db.VarChar(255)
  priority                                        task_priority?      @default(normal)
  assigned_to                                     String?             @db.Uuid
  assigned_at                                     DateTime?           @db.Timestamptz(6)
  assigned_by                                     String?             @db.Uuid
  target_type                                     String?             @db.VarChar(50)
  related_entity_type                             String?             @db.VarChar(50)
  related_entity_id                               String?             @db.Uuid
  estimated_duration_minutes                      Int?
  actual_duration_minutes                         Int?
  start_date                                      DateTime?           @db.Date
  due_date                                        DateTime?           @db.Date
  completed_at                                    DateTime?           @db.Timestamptz(6)
  completed_by                                    String?             @db.Uuid
  verification_required                           Boolean?            @default(false)
  verified_by                                     String?             @db.Uuid
  verified_at                                     DateTime?           @db.Timestamptz(6)
  is_auto_generated                               Boolean?            @default(false)
  generation_trigger                              String?             @db.VarChar(100)
  recurrence_pattern                              String?             @db.VarChar(100)
  parent_task_id                                  String?             @db.Uuid
  blocking_tasks                                  String[]            @db.Uuid
  checklist                                       Json?
  attachments                                     Json?
  reminder_sent_at                                DateTime?           @db.Timestamptz(6)
  reminder_frequency_days                         Int?
  escalation_level                                Int?                @default(0)
  escalated_to                                    String?             @db.Uuid
  tags                                            String[]
  status                                          task_status?        @default(pending)
  sch_task_comments                               sch_task_comments[]
  sch_task_history                                sch_task_history[]
  matlkuk  clt_members?        @relation("M_k8wmgq", fields: [assigned_by], references: [id], onUpdate: NoAction, map: "fk_tasks_assigned_by")
  mocm07k  clt_members?        @relation("M_flzuga", fields: [assigned_to], references: [id], onUpdate: NoAction, map: "fk_tasks_assigned_to")
  mb4yqx9 clt_members?        @relation("M_k4xq0p", fields: [completed_by], references: [id], onUpdate: NoAction, map: "fk_tasks_completed_by")
  mftewk0 clt_members?        @relation("M_fghkdy", fields: [escalated_to], references: [id], onUpdate: NoAction, map: "fk_tasks_escalated_to")
  sch_tasks                                       sch_tasks?          @relation("sch_tasksTosch_tasks", fields: [parent_task_id], references: [id], onUpdate: NoAction, map: "fk_tasks_parent_task")
  other_sch_tasks                                 sch_tasks[]         @relation("sch_tasksTosch_tasks")
  sch_task_types                                  sch_task_types?     @relation(fields: [task_type_id], references: [id], onUpdate: NoAction, map: "fk_tasks_task_type")
  adm_tenants                                     adm_tenants         @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_tasks_tenant")
  m138w1a  clt_members?        @relation("M_w5r3ck", fields: [verified_by], references: [id], onUpdate: NoAction, map: "fk_tasks_verified_by")
  m8ab9ii   clt_members?        @relation("M_261krg", fields: [created_by], references: [id])
  mwqvnc5   clt_members?        @relation("M_rtvkd1", fields: [deleted_by], references: [id])
  mgkfef1   clt_members?        @relation("M_642k53", fields: [updated_by], references: [id])

  @@index([created_by], map: "idx_sch_tasks_created_by")
  @@index([deleted_at], map: "idx_sch_tasks_deleted_at")
  @@index([due_at], map: "idx_sch_tasks_due_at")
  @@index([metadata], map: "idx_sch_tasks_metadata", type: Gin)
  @@index([target_id], map: "idx_sch_tasks_target_id")
  @@index([tenant_id], map: "idx_sch_tasks_tenant_id")
  @@index([updated_by], map: "idx_sch_tasks_updated_by")
  @@index([assigned_to, status, due_date], map: "idx_tasks_assigned_status_due")
  @@index([is_auto_generated, generation_trigger], map: "idx_tasks_auto_generated")
  @@index([task_category, priority], map: "idx_tasks_category_priority")
  @@index([status, deleted_at], map: "idx_tasks_status_deleted")
  @@index([tags], map: "idx_tasks_tags", type: Gin)
  @@index([target_type, target_id, status], map: "idx_tasks_target")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model sup_canned_responses {
  id                     String                 @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id              String                 @db.Uuid
  title                  String                 @db.VarChar(255)
  content                String
  category               String?                @db.VarChar(100)
  language               String                 @db.VarChar(10)
  usage_count            Int                    @default(0)
  last_used_at           DateTime?              @db.Timestamptz(6)
  is_active              Boolean                @default(true)
  created_at             DateTime               @default(now()) @db.Timestamptz(6)
  updated_at             DateTime               @default(now()) @db.Timestamptz(6)
  created_by             String                 @db.Uuid
  title_translations     Json
  adm_provider_employees adm_provider_employees @relation(fields: [created_by], references: [id], onUpdate: NoAction, map: "fk_sup_responses_creator")
  adm_tenants            adm_tenants            @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_sup_responses_tenant")

  @@index([language], map: "idx_sup_responses_language")
  @@index([usage_count], map: "idx_sup_responses_popularity")
  @@index([tenant_id, category, is_active], map: "idx_sup_responses_tenant")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model sup_customer_feedback {
  id                           String          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                    String          @db.Uuid
  submitted_by                 String          @db.Uuid
  feedback_text                String
  rating                       Int
  metadata                     Json?           @default("{}")
  created_by                   String?         @db.Uuid
  created_at                   DateTime        @default(now()) @db.Timestamptz(6)
  updated_by                   String?         @db.Uuid
  updated_at                   DateTime        @default(now()) @db.Timestamptz(6)
  deleted_by                   String?         @db.Uuid
  deleted_at                   DateTime?       @db.Timestamptz(6)
  ticket_id                    String?         @db.Uuid
  driver_id                    String?         @db.Uuid
  service_type                 service_type?   @default(other)
  language                     String?         @db.VarChar(10)
  sentiment_score              Float?
  is_anonymous                 Boolean?        @default(false)
  category                     String?         @db.VarChar(100)
  tags                         String[]        @default([])
  overall_rating               Int?
  response_time_rating         Int?
  resolution_quality_rating    Int?
  agent_professionalism_rating Int?
  submitter_type               submitter_type?
  rid_drivers                  rid_drivers?    @relation(fields: [driver_id], references: [id], map: "fk_sup_feedback_driver")
  sup_tickets                  sup_tickets?    @relation(fields: [ticket_id], references: [id], onUpdate: NoAction, map: "fk_sup_feedback_ticket")
  adm_tenants                  adm_tenants     @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([metadata], type: Gin)
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model sup_ticket_categories {
  id                                                                              String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                                                       String                  @db.Uuid
  name                                                                            String                  @db.VarChar(100)
  slug                                                                            String                  @db.VarChar(100)
  description                                                                     String?
  parent_category_id                                                              String?                 @db.Uuid
  default_priority                                                                ticket_priority?
  default_assigned_team                                                           String?                 @db.VarChar(100)
  sla_hours                                                                       Int?
  is_active                                                                       Boolean                 @default(true)
  display_order                                                                   Int                     @default(0)
  created_at                                                                      DateTime                @default(now()) @db.Timestamptz(6)
  updated_at                                                                      DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                                                      String                  @db.Uuid
  updated_by                                                                      String?                 @db.Uuid
  name_translations                                                               Json
  description_translations                                                        Json?
  exdl847 adm_provider_employees  @relation("E_32ecp6", fields: [created_by], references: [id], onUpdate: NoAction, map: "fk_sup_categories_creator")
  sup_ticket_categories                                                           sup_ticket_categories?  @relation("X_ahhk6z", fields: [parent_category_id], references: [id], onUpdate: NoAction, map: "fk_sup_categories_parent")
  other_sup_ticket_categories                                                     sup_ticket_categories[] @relation("X_ahhk6z")
  adm_tenants                                                                     adm_tenants             @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_sup_categories_tenant")
  em7qwae adm_provider_employees? @relation("E_ii6a9p", fields: [updated_by], references: [id], onUpdate: NoAction, map: "fk_sup_categories_updater")
  sup_ticket_sla_rules                                                            sup_ticket_sla_rules[]

  @@unique([tenant_id, slug], map: "uq_sup_categories_tenant_slug")
  @@index([display_order], map: "idx_sup_categories_order")
  @@index([parent_category_id], map: "idx_sup_categories_parent")
  @@index([tenant_id, is_active], map: "idx_sup_categories_tenant")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model sup_ticket_messages {
  id                                                      String                @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  ticket_id                                               String                @db.Uuid
  sender_id                                               String                @db.Uuid
  message_body                                            String
  sent_at                                                 DateTime              @default(now()) @db.Timestamptz(6)
  metadata                                                Json                  @default("{}")
  created_at                                              DateTime              @default(now()) @db.Timestamptz(6)
  created_by                                              String?               @db.Uuid
  updated_at                                              DateTime              @default(now()) @db.Timestamptz(6)
  updated_by                                              String?               @db.Uuid
  deleted_at                                              DateTime?             @db.Timestamptz(6)
  deleted_by                                              String?               @db.Uuid
  deletion_reason                                         String?
  message_type                                            message_type?         @default(public)
  parent_message_id                                       String?               @db.Uuid
  attachment_url                                          String?
  attachment_type                                         String?               @db.VarChar(50)
  language                                                String?               @db.VarChar(10)
  sentiment_score                                         Float?
  is_automated                                            Boolean?              @default(false)
  ai_suggestions                                          Json?
  translation                                             Json?
  sup_ticket_messages                                     sup_ticket_messages?  @relation("X_iy9pyz", fields: [parent_message_id], references: [id], onUpdate: NoAction, map: "fk_sup_messages_parent")
  other_sup_ticket_messages                               sup_ticket_messages[] @relation("X_iy9pyz")
  mcqz5lb clt_members?          @relation("M_3ngxt7", fields: [created_by], references: [id])
  mh8xzj6 clt_members?          @relation("M_xne2xo", fields: [deleted_by], references: [id])
  sup_tickets                                             sup_tickets           @relation(fields: [ticket_id], references: [id], onDelete: Cascade)
  m4gv0os clt_members?          @relation("M_bxl2pq", fields: [updated_by], references: [id])

  @@index([created_by])
  @@index([deleted_at])
  @@index([metadata], type: Gin)
  @@index([sent_at])
  @@index([ticket_id])
  @@index([updated_by])
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model sup_ticket_sla_rules {
  id                                                                             String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                                                      String                  @db.Uuid
  category_id                                                                    String?                 @db.Uuid
  priority                                                                       ticket_priority
  response_time_hours                                                            Int
  resolution_time_hours                                                          Int
  escalation_rules                                                               Json?
  business_hours_only                                                            Boolean                 @default(false)
  is_active                                                                      Boolean                 @default(true)
  created_at                                                                     DateTime                @default(now()) @db.Timestamptz(6)
  updated_at                                                                     DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                                                     String                  @db.Uuid
  updated_by                                                                     String?                 @db.Uuid
  sup_ticket_categories                                                          sup_ticket_categories?  @relation(fields: [category_id], references: [id], onUpdate: NoAction, map: "fk_sup_sla_category")
  ez7ekkd adm_provider_employees  @relation("E_rcqqbu", fields: [created_by], references: [id], onUpdate: NoAction, map: "fk_sup_sla_creator")
  adm_tenants                                                                    adm_tenants             @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_sup_sla_tenant")
  ekdxju8 adm_provider_employees? @relation("E_s8le2r", fields: [updated_by], references: [id], onUpdate: NoAction, map: "fk_sup_sla_updater")

  @@unique([tenant_id, category_id, priority], map: "uq_sup_sla_tenant_category_priority")
  @@index([category_id], map: "idx_sup_sla_category")
  @@index([priority], map: "idx_sup_sla_priority")
  @@index([tenant_id, is_active], map: "idx_sup_sla_tenant")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model sup_tickets {
  id                                              String                  @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                       String                  @db.Uuid
  raised_by                                       String                  @db.Uuid
  subject                                         String
  description                                     String
  assigned_to                                     String?                 @db.Uuid
  metadata                                        Json                    @default("{}")
  created_at                                      DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                      String?                 @db.Uuid
  updated_at                                      DateTime                @default(now()) @db.Timestamptz(6)
  updated_by                                      String?                 @db.Uuid
  deleted_at                                      DateTime?               @db.Timestamptz(6)
  deleted_by                                      String?                 @db.Uuid
  deletion_reason                                 String?
  category                                        String?                 @db.VarChar(100)
  sub_category                                    String?                 @db.VarChar(100)
  language                                        String?                 @db.VarChar(10)
  source_platform                                 ticket_source_platform? @default(web)
  raised_by_type                                  ticket_raised_by_type?  @default(admin)
  attachments_url                                 String[]                @default([])
  resolution_notes                                String?
  sla_due_at                                      DateTime?               @db.Timestamptz(6)
  closed_at                                       DateTime?               @db.Timestamptz(6)
  status                                          ticket_status?          @default(new)
  priority                                        ticket_priority?        @default(medium)
  sup_customer_feedback                           sup_customer_feedback[]
  sup_ticket_messages                             sup_ticket_messages[]
  mgq93v5  clt_members             @relation("M_ec93g5", fields: [raised_by], references: [id], onUpdate: NoAction, map: "fk_sup_tickets_member")
  adm_provider_employees                          adm_provider_employees? @relation(fields: [assigned_to], references: [id])
  mweda2v clt_members?            @relation("M_7cuayb", fields: [created_by], references: [id])
  m2eg4ye clt_members?            @relation("M_xoclwc", fields: [deleted_by], references: [id])
  adm_tenants                                     adm_tenants             @relation(fields: [tenant_id], references: [id], onDelete: Cascade)
  mo4956c clt_members?            @relation("M_fmyfuu", fields: [updated_by], references: [id])

  @@index([assigned_to])
  @@index([created_at])
  @@index([created_by])
  @@index([deleted_at])
  @@index([metadata], type: Gin)
  @@index([raised_by])
  @@index([tenant_id])
  @@index([updated_by])
}

model trp_client_invoice_lines {
  id                  String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  invoice_id          String              @db.Uuid
  line_number         Int
  description         String
  trip_id             String?             @db.Uuid
  quantity            Decimal             @db.Decimal(10, 2)
  unit_price          Decimal             @db.Decimal(14, 2)
  tax_rate            Decimal?            @db.Decimal(5, 2)
  line_amount         Decimal             @db.Decimal(14, 2)
  metadata            Json?
  created_at          DateTime?           @default(now()) @db.Timestamptz(6)
  trp_client_invoices trp_client_invoices @relation(fields: [invoice_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_client_invoice_lines_invoice")
  trp_trips           trp_trips?          @relation(fields: [trip_id], references: [id], onUpdate: NoAction, map: "fk_client_invoice_lines_trip")

  @@index([invoice_id, line_number], map: "idx_client_invoice_lines_invoice_line")
  @@index([trip_id], map: "idx_client_invoice_lines_trip")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model trp_client_invoices {
  id                                                      String                     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                               String                     @db.Uuid
  client_id                                               String                     @db.Uuid
  invoice_number                                          String
  invoice_date                                            DateTime                   @db.Date
  due_date                                                DateTime                   @db.Date
  total_amount                                            Decimal                    @db.Decimal(14, 2)
  currency                                                String                     @db.VarChar(3)
  metadata                                                Json                       @default("{}")
  created_at                                              DateTime                   @default(now()) @db.Timestamptz(6)
  created_by                                              String?                    @db.Uuid
  updated_at                                              DateTime                   @default(now()) @db.Timestamptz(6)
  updated_by                                              String?                    @db.Uuid
  deleted_at                                              DateTime?                  @db.Timestamptz(6)
  deleted_by                                              String?                    @db.Uuid
  deletion_reason                                         String?
  pricing_plan_id                                         String?                    @db.Uuid
  client_po_number                                        String?                    @db.VarChar(100)
  discount_amount                                         Decimal?                   @db.Decimal(14, 2)
  discount_reason                                         String?
  status                                                  trp_invoice_status?        @default(draft)
  paid_at                                                 DateTime?                  @db.Timestamptz(6)
  payment_reference                                       String?                    @db.VarChar(255)
  payment_method                                          trp_payment_method?
  trp_client_invoice_lines                                trp_client_invoice_lines[]
  adm_tenants                                             adm_tenants                @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_client_invoices_tenant")
  mqil34g clt_members?               @relation("M_s42vg6", fields: [created_by], references: [id])
  meiltq7 clt_members?               @relation("M_1vu9ob", fields: [deleted_by], references: [id])
  mysp80z clt_members?               @relation("M_jtyqjn", fields: [updated_by], references: [id])

  @@index([client_id, status, invoice_date], map: "idx_client_invoices_client_status_date")
  @@index([paid_at], map: "idx_client_invoices_paid_at")
  @@index([status, due_date], map: "idx_client_invoices_status_due")
  @@index([client_id], map: "idx_trp_client_invoices_client_id")
  @@index([created_by], map: "idx_trp_client_invoices_created_by")
  @@index([deleted_at], map: "idx_trp_client_invoices_deleted_at")
  @@index([due_date], map: "idx_trp_client_invoices_due_date")
  @@index([invoice_date], map: "idx_trp_client_invoices_invoice_date")
  @@index([metadata], map: "idx_trp_client_invoices_metadata", type: Gin)
  @@index([tenant_id], map: "idx_trp_client_invoices_tenant_id")
  @@index([updated_by], map: "idx_trp_client_invoices_updated_by")
}

model trp_platform_account_keys {
  id                     String                    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  account_id             String                    @db.Uuid
  key_value              String
  key_type               platform_account_key_type
  expires_at             DateTime?                 @db.Timestamptz(6)
  is_active              Boolean?                  @default(true)
  last_used_at           DateTime?                 @db.Timestamptz(6)
  created_at             DateTime?                 @default(now()) @db.Timestamptz(6)
  revoked_at             DateTime?                 @db.Timestamptz(6)
  revoked_by             String?                   @db.Uuid
  revoke_reason          String?
  trp_platform_accounts  trp_platform_accounts     @relation(fields: [account_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_platform_account_keys_account")
  adm_provider_employees adm_provider_employees?   @relation(fields: [revoked_by], references: [id], onUpdate: NoAction, map: "fk_platform_account_keys_revoked_by")

  @@index([account_id, is_active], map: "idx_platform_account_keys_account_active")
  @@index([expires_at], map: "idx_platform_account_keys_expires")
  @@index([key_type], map: "idx_platform_account_keys_type")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model trp_platform_accounts {
  id                                                        String                      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                 String                      @db.Uuid
  platform_id                                               String                      @db.Uuid
  account_identifier                                        String
  api_key                                                   String?
  metadata                                                  Json                        @default("{}")
  created_at                                                DateTime                    @default(now()) @db.Timestamptz(6)
  created_by                                                String?                     @db.Uuid
  updated_at                                                DateTime                    @default(now()) @db.Timestamptz(6)
  updated_by                                                String?                     @db.Uuid
  deleted_at                                                DateTime?                   @db.Timestamptz(6)
  deleted_by                                                String?                     @db.Uuid
  deletion_reason                                           String?
  account_name                                              String?                     @db.VarChar(255)
  status                                                    platform_account_status?    @default(active)
  connected_at                                              DateTime?                   @db.Timestamptz(6)
  last_sync_at                                              DateTime?                   @db.Timestamptz(6)
  last_error                                                String?
  error_count                                               Int?                        @default(0)
  sync_frequency                                            String?                     @db.VarChar(50)
  trp_platform_account_keys                                 trp_platform_account_keys[]
  dir_platforms                                             dir_platforms               @relation(fields: [platform_id], references: [id], onUpdate: NoAction, map: "fk_platform_accounts_platform")
  adm_tenants                                               adm_tenants                 @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_platform_accounts_tenant")
  mgxogtk clt_members?                @relation("M_9qb4de", fields: [created_by], references: [id])
  mo3ig13 clt_members?                @relation("M_vavsh9", fields: [deleted_by], references: [id])
  mp7slq3 clt_members?                @relation("M_i0f99x", fields: [updated_by], references: [id])
  trp_settlements                                           trp_settlements[]
  trp_trips                                                 trp_trips[]

  @@index([error_count], map: "idx_platform_accounts_error_count")
  @@index([status, last_sync_at], map: "idx_platform_accounts_status_sync")
  @@index([account_identifier], map: "idx_trp_platform_accounts_account_identifier")
  @@index([created_by], map: "idx_trp_platform_accounts_created_by")
  @@index([deleted_at], map: "idx_trp_platform_accounts_deleted_at")
  @@index([metadata], map: "idx_trp_platform_accounts_metadata", type: Gin)
  @@index([platform_id], map: "idx_trp_platform_accounts_platform_id")
  @@index([tenant_id], map: "idx_trp_platform_accounts_tenant_id")
  @@index([updated_by], map: "idx_trp_platform_accounts_updated_by")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model trp_settlements {
  id                                                  String                 @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                           String                 @db.Uuid
  trip_id                                             String                 @db.Uuid
  settlement_reference                                String
  amount                                              Decimal                @db.Decimal(14, 2)
  currency                                            String                 @db.VarChar(3)
  platform_commission                                 Decimal                @db.Decimal(14, 2)
  net_amount                                          Decimal                @db.Decimal(14, 2)
  settlement_date                                     DateTime               @db.Date
  metadata                                            Json                   @default("{}")
  created_at                                          DateTime               @default(now()) @db.Timestamptz(6)
  created_by                                          String?                @db.Uuid
  updated_at                                          DateTime               @default(now()) @db.Timestamptz(6)
  updated_by                                          String?                @db.Uuid
  deleted_at                                          DateTime?              @db.Timestamptz(6)
  deleted_by                                          String?                @db.Uuid
  deletion_reason                                     String?
  platform_account_id                                 String?                @db.Uuid
  settlement_type                                     settlement_type?       @default(platform_payout)
  platform_settlement_id                              String?                @db.VarChar(255)
  commission                                          Decimal?               @db.Decimal(14, 2)
  tax_amount                                          Decimal?               @db.Decimal(14, 2)
  tax_rate                                            Decimal?               @db.Decimal(5, 2)
  exchange_rate                                       Decimal?               @db.Decimal(10, 6)
  original_currency                                   String?                @db.Char(3)
  original_amount                                     Decimal?               @db.Decimal(14, 2)
  status                                              settlement_status?     @default(pending)
  paid_at                                             DateTime?              @db.Timestamptz(6)
  cancelled_at                                        DateTime?              @db.Timestamptz(6)
  reconciled                                          Boolean?               @default(false)
  reconciliation_id                                   String?                @db.Uuid
  trp_platform_accounts                               trp_platform_accounts? @relation(fields: [platform_account_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_settlements_platform_account")
  adm_tenants                                         adm_tenants            @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_settlements_tenant")
  trp_trips                                           trp_trips              @relation(fields: [trip_id], references: [id], onDelete: SetNull, onUpdate: NoAction, map: "fk_settlements_trip")
  rev_reconciliations                                 rev_reconciliations?   @relation(fields: [reconciliation_id], references: [id], map: "fk_trp_settlements_reconciliation")
  m6y9h5s clt_members?           @relation("M_771c4m", fields: [created_by], references: [id])
  my2xfov clt_members?           @relation("M_msvszv", fields: [deleted_by], references: [id])
  mf8dm2b clt_members?           @relation("M_132srx", fields: [updated_by], references: [id])

  @@index([reconciled], map: "idx_settlements_not_reconciled")
  @@index([platform_account_id, settlement_date], map: "idx_settlements_platform_account_date")
  @@index([platform_settlement_id], map: "idx_settlements_platform_settlement_id")
  @@index([status, paid_at], map: "idx_settlements_status_paid")
  @@index([created_by], map: "idx_trp_settlements_created_by")
  @@index([deleted_at], map: "idx_trp_settlements_deleted_at")
  @@index([metadata], map: "idx_trp_settlements_metadata", type: Gin)
  @@index([settlement_date], map: "idx_trp_settlements_settlement_date")
  @@index([tenant_id], map: "idx_trp_settlements_tenant_id")
  @@index([trip_id], map: "idx_trp_settlements_trip_id")
  @@index([updated_by], map: "idx_trp_settlements_updated_by")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model trp_trips {
  id                       String                     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                String                     @db.Uuid
  driver_id                String                     @db.Uuid
  vehicle_id               String?                    @db.Uuid
  platform_id              String?                    @db.Uuid
  pickup_latitude          Decimal?                   @db.Decimal(10, 8)
  pickup_longitude         Decimal?                   @db.Decimal(11, 8)
  start_time               DateTime?                  @db.Timestamptz(6)
  dropoff_latitude         Decimal?                   @db.Decimal(10, 8)
  dropoff_longitude        Decimal?                   @db.Decimal(11, 8)
  end_time                 DateTime?                  @db.Timestamptz(6)
  distance_km              Decimal?                   @db.Decimal(10, 2)
  duration_minutes         Decimal?                   @db.Decimal
  payment_method           String?                    @db.VarChar(50)
  platform_commission      Decimal?                   @db.Decimal(10, 2)
  net_earnings             Decimal?                   @db.Decimal(10, 2)
  created_at               DateTime                   @default(now()) @db.Timestamptz(6)
  updated_at               DateTime                   @default(now()) @db.Timestamptz(6)
  deleted_at               DateTime?                  @db.Timestamptz(6)
  client_id                String?                    @db.Uuid
  trip_date                DateTime?                  @db.Date
  fare_base                Decimal?                   @db.Decimal
  fare_distance            Decimal?                   @db.Decimal
  fare_time                Decimal?                   @db.Decimal
  surge_multiplier         Decimal?                   @db.Decimal
  tip_amount               Decimal?                   @db.Decimal
  platform_account_id      String?                    @db.Uuid
  platform_trip_id         String?                    @db.VarChar(255)
  requested_at             DateTime?                  @db.Timestamptz(6)
  matched_at               DateTime?                  @db.Timestamptz(6)
  accepted_at              DateTime?                  @db.Timestamptz(6)
  arrived_at               DateTime?                  @db.Timestamptz(6)
  started_at               DateTime?                  @db.Timestamptz(6)
  finished_at              DateTime?                  @db.Timestamptz(6)
  pickup_lat               Decimal?                   @db.Decimal(10, 7)
  pickup_lng               Decimal?                   @db.Decimal(10, 7)
  dropoff_lat              Decimal?                   @db.Decimal(10, 7)
  dropoff_lng              Decimal?                   @db.Decimal(10, 7)
  distance                 Decimal?                   @db.Decimal(10, 2)
  duration                 Int?
  base_fare                Decimal?                   @db.Decimal(10, 2)
  distance_fare            Decimal?                   @db.Decimal(10, 2)
  time_fare                Decimal?                   @db.Decimal(10, 2)
  surge_amount             Decimal?                   @db.Decimal(10, 2)
  total_fare               Decimal?                   @db.Decimal(10, 2)
  currency                 String?                    @db.Char(3)
  status                   trip_status?
  metadata                 Json?
  created_by               String?                    @db.Uuid
  updated_by               String?                    @db.Uuid
  deleted_by               String?                    @db.Uuid
  deletion_reason          String?
  fin_toll_transactions    fin_toll_transactions[]
  flt_vehicle_expenses     flt_vehicle_expenses[]
  trp_client_invoice_lines trp_client_invoice_lines[]
  trp_settlements          trp_settlements[]
  rid_drivers              rid_drivers                @relation(fields: [driver_id], references: [id], onDelete: SetNull, onUpdate: NoAction, map: "fk_trips_driver")
  trp_platform_accounts    trp_platform_accounts?     @relation(fields: [platform_account_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_trips_platform_account")
  adm_tenants              adm_tenants                @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_trips_tenant")
  flt_vehicles             flt_vehicles?              @relation(fields: [vehicle_id], references: [id], onUpdate: NoAction, map: "fk_trips_vehicle")
  dir_platforms            dir_platforms?             @relation(fields: [platform_id], references: [id], onDelete: Restrict)

  @@index([driver_id, status], map: "idx_trips_driver_status")
  @@index([requested_at, finished_at], map: "idx_trips_requested_finished")
  @@index([status, deleted_at], map: "idx_trips_status_deleted")
  @@index([tenant_id, status, started_at], map: "idx_trips_tenant_status_started")
  @@index([vehicle_id, started_at], map: "idx_trips_vehicle_started")
  @@index([metadata], map: "idx_trp_trips_metadata", type: Gin)
  @@index([client_id])
  @@index([created_at(sort: Desc)])
  @@index([deleted_at])
  @@index([driver_id])
  @@index([end_time])
  @@index([platform_id])
  @@index([start_time])
  @@index([tenant_id])
  @@index([trip_date])
  @@index([vehicle_id])
}

/// HQ global configuration: adm_error_messages
model adm_error_messages {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  error_code String   @unique @db.VarChar(100)
  message_en String
  message_fr String
  category   String   @default("validation") @db.VarChar(50)
  severity   String   @default("error") @db.VarChar(20)
  module     String?  @db.VarChar(50)
  is_active  Boolean  @default(true)
  created_at DateTime @default(now()) @db.Timestamptz(6)
  updated_at DateTime @default(now()) @db.Timestamptz(6)

  @@index([error_code], map: "idx_adm_error_messages_code")
  @@index([module], map: "idx_adm_error_messages_module")
}

/// HQ global configuration: hq_offer_rules
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model hq_offer_rules {
  id                       String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  country_code             String?  @db.VarChar(2)
  offer_type               String   @db.VarChar(20)
  code                     String   @unique @db.VarChar(50)
  name_translations        Json
  description_translations Json?
  free_months              Int?
  referrer_free_months     Int?
  referee_free_months      Int?
  discount_percent         Decimal? @db.Decimal(5, 2)
  requires_payment_method  Boolean  @default(false)
  requires_qualification   Boolean  @default(false)
  max_uses_total           Int?
  max_uses_per_user        Int?
  fleet_size_min           Int?
  fleet_size_max           Int?
  is_active                Boolean  @default(true)
  valid_from               DateTime? @db.Date
  valid_until              DateTime? @db.Date
  display_order            Int      @default(0)
  created_at               DateTime @default(now()) @db.Timestamptz(6)
  updated_at               DateTime @default(now()) @db.Timestamptz(6)

  @@index([is_active], map: "idx_hq_offer_active")
  @@index([country_code], map: "idx_hq_offer_country")
  @@index([offer_type], map: "idx_hq_offer_type")
}

/// HQ global configuration: hq_pricing_rules
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model hq_pricing_rules {
  id                       String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  country_code             String?   @db.VarChar(2)
  code                     String    @unique @db.VarChar(50)
  name_translations        Json
  description_translations Json?
  fleet_size_min           Int
  fleet_size_max           Int?
  max_discount_percent     Decimal   @default(0) @db.Decimal(5, 2)
  requires_approval        Boolean   @default(false)
  approval_role            String?   @db.VarChar(50)
  is_active                Boolean   @default(true)
  valid_from               DateTime? @db.Date
  valid_until              DateTime? @db.Date
  display_order            Int       @default(0)
  created_at               DateTime  @default(now()) @db.Timestamptz(6)
  updated_at               DateTime  @default(now()) @db.Timestamptz(6)

  @@index([is_active], map: "idx_hq_pricing_active")
  @@index([country_code], map: "idx_hq_pricing_country")
  @@index([fleet_size_min, fleet_size_max], map: "idx_hq_pricing_fleet")
}

/// Stripe integration: stripe_webhook_logs
model stripe_webhook_logs {
  id                     String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  event_id               String   @unique @db.VarChar(255)
  event_type             String   @db.VarChar(100)
  payload                Json
  processed_at           DateTime @default(now()) @db.Timestamptz(6)
  processing_duration_ms Int?
  status                 String?  @default("processed") @db.VarChar(20)
  error_message          String?
  retry_count            Int?     @default(0)
  created_at             DateTime @default(now()) @db.Timestamptz(6)

  @@index([created_at(sort: Desc)], map: "idx_stripe_webhook_logs_created_at")
  @@index([event_type], map: "idx_stripe_webhook_logs_event_type")
  @@index([status], map: "idx_stripe_webhook_logs_status")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model v_fk {
  count BigInt?

  @@ignore
}

enum access_level {
  private
  public
  signed
}

enum account_status {
  active
  suspended
  closed
}

enum address_type {
  billing
  shipping
}

enum aggregation_method {
  sum
  max
  avg
  last
}

enum aggregation_type {
  sum
  avg
  count
  min
  max
}

enum allocation_rule {
  driver
  fleet
  shared
  client
}

enum appeal_status {
  not_applicable
  pending
  under_review
  accepted
  rejected
}

enum approval_status {
  pending
  approved
  rejected
  cancelled
  auto_approved
}

enum assignment_status {
  active
  completed
  cancelled
}

enum assignment_type {
  permanent
  temporary
  trial
}

enum audit_category {
  security
  financial
  compliance
  operational
}

enum audit_severity {
  info
  warning
  error
  critical
}

enum batch_type {
  WPS
  SEPA
  local
}

enum billing_interval {
  month
  year
}

enum billing_plan_status {
  draft
  active
  deprecated
  archived
}

enum blacklist_category {
  disciplinary
  administrative
  legal
  safety
  financial
  performance
  contract_breach
  criminal
  voluntary
}

enum blacklist_severity {
  low
  medium
  high
  critical
}

enum blacklist_status {
  active
  expired
  revoked
  appealed_lifted
}

enum body_type {
  sedan
  hatchback
  suv
  van
  minivan
  pickup
  coupe
  wagon
  limousine
  other
}

enum car_model_status {
  active
  inactive
  discontinued
}

enum claim_status {
  filed
  processing
  approved
  rejected
  closed
}

enum compensation_model {
  fixed_rental
  percentage_split
  salary
  crew_rental
  buyout
  custom
}

enum contract_status {
  draft
  negotiation
  signed
  active
  future
  expired
  terminated
  renewal_in_progress
  cancelled
}

enum cooperation_status {
  pending
  active
  expired
  terminated
}

enum cooperation_type {
  employee
  contractor
  owner_operator
  partner_driver
}

enum coverage_drivers {
  named
  any
  professional
}

enum department {
  support
  tech
  finance
  sales
}

enum dispute_status {
  pending
  accepted
  rejected
}

enum document_status {
  active
  expired
  archived
}

enum document_verification_status {
  pending
  verified
  rejected
  expired
}

enum driver_document_type {
  driving_license
  professional_card
  national_id
  passport
  visa
  work_permit
  residence_permit
  proof_of_address
  criminal_record
  medical_certificate
  vehicle_registration
  insurance_policy
  contract_signed
  bank_statement
  other
}

enum driver_request_type {
  leave
  vehicle_change
  schedule_change
  expense_reimbursement
  advance_payment
  document_update
  complaint
  support
  contract_modification
  termination
  other
}

enum driver_revenue_period_type {
  week
  biweekly
  month
}

enum driver_revenue_status {
  pending
  validated
  adjusted
  disputed
}

enum driver_status {
  active
  inactive
  suspended
  terminated
}

enum employee_role {
  support_agent
  admin
  super_admin
}

enum equipment_condition {
  new_item
  excellent
  good
  fair
  poor
  damaged
}

enum equipment_status {
  provided
  returned
  lost
  damaged
  stolen
}

enum equipment_type {
  dashcam
  gps_tracker
  tablet
  phone_charger
  phone_mount
  spare_tire
  jack
  warning_triangle
  first_aid_kit
  fire_extinguisher
  reflective_vest
  other
}

enum event_severity {
  minor
  moderate
  major
  total_loss
}

enum expense_category {
  fuel
  toll
  parking
  wash
  repair
  fine
  insurance_deductible
  registration
  inspection
  permit
  other
}

enum finance_payment_method {
  bank_transfer
  mobile_money
  cash
}

enum fuel_type {
  gasoline
  diesel
  hybrid
  electric
  plugin_hybrid
  cng
  lpg
  hydrogen
}

enum goal_category {
  revenue
  trips
  quality
  efficiency
  safety
}

enum goal_period_type {
  daily
  weekly
  monthly
  quarterly
  yearly
}

enum goal_reward_type {
  bonus
  certificate
  badge
  promotion
}

enum goal_status {
  active
  in_progress
  completed
  cancelled
  expired
  on_track
  at_risk
  achieved
  exceeded
}

enum goal_target_type {
  individual
  team
  branch
  company
}

enum goal_threshold {
  bronze
  silver
  gold
  exceeded
}

enum handover_type {
  pickup
  return
  transfer
}

enum inspection_status {
  scheduled
  passed
  failed
  pending
  cancelled
}

enum inspection_type {
  annual
  pre_trip
  post_accident
  regulatory
  pre_sale
  custom
}

enum insurance_status {
  active
  expired
  cancelled
  suspended
}

enum invitation_status {
  pending
  accepted
  expired
  revoked
}

enum invitation_type {
  initial_admin
  additional_user
  role_change
  reactivation
}

enum invoice_line_source_type {
  billing_plan
  usage_metric
  manual
  promotion
}

enum invoice_line_type {
  plan_fee
  overage_fee
  tax
  discount
  other
}

enum invoice_status {
  draft
  sent
  paid
  overdue
  void
  uncollectible
}

enum lead_priority {
  low
  medium
  high
  urgent
}

enum lead_stage {
  top_of_funnel
  marketing_qualified
  sales_qualified
  opportunity
}

enum lead_status {
  new
  qualified
  converted
  lost
  working
}

enum lifecycle_event_type {
  created
  trial_started
  trial_extended
  activated
  plan_upgraded
  plan_downgraded
  suspended
  reactivated
  cancelled
  archived
  deleted
}

enum lifecycle_status {
  active
  inactive
  deprecated
}

enum maintenance_category {
  preventive
  corrective
  regulatory
  emergency
}

enum maintenance_priority {
  low
  medium
  high
  urgent
  emergency
}

enum maintenance_status {
  scheduled
  in_progress
  completed
  cancelled
  deferred
}

enum maintenance_trigger_type {
  mileage_based
  time_based
  condition_based
  manual
}

enum maintenance_type {
  oil_change
  tire_rotation
  brake_service
  engine_service
  transmission_service
  battery_replacement
  air_filter
  coolant_flush
  alignment
  inspection
  other
}

enum member_status {
  invited
  active
  suspended
  terminated
}

enum message_type {
  public
  internal
  note
}

enum metric_source {
  internal
  api
  import
  calculated
}

enum notification_channel {
  email
  sms
  slack
  webhook
  push
}

enum notification_status {
  pending
  sent
  delivered
  bounced
  opened
  clicked
  failed
}

enum opportunity_stage {
  prospect
  proposal
  negotiation
  closed
}

enum opportunity_status {
  open
  won
  lost
  on_hold
  cancelled
}

enum paid_by {
  company
  driver
  platform
  government
}

enum payment_frequency {
  annual
  semi_annual
  quarterly
  monthly
}

enum payment_method {
  direct_debit
  bank_transfer
  credit_card
  cash
  cheque
}

enum payment_method_status {
  active
  inactive
  expired
  failed
  pending_verification
}

enum payment_method_type {
  cash
  card
  wallet
  mixed
}

enum payment_status {
  pending
  processed
  failed
  refunded
}

enum payment_type {
  card
  bank_account
  paypal
  apple_pay
  google_pay
  other
}

enum payroll_cycle {
  monthly
  semi_monthly
  weekly
  custom
}

enum performed_by_type {
  system
  employee
  api
}

enum period_type {
  day
  week
  month
}

enum platform_account_key_type {
  read_only
  read_write
  admin
}

enum platform_account_status {
  active
  inactive
  suspended
}

enum policy_category {
  main
  supplementary
  temporary
  rider
}

enum preferred_payment_method {
  bank_transfer
  cash
  mobile_wallet
}

enum promotion_applies_to {
  first_invoice
  all_invoices
  specific_plan
}

enum promotion_discount_type {
  percentage
  fixed_amount
}

enum promotion_status {
  active
  expired
  exhausted
  disabled
}

enum provider_type {
  internal
  external
  online_platform
  government
}

enum queue_status {
  pending
  processing
  sent
  failed
  cancelled
}

enum receipt_status {
  pending
  verified
  invalid
  missing
}

enum reconciliation_status {
  pending
  matched
  mismatched
  adjusted
  cancelled
}

enum reconciliation_type {
  platform_payment
  cash_collection
  bank_statement
  adjustment
}

enum regulation_status {
  active
  inactive
}

enum renewal_type {
  automatic
  optional
  perpetual
  non_renewing
}

enum repair_status {
  pending
  approved
  in_progress
  completed
  cancelled
}

enum request_priority {
  low
  normal
  high
  urgent
}

enum request_status {
  pending
  under_review
  approved
  rejected
  cancelled
  completed
}

enum responsible_party {
  fleet
  driver
  third_party
}

enum revenue_import_source_type {
  api
  file_csv
  file_excel
  manual
}

enum revenue_import_status {
  pending
  processing
  completed
  partially_completed
  failed
  cancelled
}

enum risk_rating {
  A
  B
  C
  D
  E
}

enum scope_type {
  global
  branch
  team
}

enum service_type {
  ride
  support
  maintenance
  other
}

enum settlement_status {
  pending
  settled
  cancelled
}

enum settlement_type {
  platform_payout
  adjustment
  refund
  bonus
}

enum shift_status {
  scheduled
  completed
  cancelled
  no_show
  partial
}

enum shift_type {
  day
  night
  weekend
  peak_hour
  special_event
}

enum signature_method {
  digital
  wet_signature
  app
  email
  electronic
  wet_ink
  click_wrap
}

enum storage_provider {
  supabase
  s3
  azure_blob
  gcs
}

enum submitter_type {
  driver
  client
  member
  guest
}

enum subscription_status {
  trialing
  active
  past_due
  suspended
  cancelling
  cancelled
  inactive
}

enum task_category {
  admin
  maintenance
  document
  training
  support
}

enum task_change_type {
  created
  assigned
  status_changed
  escalated
}

enum task_comment_type {
  note
  status_change
  escalation
}

enum task_priority {
  low
  normal
  high
  urgent
  critical
}

enum task_status {
  pending
  in_progress
  completed
  cancelled
  overdue
  blocked
  waiting_verification
  reopened
}

enum tenant_status {
  trialing
  active
  suspended
  past_due
  cancelled
}

enum ticket_priority {
  low
  medium
  high
  critical
}

enum ticket_raised_by_type {
  admin
  driver
  client
  guest
}

enum ticket_source_platform {
  web
  mobile
  api
  email
  phone
}

enum ticket_status {
  new
  open
  waiting_client
  waiting_internal
  resolved
  closed
}

enum toll_gate_status {
  active
  inactive
  maintenance
}

enum toll_transaction_source {
  automatic
  manual
  imported
}

enum toll_transaction_status {
  pending
  charged
  refunded
  disputed
}

enum traffic_fine_status {
  pending
  processing
  disputed
  cancelled
  paid
  refunded
}

enum training_status {
  planned
  in_progress
  completed
  expired
  cancelled
}

enum training_type {
  mandatory
  safety
  customer_service
  technical
  compliance
  platform_specific
  professional_development
  onboarding
  refresher
  specialized
}

enum transaction_category_type {
  revenue
  expense
  transfer
  other
}

enum transmission_type {
  manual
  automatic
  semi_automatic
  cvt
}

enum trip_status {
  completed
  cancelled
  rejected
  no_show
}

enum trp_invoice_status {
  draft
  sent
  viewed
  partially_paid
  paid
  disputed
  cancelled
  overdue
}

enum trp_payment_method {
  bank_transfer
  card
  check
  cash
}

enum vehicle_event_type {
  accident
  maintenance
  violation
  recovery
  impound
  theft
  breakdown
}

enum vehicle_usage {
  commercial
  private
  mixed
}

enum verification_status {
  pending
  verified
  rejected
}

// Quote-to-Cash enums
enum quote_status {
  draft
  sent
  viewed
  accepted
  rejected
  expired
  converted
}

enum quote_item_type {
  plan
  addon
  service
  custom
}

enum item_recurrence {
  one_time
  recurring
}

enum discount_type {
  percentage
  fixed_amount
}

enum agreement_type {
  msa
  sla
  dpa
  nda
  sow
  addendum
  other
}

enum agreement_status {
  draft
  pending_review
  pending_signature
  signed
  active
  expired
  terminated
  superseded
}

enum order_type {
  new
  renewal
  upgrade
  downgrade
  amendment
}

enum order_fulfillment_status {
  pending
  ready_for_fulfillment
  in_progress
  fulfilled
  active
  cancelled
  expired
}

enum amendment_type {
  upgrade
  downgrade
  quantity_change
  plan_change
  billing_change
  cancel_immediate
  cancel_scheduled
  pause
  resume
}

enum amendment_status {
  draft
  pending_approval
  approved
  applied
  rejected
  canceled
}

enum proration_behavior {
  create_prorations
  none
  always_invoice
}

enum schedule_status {
  not_started
  active
  completed
  canceled
  released
}

enum schedule_end_behavior {
  release
  cancel
  none
}
