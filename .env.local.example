# =============================================================================
# JWT AUTHENTICATION (RFC 7519, RFC 6750)
# =============================================================================

# Secret key for signing internal JWT tokens (REQUIRED for API authentication)
#
# SECURITY REQUIREMENTS:
# - Minimum 256 bits (32 bytes) for HS256 algorithm
# - Must be cryptographically random
# - NEVER commit actual secret to git
#
# GENERATION:
#   openssl rand -base64 64
#
# USAGE:
# - Tokens contain: userId, tenantId, email, roles
# - Default expiration: 1 hour
# - Header format: Authorization: Bearer <JWT>
#
INTERNAL_AUTH_SECRET=your-secret-here-generate-with-openssl-rand-base64-64

# =============================================================================
# ADMIN SECURITY - IP WHITELIST
# =============================================================================

# Whitelist of IP addresses allowed to access admin routes (/adm/*, /api/adm/*)
#
# CRITICAL SECURITY BEHAVIOR:
# - Production: Empty whitelist = BLOCK ALL (fail-closed)
# - Development: Empty whitelist = ALLOW ALL (localhost always allowed)
# - Localhost (127.0.0.1, ::1) automatically allowed in NODE_ENV=development
#
# FORMAT:
# - Comma-separated list of IPv4 or IPv6 addresses
# - No CIDR notation support (use individual IPs)
# - Whitespace trimmed automatically
#
# PRODUCTION SETUP:
# 1. Add your office/VPN static IPs
# 2. Test access before deploying
# 3. Monitor adm_audit_logs for ip_blocked events
#
# EXAMPLES:
#   Single IPv4:   ADMIN_IP_WHITELIST=203.0.113.50
#   Multiple IPs:  ADMIN_IP_WHITELIST=203.0.113.50,198.51.100.42
#   IPv6:          ADMIN_IP_WHITELIST=2001:db8::1,::1
#   Mixed:         ADMIN_IP_WHITELIST=203.0.113.50,2001:db8::1
#
# DEVELOPMENT:
#   Leave empty - localhost (127.0.0.1, ::1) always allowed
#   Example: ADMIN_IP_WHITELIST=
#
# PRODUCTION (REQUIRED):
#   Must configure at least one IP, otherwise ALL admin access blocked
#
ADMIN_IP_WHITELIST=

# =============================================================================
# INTERNAL API AUTHENTICATION
# =============================================================================

# Secret token for internal API routes (e.g., /api/internal/audit)
#
# SECURITY REQUIREMENTS:
# - Minimum 64 characters (base64 encoded)
# - Must be cryptographically random
# - NEVER commit actual secret to git
#
# GENERATION:
#   openssl rand -base64 64
#
# USAGE:
# - Validates requests from middleware to internal API routes
# - Header format: x-internal-audit-token: <TOKEN>
# - Fail-closed: Empty token blocks all internal API requests
#
# PRODUCTION (REQUIRED):
#   Must configure, otherwise internal audit logs will fail
#
# DEVELOPMENT:
#   Use a dummy token for local testing
#   Example: INTERNAL_AUDIT_TOKEN=dev-local-token-not-for-production
#
INTERNAL_AUDIT_TOKEN=

# =============================================================================
# STRIPE CONFIGURATION
# =============================================================================

# Stripe API secret key for server-side operations
#
# SECURITY REQUIREMENTS:
# - Use sk_test_* for development/testing
# - Use sk_live_* for production
# - NEVER commit actual keys to git
# - Rotate keys if exposed
#
# SETUP:
# 1. Create Stripe account: https://dashboard.stripe.com/register
# 2. Get API keys: https://dashboard.stripe.com/apikeys
# 3. Use test mode keys for development
#
# DEVELOPMENT:
#   Option 1: Use Stripe test keys (requires internet)
#   Option 2: Use stripe-mock (docker run -p 12111:12111 stripe/stripe-mock)
#             Then set STRIPE_API_BASE=http://localhost:12111
#
STRIPE_SECRET_KEY=

# Stripe webhook signing secret for verifying webhook signatures
#
# SECURITY:
# - Each webhook endpoint has its own signing secret
# - Prevents replay attacks and signature forgery
# - Get from Stripe Dashboard > Webhooks > Signing secret
#
# SETUP:
# 1. Create webhook endpoint: https://dashboard.stripe.com/webhooks
# 2. Point to: https://your-domain.com/api/webhooks/stripe
# 3. Select events: subscription_schedule.*, customer.subscription.*, invoice.*
# 4. Copy signing secret (starts with whsec_)
#
# LOCAL DEVELOPMENT with Stripe CLI:
#   stripe listen --forward-to localhost:3000/api/webhooks/stripe
#   Use the signing secret provided by the CLI
#
STRIPE_WEBHOOK_SECRET=

# Optional: Override Stripe API base URL (for stripe-mock or testing)
#
# DEFAULT: https://api.stripe.com (production Stripe API)
#
# STRIPE-MOCK DEVELOPMENT:
#   1. Run: docker run -p 12111:12111 stripe/stripe-mock
#   2. Set: STRIPE_API_BASE=http://localhost:12111
#   3. Use any sk_test_* key (mock accepts any valid format)
#
# STRIPE_API_BASE=

# =============================================================================
# CAL.COM INTEGRATION (V6.2.2 - Book Demo Wizard)
# =============================================================================

# Cal.com booking link for the demo scheduler
#
# FORMAT: username/event-slug
# The full URL will be: https://cal.com/{NEXT_PUBLIC_CALCOM_LINK}
#
# SETUP:
# 1. Create Cal.com account: https://cal.com/signup
# 2. Create event type for demos (20 min recommended)
# 3. Copy the link slug (e.g., "fleetcore/demo")
#
# FALLBACK: If not set, defaults to "fleetcore/demo"
#
NEXT_PUBLIC_CALCOM_LINK=fleetcore/demo

# Cal.com webhook signing secret for verifying webhook signatures
#
# SECURITY:
# - Prevents replay attacks and signature forgery
# - Get from Cal.com Dashboard > Settings > Developer > Webhooks
#
# SETUP:
# 1. Create webhook: https://cal.com/settings/developer/webhooks
# 2. Point to: https://your-domain.com/api/crm/webhooks/calcom
# 3. Select events: BOOKING_CREATED, BOOKING_RESCHEDULED, BOOKING_CANCELLED
# 4. Enable HMAC signing
# 5. Copy the signing secret
#
# PRODUCTION (REQUIRED):
#   Must configure for webhook security
#
CALCOM_WEBHOOK_SECRET=

# =============================================================================
# RESEND EMAIL SERVICE
# =============================================================================

# Resend API key for transactional emails
#
# USAGE:
# - Used by NotificationQueueService for email delivery
# - Templates stored in dir_notification_templates
#
# SETUP:
# 1. Create Resend account: https://resend.com/signup
# 2. Get API key: https://resend.com/api-keys
# 3. Verify domain: https://resend.com/domains
#
# DEVELOPMENT:
#   Use test API key (rate limited, sandbox only)
#
# PRODUCTION (REQUIRED):
#   Must configure for email delivery
#
RESEND_API_KEY=
