# =============================================================================
# JWT AUTHENTICATION (RFC 7519, RFC 6750)
# =============================================================================

# Secret key for signing internal JWT tokens (REQUIRED for API authentication)
#
# SECURITY REQUIREMENTS:
# - Minimum 256 bits (32 bytes) for HS256 algorithm
# - Must be cryptographically random
# - NEVER commit actual secret to git
#
# GENERATION:
#   openssl rand -base64 64
#
# USAGE:
# - Tokens contain: userId, tenantId, email, roles
# - Default expiration: 1 hour
# - Header format: Authorization: Bearer <JWT>
#
INTERNAL_AUTH_SECRET=your-secret-here-generate-with-openssl-rand-base64-64

# =============================================================================
# ADMIN SECURITY - IP WHITELIST
# =============================================================================

# Whitelist of IP addresses allowed to access admin routes (/adm/*, /api/adm/*)
#
# CRITICAL SECURITY BEHAVIOR:
# - Production: Empty whitelist = BLOCK ALL (fail-closed)
# - Development: Empty whitelist = ALLOW ALL (localhost always allowed)
# - Localhost (127.0.0.1, ::1) automatically allowed in NODE_ENV=development
#
# FORMAT:
# - Comma-separated list of IPv4 or IPv6 addresses
# - No CIDR notation support (use individual IPs)
# - Whitespace trimmed automatically
#
# PRODUCTION SETUP:
# 1. Add your office/VPN static IPs
# 2. Test access before deploying
# 3. Monitor adm_audit_logs for ip_blocked events
#
# EXAMPLES:
#   Single IPv4:   ADMIN_IP_WHITELIST=203.0.113.50
#   Multiple IPs:  ADMIN_IP_WHITELIST=203.0.113.50,198.51.100.42
#   IPv6:          ADMIN_IP_WHITELIST=2001:db8::1,::1
#   Mixed:         ADMIN_IP_WHITELIST=203.0.113.50,2001:db8::1
#
# DEVELOPMENT:
#   Leave empty - localhost (127.0.0.1, ::1) always allowed
#   Example: ADMIN_IP_WHITELIST=
#
# PRODUCTION (REQUIRED):
#   Must configure at least one IP, otherwise ALL admin access blocked
#
ADMIN_IP_WHITELIST=

# =============================================================================
# INTERNAL API AUTHENTICATION
# =============================================================================

# Secret token for internal API routes (e.g., /api/internal/audit)
#
# SECURITY REQUIREMENTS:
# - Minimum 64 characters (base64 encoded)
# - Must be cryptographically random
# - NEVER commit actual secret to git
#
# GENERATION:
#   openssl rand -base64 64
#
# USAGE:
# - Validates requests from middleware to internal API routes
# - Header format: x-internal-audit-token: <TOKEN>
# - Fail-closed: Empty token blocks all internal API requests
#
# PRODUCTION (REQUIRED):
#   Must configure, otherwise internal audit logs will fail
#
# DEVELOPMENT:
#   Use a dummy token for local testing
#   Example: INTERNAL_AUDIT_TOKEN=dev-local-token-not-for-production
#
INTERNAL_AUDIT_TOKEN=
